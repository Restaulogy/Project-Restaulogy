<?php/**********************************************************************bus_working_hrs.class.phpGenerated by STRUCTY 2012.02.20 06:40:24.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("BUS_WORKING_HRS", "bus_working_hrs"); class bus_working_hrs {	private $pk_id;	private $bus_id;	private $sun_start;	private $sun_end;	private $mon_start;	private $mon_end;	private $tues_start;	private $tues_end;	private $wed_start;	private $wed_end;	private $thurs_start;	private $thurs_end;	private $fri_start;	private $fri_end;	private $sat_start;	private $sat_end;	public function setpk_id($pArg="0") {$this->pk_id=$pArg;}	public function setbus_id($pArg="0") {$this->bus_id=$pArg;}	public function setsun_start($pArg="0") {$this->sun_start=$pArg;}	public function setsun_end($pArg="0") {$this->sun_end=$pArg;}	public function setmon_start($pArg="0") {$this->mon_start=$pArg;}	public function setmon_end($pArg="0") {$this->mon_end=$pArg;}	public function settues_start($pArg="0") {$this->tues_start=$pArg;}	public function settues_end($pArg="0") {$this->tues_end=$pArg;}	public function setwed_start($pArg="0") {$this->wed_start=$pArg;}	public function setwed_end($pArg="0") {$this->wed_end=$pArg;}	public function setthurs_start($pArg="0") {$this->thurs_start=$pArg;}	public function setthurs_end($pArg="0") {$this->thurs_end=$pArg;}	public function setfri_start($pArg="0") {$this->fri_start=$pArg;}	public function setfri_end($pArg="0") {$this->fri_end=$pArg;}	public function setsat_start($pArg="0") {$this->sat_start=$pArg;}	public function setsat_end($pArg="0") {$this->sat_end=$pArg;}	public function getpk_id() {return $this->pk_id;}	public function getbus_id() {return $this->bus_id;}	public function getsun_start() {return $this->sun_start;}	public function getsun_end() {return $this->sun_end;}	public function getmon_start() {return $this->mon_start;}	public function getmon_end() {return $this->mon_end;}	public function gettues_start() {return $this->tues_start;}	public function gettues_end() {return $this->tues_end;}	public function getwed_start() {return $this->wed_start;}	public function getwed_end() {return $this->wed_end;}	public function getthurs_start() {return $this->thurs_start;}	public function getthurs_end() {return $this->thurs_end;}	public function getfri_start() {return $this->fri_start;}	public function getfri_end() {return $this->fri_end;}	public function getsat_start() {return $this->sat_start;}	public function getsat_end() {return $this->sat_end;}    public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".BUS_WORKING_HRS.RET;		$and = "WHERE".RET;		if($array['pk_id'] != "") {			$qry .= $and."pk_id = '".$array['pk_id']."'".RET;			$and = "AND".RET;		}		if($array['bus_id'] != "") {			$qry .= $and."bus_id = '".$array['bus_id']."'".RET;			$and = "AND".RET;		}		if($array['sun_start'] != "") {			$qry .= $and."sun_start = '".$array['sun_start']."'".RET;			$and = "AND".RET;		}		if($array['sun_end'] != "") {			$qry .= $and."sun_end = '".$array['sun_end']."'".RET;			$and = "AND".RET;		}		if($array['mon_start'] != "") {			$qry .= $and."mon_start = '".$array['mon_start']."'".RET;			$and = "AND".RET;		}		if($array['mon_end'] != "") {			$qry .= $and."mon_end = '".$array['mon_end']."'".RET;			$and = "AND".RET;		}		if($array['tues_start'] != "") {			$qry .= $and."tues_start = '".$array['tues_start']."'".RET;			$and = "AND".RET;		}		if($array['tues_end'] != "") {			$qry .= $and."tues_end = '".$array['tues_end']."'".RET;			$and = "AND".RET;		}		if($array['wed_start'] != "") {			$qry .= $and."wed_start = '".$array['wed_start']."'".RET;			$and = "AND".RET;		}		if($array['wed_end'] != "") {			$qry .= $and."wed_end = '".$array['wed_end']."'".RET;			$and = "AND".RET;		}		if($array['thurs_start'] != "") {			$qry .= $and."thurs_start = '".$array['thurs_start']."'".RET;			$and = "AND".RET;		}		if($array['thurs_end'] != "") {			$qry .= $and."thurs_end = '".$array['thurs_end']."'".RET;			$and = "AND".RET;		}		if($array['fri_start'] != "") {			$qry .= $and."fri_start = '".$array['fri_start']."'".RET;			$and = "AND".RET;		}		if($array['fri_end'] != "") {			$qry .= $and."fri_end = '".$array['fri_end']."'".RET;			$and = "AND".RET;		}		if($array['sat_start'] != "") {			$qry .= $and."sat_start = '".$array['sat_start']."'".RET;			$and = "AND".RET;		}		if($array['sat_end'] != "") {			$qry .= $and."sat_end = '".$array['sat_end']."'".RET;			$and = "AND".RET;		}  /*$record = Database::select($qry);*/	    $result = mysql_query($qry);        $record=array();		if($result) {            //$recordset = mysql_fetch_assoc($result);    		while ($row = mysql_fetch_assoc($result)) {    		  $record[] = $row;    		}		}		if(count($record[0]) == 0) {			return array();		} else {			$record = $record[0];			$this->setpk_id($record['pk_id']);			$this->setbus_id($record['bus_id']);			$this->setsun_start($record['sun_start']);			$this->setsun_end($record['sun_end']);			$this->setmon_start($record['mon_start']);			$this->setmon_end($record['mon_end']);			$this->settues_start($record['tues_start']);			$this->settues_end($record['tues_end']);			$this->setwed_start($record['wed_start']);			$this->setwed_end($record['wed_end']);			$this->setthurs_start($record['thurs_start']);			$this->setthurs_end($record['thurs_end']);			$this->setfri_start($record['fri_start']);			$this->setfri_end($record['fri_end']);			$this->setsat_start($record['sat_start']);			$this->setsat_end($record['sat_end']);			return true;		}	}	public static function readArray($array = array()) {		$qry = "SELECT *".RET."FROM ".BUS_WORKING_HRS.RET;		$and = "WHERE".RET;		if($array['pk_id'] != "") {			$qry .= $and."pk_id = '".$array['pk_id']."'".RET;			$and = "AND".RET;		}		if($array['bus_id'] != "") {			$qry .= $and."bus_id = '".$array['bus_id']."'".RET;			$and = "AND".RET;		}		if($array['sun_start'] != "") {			$qry .= $and."sun_start = '".$array['sun_start']."'".RET;			$and = "AND".RET;		}		if($array['sun_end'] != "") {			$qry .= $and."sun_end = '".$array['sun_end']."'".RET;			$and = "AND".RET;		}		if($array['mon_start'] != "") {			$qry .= $and."mon_start = '".$array['mon_start']."'".RET;			$and = "AND".RET;		}		if($array['mon_end'] != "") {			$qry .= $and."mon_end = '".$array['mon_end']."'".RET;			$and = "AND".RET;		}		if($array['tues_start'] != "") {			$qry .= $and."tues_start = '".$array['tues_start']."'".RET;			$and = "AND".RET;		}		if($array['tues_end'] != "") {			$qry .= $and."tues_end = '".$array['tues_end']."'".RET;			$and = "AND".RET;		}		if($array['wed_start'] != "") {			$qry .= $and."wed_start = '".$array['wed_start']."'".RET;			$and = "AND".RET;		}		if($array['wed_end'] != "") {			$qry .= $and."wed_end = '".$array['wed_end']."'".RET;			$and = "AND".RET;		}		if($array['thurs_start'] != "") {			$qry .= $and."thurs_start = '".$array['thurs_start']."'".RET;			$and = "AND".RET;		}		if($array['thurs_end'] != "") {			$qry .= $and."thurs_end = '".$array['thurs_end']."'".RET;			$and = "AND".RET;		}		if($array['fri_start'] != "") {			$qry .= $and."fri_start = '".$array['fri_start']."'".RET;			$and = "AND".RET;		}		if($array['fri_end'] != "") {			$qry .= $and."fri_end = '".$array['fri_end']."'".RET;			$and = "AND".RET;		}		if($array['sat_start'] != "") {			$qry .= $and."sat_start = '".$array['sat_start']."'".RET;			$and = "AND".RET;		}		if($array['sat_end'] != "") {			$qry .= $and."sat_end = '".$array['sat_end']."'".RET;			$and = "AND".RET;		}  /*$recordset = Database::select($qry);*/        $recordset =array();        $result = mysql_query($qry);		if($result) {            //$recordset = mysql_fetch_assoc($result);    		while ($row = mysql_fetch_assoc($result)) {    		  $recordset[] = $row;    		}		}		$class_objects = array();		if(is_array($recordset) == true) {			while(list($i, $record) = each($recordset)) {				$class_object = new bus_working_hrs();				$class_object->setpk_id($record['pk_id']);				$class_object->setbus_id($record['bus_id']);				$class_object->setsun_start($record['sun_start']);				$class_object->setsun_end($record['sun_end']);				$class_object->setmon_start($record['mon_start']);				$class_object->setmon_end($record['mon_end']);				$class_object->settues_start($record['tues_start']);				$class_object->settues_end($record['tues_end']);				$class_object->setwed_start($record['wed_start']);				$class_object->setwed_end($record['wed_end']);				$class_object->setthurs_start($record['thurs_start']);				$class_object->setthurs_end($record['thurs_end']);				$class_object->setfri_start($record['fri_start']);				$class_object->setfri_end($record['fri_end']);				$class_object->setsat_start($record['sat_start']);				$class_object->setsat_end($record['sat_end']);				$class_objects[$class_object->getpk_id()] = $class_object;			}		}		return $class_objects;	}    public static function retArr($array = array()) {		$qry = "SELECT `pk_id`, `bus_id`, `mon_start`, `mon_end`, `tues_start`, `tues_end`, `wed_start`, `wed_end`, `thurs_start`, `thurs_end`, `fri_start`, `fri_end`, `sat_start`, `sat_end`,`sun_start`, `sun_end` ".RET."FROM ".BUS_WORKING_HRS.RET;		$and = "WHERE".RET;		if($array['pk_id'] != "") {			$qry .= $and."pk_id = '".$array['pk_id']."'".RET;			$and = "AND".RET;		}		if($array['bus_id'] != "") {			$qry .= $and."bus_id = '".$array['bus_id']."'".RET;			$and = "AND".RET;		}        if($array['sun_start'] != "") {			$qry .= $and."sun_start = '".$array['sun_start']."'".RET;			$and = "AND".RET;		}		if($array['sun_end'] != "") {			$qry .= $and."sun_end = '".$array['sun_end']."'".RET;			$and = "AND".RET;		}		if($array['mon_start'] != "") {			$qry .= $and."mon_start = '".$array['mon_start']."'".RET;			$and = "AND".RET;		}		if($array['mon_end'] != "") {			$qry .= $and."mon_end = '".$array['mon_end']."'".RET;			$and = "AND".RET;		}		if($array['tues_start'] != "") {			$qry .= $and."tues_start = '".$array['tues_start']."'".RET;			$and = "AND".RET;		}		if($array['tues_end'] != "") {			$qry .= $and."tues_end = '".$array['tues_end']."'".RET;			$and = "AND".RET;		}		if($array['wed_start'] != "") {			$qry .= $and."wed_start = '".$array['wed_start']."'".RET;			$and = "AND".RET;		}		if($array['wed_end'] != "") {			$qry .= $and."wed_end = '".$array['wed_end']."'".RET;			$and = "AND".RET;		}		if($array['thurs_start'] != "") {			$qry .= $and."thurs_start = '".$array['thurs_start']."'".RET;			$and = "AND".RET;		}		if($array['thurs_end'] != "") {			$qry .= $and."thurs_end = '".$array['thurs_end']."'".RET;			$and = "AND".RET;		}		if($array['fri_start'] != "") {			$qry .= $and."fri_start = '".$array['fri_start']."'".RET;			$and = "AND".RET;		}		if($array['fri_end'] != "") {			$qry .= $and."fri_end = '".$array['fri_end']."'".RET;			$and = "AND".RET;		}		if($array['sat_start'] != "") {			$qry .= $and."sat_start = '".$array['sat_start']."'".RET;			$and = "AND".RET;		}		if($array['sat_end'] != "") {			$qry .= $and."sat_end = '".$array['sat_end']."'".RET;			$and = "AND".RET;		}  /*$recordset = Database::select($qry);*/ 	    $result = mysql_query($qry);		if($result) {            //$recordset = mysql_fetch_assoc($result);    		while ($row = mysql_fetch_assoc($result)) {    		  $recordset[] = $row;    		}		}		$class_objects = array();		if(is_array($recordset) == true) {			while(list($i, $record) = each($recordset)) {				$class_objects=$record;			}		}		return $class_objects;	}		public function insert() {		if($this->getpk_id() != '') {			$qry  = "UPDATE ".BUS_WORKING_HRS.RET."SET".RET.			"pk_id = '".$this->getpk_id()."',".RET.			"bus_id = '".$this->getbus_id()."',".RET.			"sun_start = '".$this->getsun_start()."',".RET.			"sun_end = '".$this->getsun_end()."',".RET.			"mon_start = '".$this->getmon_start()."',".RET.			"mon_end = '".$this->getmon_end()."',".RET.			"tues_start = '".$this->gettues_start()."',".RET.			"tues_end = '".$this->gettues_end()."',".RET.			"wed_start = '".$this->getwed_start()."',".RET.			"wed_end = '".$this->getwed_end()."',".RET.			"thurs_start = '".$this->getthurs_start()."',".RET.			"thurs_end = '".$this->getthurs_end()."',".RET.			"fri_start = '".$this->getfri_start()."',".RET.			"fri_end = '".$this->getfri_end()."',".RET.			"sat_start = '".$this->getsat_start()."',".RET.			"sat_end = '".$this->getsat_end()."'".RET.			"WHERE pk_id = ".$this->getpk_id().RET;            mysql_query($qry);		} else {			$qry  = "INSERT INTO ".BUS_WORKING_HRS." (".RET.			"bus_id, sun_start, sun_end, mon_start, mon_end, tues_start, tues_end, wed_start, wed_end, thurs_start, thurs_end, fri_start, fri_end, sat_start, sat_end".RET.				") VALUES (".RET.			"'".$this->getbus_id()."',".RET.			"'".$this->getsun_start()."',".RET.			"'".$this->getsun_end()."',".RET.			"'".$this->getmon_start()."',".RET.			"'".$this->getmon_end()."',".RET.			"'".$this->gettues_start()."',".RET.			"'".$this->gettues_end()."',".RET.			"'".$this->getwed_start()."',".RET.			"'".$this->getwed_end()."',".RET.			"'".$this->getthurs_start()."',".RET.			"'".$this->getthurs_end()."',".RET.			"'".$this->getfri_start()."',".RET.			"'".$this->getfri_end()."',".RET.			"'".$this->getsat_start()."',".RET.			"'".$this->getsat_end()."'".RET.			")".RET;            mysql_query($qry);			$this->setpk_id(mysql_insert_id());		}	}	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".BUS_WORKING_HRS.RET;		$and = "WHERE".RET;		if($array['pk_id'] != "") {			$qry .= $and."pk_id = '".$array['pk_id']."'".RET;			$and = "AND".RET;		}		if($array['bus_id'] != "") {			$qry .= $and."bus_id = '".$array['bus_id']."'".RET;			$and = "AND".RET;		}		if($array['sun_start'] != "") {			$qry .= $and."sun_start = '".$array['sun_start']."'".RET;			$and = "AND".RET;		}		if($array['sun_end'] != "") {			$qry .= $and."sun_end = '".$array['sun_end']."'".RET;			$and = "AND".RET;		}		if($array['mon_start'] != "") {			$qry .= $and."mon_start = '".$array['mon_start']."'".RET;			$and = "AND".RET;		}		if($array['mon_end'] != "") {			$qry .= $and."mon_end = '".$array['mon_end']."'".RET;			$and = "AND".RET;		}		if($array['tues_start'] != "") {			$qry .= $and."tues_start = '".$array['tues_start']."'".RET;			$and = "AND".RET;		}		if($array['tues_end'] != "") {			$qry .= $and."tues_end = '".$array['tues_end']."'".RET;			$and = "AND".RET;		}		if($array['wed_start'] != "") {			$qry .= $and."wed_start = '".$array['wed_start']."'".RET;			$and = "AND".RET;		}		if($array['wed_end'] != "") {			$qry .= $and."wed_end = '".$array['wed_end']."'".RET;			$and = "AND".RET;		}		if($array['thurs_start'] != "") {			$qry .= $and."thurs_start = '".$array['thurs_start']."'".RET;			$and = "AND".RET;		}		if($array['thurs_end'] != "") {			$qry .= $and."thurs_end = '".$array['thurs_end']."'".RET;			$and = "AND".RET;		}		if($array['fri_start'] != "") {			$qry .= $and."fri_start = '".$array['fri_start']."'".RET;			$and = "AND".RET;		}		if($array['fri_end'] != "") {			$qry .= $and."fri_end = '".$array['fri_end']."'".RET;			$and = "AND".RET;		}		if($array['sat_start'] != "") {			$qry .= $and."sat_start = '".$array['sat_start']."'".RET;			$and = "AND".RET;		}		if($array['sat_end'] != "") {			$qry .= $and."sat_end = '".$array['sat_end']."'".RET;			$and = "AND".RET;		}            mysql_query($qry);	}		public function getclsMebizHrs($bizID,$address1,$loc1,$state,$zip){        global $CONFIG;        //...Business hour changes by inforeshaoDC TM        $obj_bus_hrs=$this->retArr($bizID);        if(!is_not_empty($obj_bus_hrs['mon_start']) &&           !is_not_empty($obj_bus_hrs['tues_start']) &&           !is_not_empty($obj_bus_hrs['wed_start']) &&           !is_not_empty($obj_bus_hrs['thurs_start']) &&           !is_not_empty($obj_bus_hrs['fri_start']) &&           !is_not_empty($obj_bus_hrs['sat_start']) &&           !is_not_empty($obj_bus_hrs['sun_start'])            ){            $str_HRS .="Not specified. <br><br>";        }else if(($obj_bus_hrs['mon_start']=="Closed") &&            ($obj_bus_hrs['tues_start']=="Closed") &&            ($obj_bus_hrs['wed_start']=="Closed") &&            ($obj_bus_hrs['thurs_start']=="Closed") &&            ($obj_bus_hrs['fri_start']=="Closed") &&            ($obj_bus_hrs['sat_start']=="Closed") &&            ($obj_bus_hrs['sun_start']=="Closed")            ){            $str_HRS .="Not specified. <br><br>";        }else{            $days_closed=array();            $days_open=array();            $open_time="";            $diff_times=array();            $comm_days=array();            //..First check closed and open days.            foreach ($obj_bus_hrs as $key => $value) {                $pos = strpos($key, "_start");                if ($pos){                    if(($value=="Closed")){                        $day_closed[]= substr($key, 0, 2);                    }else{                        $days_open[]=substr($key, 0, 2);                        $get_endDt_ky=str_replace("start", "end", $key);                        $curr_time =$this->convertToAmPm($value)."-".$this->convertToAmPm($obj_bus_hrs["$get_endDt_ky"]);                        if($open_time!=$curr_time){                           $diff_times[substr($key, 0, 2)]=$curr_time;                        }else{                           $comm_days[]=substr($key, 0, 2);                        }                        $open_time=$curr_time;                    }                }            }            //..check if any difference is there            if((is_not_empty($diff_times)) && (count($diff_times)>=1)){               //..If week have same working then show that.               if(is_not_empty($days_open))                    $str_HRS .= ucwords($days_open[0])."-".ucwords($days_open[count($days_open)-1]).": {$open_time}";               if(is_not_empty($day_closed))                    $str_HRS .= " | ". ucwords(implode("-", $day_closed))." : Closed";               $str_HRS .="<br>";            }            if((is_not_empty($diff_times)) && (count($diff_times)>1)){//print_r($comm_days_disp);               $i = 1;               foreach ($diff_times as $key => $value) {                    if($i%2==0)                        $lnbr="<Br>";                    else                        $lnbr=" | ";               /*     if((is_not_empty($comm_days))&&(count($comm_days)>1)&&($i==1))                        $str_HRS .= ucwords($key)."-".ucwords($comm_days[count($comm_days)-1])." : {$value} {$lnbr}";                    else*/                        $str_HRS .= ucwords($key)." : {$value} {$lnbr}";                    $i++;               }            }            if((is_not_empty($diff_times)) && (count($diff_times)>=1)){            }else{                $str_HRS .= ucwords(implode("-", $day_closed))." : Closed <br>";            }            //..Should be added to            /*            print_r($days_open);print_r($day_closed);            $unq_rows = array_unique($obj_bus_hrs);            if(is_not_empty($unq_rows)){                unset($unq_rows["pk_id"]); unset($unq_rows["bus_id"]);            }            print_r($unq_rows);            */        }        return $str_HRS;    }    public function convertToAmPm($strTime){       if(is_not_empty($strTime)){          return DATE("g:i a", strtotime($strTime));       }       return "";    }}?>