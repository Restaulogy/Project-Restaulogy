<?php/**********************************************************************hm_facility.class.phpGenerated by STRUCTY 2012.12.26 10:47:31.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("HM_FACILITY", "hm_facility"); class hm_facility {	private $facility_id;	private $facility_owner;	private $facility_name;	private $facility_address;	private $facility_country;	private $facility_state;	private $facility_city;	private $facility_zip;	private $facility_phone_1;	private $facility_phone_2;	private $facility_start_date;	private $facility_end_date;	public function setfacility_id($pArg="0") {$this->facility_id=$pArg;}	public function setfacility_owner($pArg="0") {$this->facility_owner=$pArg;}	public function setfacility_name($pArg="0") {$this->facility_name=$pArg;}	public function setfacility_address($pArg="0") {$this->facility_address=$pArg;}	public function setfacility_country($pArg="0") {$this->facility_country=$pArg;}	public function setfacility_state($pArg="0") {$this->facility_state=$pArg;}	public function setfacility_city($pArg="0") {$this->facility_city=$pArg;}	public function setfacility_zip($pArg="0") {$this->facility_zip=$pArg;}	public function setfacility_phone_1($pArg="0") {$this->facility_phone_1=$pArg;}	public function setfacility_phone_2($pArg="0") {$this->facility_phone_2=$pArg;}	public function setfacility_start_date($pArg="0") {$this->facility_start_date=$pArg;}	public function setfacility_end_date($pArg="0") {$this->facility_end_date=$pArg;}	public function getfacility_id() {return $this->facility_id;}	public function getfacility_owner() {return $this->facility_owner;}	public function getfacility_name() {return $this->facility_name;}	public function getfacility_address() {return $this->facility_address;}	public function getfacility_country() {return $this->facility_country;}	public function getfacility_state() {return $this->facility_state;}	public function getfacility_city() {return $this->facility_city;}	public function getfacility_zip() {return $this->facility_zip;}	public function getfacility_phone_1() {return $this->facility_phone_1;}	public function getfacility_phone_2() {return $this->facility_phone_2;}	public function getfacility_start_date() {return $this->facility_start_date;}	public function getfacility_end_date() {return $this->facility_end_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".HM_FACILITY.RET;		$and = "WHERE".RET;		if($array['facility_id'] != "") {			$qry .= $and."facility_id = '".$array['facility_id']."'".RET;			$and = "AND".RET;		}		if($array['facility_owner'] != "") {			$qry .= $and."facility_owner = '".$array['facility_owner']."'".RET;			$and = "AND".RET;		}		if($array['facility_name'] != "") {			$qry .= $and."facility_name = '".$array['facility_name']."'".RET;			$and = "AND".RET;		}		if($array['facility_address'] != "") {			$qry .= $and."facility_address = '".$array['facility_address']."'".RET;			$and = "AND".RET;		}		if($array['facility_country'] != "") {			$qry .= $and."facility_country = '".$array['facility_country']."'".RET;			$and = "AND".RET;		}		if($array['facility_state'] != "") {			$qry .= $and."facility_state = '".$array['facility_state']."'".RET;			$and = "AND".RET;		}		if($array['facility_city'] != "") {			$qry .= $and."facility_city = '".$array['facility_city']."'".RET;			$and = "AND".RET;		}		if($array['facility_zip'] != "") {			$qry .= $and."facility_zip = '".$array['facility_zip']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_1'] != "") {			$qry .= $and."facility_phone_1 = '".$array['facility_phone_1']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_2'] != "") {			$qry .= $and."facility_phone_2 = '".$array['facility_phone_2']."'".RET;			$and = "AND".RET;		}		if($array['facility_start_date'] != "") {			$qry .= $and."facility_start_date = '".$array['facility_start_date']."'".RET;			$and = "AND".RET;		}		if($array['facility_end_date'] != "") {			$qry .= $and."facility_end_date = '".$array['facility_end_date']."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setfacility_id($record['facility_id']);				$this->setfacility_owner($record['facility_owner']);				$this->setfacility_name($record['facility_name']);				$this->setfacility_address($record['facility_address']);				$this->setfacility_country($record['facility_country']);				$this->setfacility_state($record['facility_state']);				$this->setfacility_city($record['facility_city']);				$this->setfacility_zip($record['facility_zip']);				$this->setfacility_phone_1($record['facility_phone_1']);				$this->setfacility_phone_2($record['facility_phone_2']);				$this->setfacility_start_date($record['facility_start_date']);				$this->setfacility_end_date($record['facility_end_date']);				return true;			}		}	}	public static function readArray($array = array()) {		$qry = "SELECT *".RET."FROM ".HM_FACILITY.RET;		$and = "WHERE".RET;		if($array['facility_id'] != "") {			$qry .= $and."facility_id = '".$array['facility_id']."'".RET;			$and = "AND".RET;		}		if($array['facility_owner'] != "") {			$qry .= $and."facility_owner = '".$array['facility_owner']."'".RET;			$and = "AND".RET;		}		if($array['facility_name'] != "") {			$qry .= $and."facility_name = '".$array['facility_name']."'".RET;			$and = "AND".RET;		}		if($array['facility_address'] != "") {			$qry .= $and."facility_address = '".$array['facility_address']."'".RET;			$and = "AND".RET;		}		if($array['facility_country'] != "") {			$qry .= $and."facility_country = '".$array['facility_country']."'".RET;			$and = "AND".RET;		}		if($array['facility_state'] != "") {			$qry .= $and."facility_state = '".$array['facility_state']."'".RET;			$and = "AND".RET;		}		if($array['facility_city'] != "") {			$qry .= $and."facility_city = '".$array['facility_city']."'".RET;			$and = "AND".RET;		}		if($array['facility_zip'] != "") {			$qry .= $and."facility_zip = '".$array['facility_zip']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_1'] != "") {			$qry .= $and."facility_phone_1 = '".$array['facility_phone_1']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_2'] != "") {			$qry .= $and."facility_phone_2 = '".$array['facility_phone_2']."'".RET;			$and = "AND".RET;		}		if($array['facility_start_date'] != "") {			$qry .= $and."facility_start_date = '".$array['facility_start_date']."'".RET;			$and = "AND".RET;		}		if($array['facility_end_date'] != "") {			$qry .= $and."facility_end_date = '".$array['facility_end_date']."'".RET;			$and = "AND".RET;		}		$result = mysql_query($qry);		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$class_object = new hm_facility();				$class_object->setfacility_id($record['facility_id']);				$class_object->setfacility_owner($record['facility_owner']);				$class_object->setfacility_name($record['facility_name']);				$class_object->setfacility_address($record['facility_address']);				$class_object->setfacility_country($record['facility_country']);				$class_object->setfacility_state($record['facility_state']);				$class_object->setfacility_city($record['facility_city']);				$class_object->setfacility_zip($record['facility_zip']);				$class_object->setfacility_phone_1($record['facility_phone_1']);				$class_object->setfacility_phone_2($record['facility_phone_2']);				$class_object->setfacility_start_date($record['facility_start_date']);				$class_object->setfacility_end_date($record['facility_end_date']);				$class_objects[$class_object->getfacility_id()] = $class_object;			}		}		return $class_objects;	}	public function insert() {		if($this->getfacility_id() != '') {			$qry  = "UPDATE ".HM_FACILITY.RET."SET".RET.			"facility_id = '".$this->getfacility_id()."',".RET.			"facility_owner = '".$this->getfacility_owner()."',".RET.			"facility_name = '".$this->getfacility_name()."',".RET.			"facility_address = '".$this->getfacility_address()."',".RET.			"facility_country = '".$this->getfacility_country()."',".RET.			"facility_state = '".$this->getfacility_state()."',".RET.			"facility_city = '".$this->getfacility_city()."',".RET.			"facility_zip = '".$this->getfacility_zip()."',".RET.			"facility_phone_1 = '".$this->getfacility_phone_1()."',".RET.			"facility_phone_2 = '".$this->getfacility_phone_2()."',".RET.			"facility_start_date = '".$this->getfacility_start_date()."',".RET.			"facility_end_date = '".$this->getfacility_end_date()."'".RET.			"WHERE facility_id = ".$this->getfacility_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".HM_FACILITY." (".RET.			"facility_owner, facility_name, facility_address, facility_country, facility_state, facility_city, facility_zip, facility_phone_1, facility_phone_2, facility_start_date, facility_end_date".RET.				") VALUES (".RET.			"'".$this->getfacility_owner()."',".RET.			"'".$this->getfacility_name()."',".RET.			"'".$this->getfacility_address()."',".RET.			"'".$this->getfacility_country()."',".RET.			"'".$this->getfacility_state()."',".RET.			"'".$this->getfacility_city()."',".RET.			"'".$this->getfacility_zip()."',".RET.			"'".$this->getfacility_phone_1()."',".RET.			"'".$this->getfacility_phone_2()."',".RET.			"'".$this->getfacility_start_date()."',".RET.			"'".$this->getfacility_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setfacility_id(mysql_insert_id());		}	}	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".HM_FACILITY.RET;		$and = "WHERE".RET;		if($array['facility_id'] != "") {			$qry .= $and."facility_id = '".$array['facility_id']."'".RET;			$and = "AND".RET;		}		if($array['facility_owner'] != "") {			$qry .= $and."facility_owner = '".$array['facility_owner']."'".RET;			$and = "AND".RET;		}		if($array['facility_name'] != "") {			$qry .= $and."facility_name = '".$array['facility_name']."'".RET;			$and = "AND".RET;		}		if($array['facility_address'] != "") {			$qry .= $and."facility_address = '".$array['facility_address']."'".RET;			$and = "AND".RET;		}		if($array['facility_country'] != "") {			$qry .= $and."facility_country = '".$array['facility_country']."'".RET;			$and = "AND".RET;		}		if($array['facility_state'] != "") {			$qry .= $and."facility_state = '".$array['facility_state']."'".RET;			$and = "AND".RET;		}		if($array['facility_city'] != "") {			$qry .= $and."facility_city = '".$array['facility_city']."'".RET;			$and = "AND".RET;		}		if($array['facility_zip'] != "") {			$qry .= $and."facility_zip = '".$array['facility_zip']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_1'] != "") {			$qry .= $and."facility_phone_1 = '".$array['facility_phone_1']."'".RET;			$and = "AND".RET;		}		if($array['facility_phone_2'] != "") {			$qry .= $and."facility_phone_2 = '".$array['facility_phone_2']."'".RET;			$and = "AND".RET;		}		if($array['facility_start_date'] != "") {			$qry .= $and."facility_start_date = '".$array['facility_start_date']."'".RET;			$and = "AND".RET;		}		if($array['facility_end_date'] != "") {			$qry .= $and."facility_end_date = '".$array['facility_end_date']."'".RET;			$and = "AND".RET;		}		mysql_query($qry);	}		public function GetActiveFacilities(){		$arr = array();		$res = mysql_query("SELECT facility_id, facility_name FROM ".HM_FACILITY." WHERE facility_start_date > 0AND ( facility_end_date > CURDATE() OR facility_end_date =0 OR facility_end_date IS NULL)");		if($res){			while($row=mysql_fetch_assoc($res)){				$arr[$row['facility_id']] = $row['facility_name'];			}		}		return $arr;	}		public function GetControllerFacilities($staff_controll_id){		$arr = array();		$res = mysql_query("SELECT facility_id, facility_name FROM ".HM_FACILITY." WHERE `facility_owner`={$staff_controll_id}  AND `facility_start_date` > 0AND ( `facility_end_date` > CURDATE() OR `facility_end_date` =0 OR `facility_end_date` IS NULL)");		if($res){			while($row=mysql_fetch_assoc($res)){				$arr[$row['facility_id']] = $row['facility_name'];			}		}		return $arr;	}		public function updateStatus($id, $isDeactive=0){		 if($this->readObject(array("facility_id"=>$id))){		 if(is_gt_zero_num($isDeactive)){			$this->setfacility_start_date("0000-00-00 00:00:00");			$this->setfacility_end_date(date("Y-m-d H:i:s"));		 }else{		 	$this->setfacility_start_date(date("Y-m-d H:i:s"));			$this->setfacility_end_date("0000-00-00 00:00:00");		 }		 	$this->insert();		 }	}}?>