<?php/**********************************************************************hm_patient_facility.class.phpGenerated by STRUCTY 2012.12.26 05:16:32.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("HM_PATIENT_FACILITY", "hm_patient_facility"); class hm_patient_facility {	private $pt_faclty_id;	private $pt_faclty_patient;	private $pt_faclty_facility;	private $pt_faclty_start_date;	private $pt_faclty_end_date;	public function setpt_faclty_id($pArg="0") {$this->pt_faclty_id=$pArg;}	public function setpt_faclty_patient($pArg="0") {$this->pt_faclty_patient=$pArg;}	public function setpt_faclty_facility($pArg="0") {$this->pt_faclty_facility=$pArg;}	public function setpt_faclty_start_date($pArg="0") {$this->pt_faclty_start_date=$pArg;}	public function setpt_faclty_end_date($pArg="0") {$this->pt_faclty_end_date=$pArg;}	public function getpt_faclty_id() {return $this->pt_faclty_id;}	public function getpt_faclty_patient() {return $this->pt_faclty_patient;}	public function getpt_faclty_facility() {return $this->pt_faclty_facility;}	public function getpt_faclty_start_date() {return $this->pt_faclty_start_date;}	public function getpt_faclty_end_date() {return $this->pt_faclty_end_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".HM_PATIENT_FACILITY.RET;		$and = "WHERE".RET;		if($array['pt_faclty_id'] != "") {			$qry .= $and."pt_faclty_id = '".$array['pt_faclty_id']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_patient'] != "") {			$qry .= $and."pt_faclty_patient = '".$array['pt_faclty_patient']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_facility'] != "") {			$qry .= $and."pt_faclty_facility = '".$array['pt_faclty_facility']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_start_date'] != "") {			$qry .= $and."pt_faclty_start_date = '".$array['pt_faclty_start_date']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_end_date'] != "") {			$qry .= $and."pt_faclty_end_date = '".$array['pt_faclty_end_date']."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setpt_faclty_id($record['pt_faclty_id']);				$this->setpt_faclty_patient($record['pt_faclty_patient']);				$this->setpt_faclty_facility($record['pt_faclty_facility']);				$this->setpt_faclty_start_date($record['pt_faclty_start_date']);				$this->setpt_faclty_end_date($record['pt_faclty_end_date']);				return true;			}		}	}	public static function readArray($array = array()) {		$qry = "SELECT *".RET."FROM ".HM_PATIENT_FACILITY.RET;		$and = "WHERE".RET;		if($array['pt_faclty_id'] != "") {			$qry .= $and."pt_faclty_id = '".$array['pt_faclty_id']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_patient'] != "") {			$qry .= $and."pt_faclty_patient = '".$array['pt_faclty_patient']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_facility'] != "") {			$qry .= $and."pt_faclty_facility = '".$array['pt_faclty_facility']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_start_date'] != "") {			$qry .= $and."pt_faclty_start_date = '".$array['pt_faclty_start_date']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_end_date'] != "") {			$qry .= $and."pt_faclty_end_date = '".$array['pt_faclty_end_date']."'".RET;			$and = "AND".RET;		}		$result = mysql_query($qry);		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$class_object = new hm_patient_facility();				$class_object->setpt_faclty_id($record['pt_faclty_id']);				$class_object->setpt_faclty_patient($record['pt_faclty_patient']);				$class_object->setpt_faclty_facility($record['pt_faclty_facility']);				$class_object->setpt_faclty_start_date($record['pt_faclty_start_date']);				$class_object->setpt_faclty_end_date($record['pt_faclty_end_date']);				$class_objects[$class_object->getpt_faclty_id()] = $class_object;			}		}		return $class_objects;	}	public function insert() {		if($this->getpt_faclty_id() != '') {			$qry  = "UPDATE ".HM_PATIENT_FACILITY.RET."SET".RET.			"pt_faclty_id = '".$this->getpt_faclty_id()."',".RET.			"pt_faclty_patient = '".$this->getpt_faclty_patient()."',".RET.			"pt_faclty_facility = '".$this->getpt_faclty_facility()."',".RET.			"pt_faclty_start_date = '".$this->getpt_faclty_start_date()."',".RET.			"pt_faclty_end_date = '".$this->getpt_faclty_end_date()."'".RET.			"WHERE pt_faclty_id = ".$this->getpt_faclty_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".HM_PATIENT_FACILITY." (".RET.			"pt_faclty_patient, pt_faclty_facility, pt_faclty_start_date, pt_faclty_end_date".RET.				") VALUES (".RET.			"'".$this->getpt_faclty_patient()."',".RET.			"'".$this->getpt_faclty_facility()."',".RET.			"'".$this->getpt_faclty_start_date()."',".RET.			"'".$this->getpt_faclty_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setpt_faclty_id(mysql_insert_id());		}	}	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".HM_PATIENT_FACILITY.RET;		$and = "WHERE".RET;		if($array['pt_faclty_id'] != "") {			$qry .= $and."pt_faclty_id = '".$array['pt_faclty_id']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_patient'] != "") {			$qry .= $and."pt_faclty_patient = '".$array['pt_faclty_patient']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_facility'] != "") {			$qry .= $and."pt_faclty_facility = '".$array['pt_faclty_facility']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_start_date'] != "") {			$qry .= $and."pt_faclty_start_date = '".$array['pt_faclty_start_date']."'".RET;			$and = "AND".RET;		}		if($array['pt_faclty_end_date'] != "") {			$qry .= $and."pt_faclty_end_date = '".$array['pt_faclty_end_date']."'".RET;			$and = "AND".RET;		}		mysql_query($qry);	}		public function Getfacilitylistforpatient($patient_d){		$arr = array();        $res = mysql_query("SELECT GROUP_CONCAT(`pt_faclty_facility`) FROM ".HM_PATIENT_FACILITY." WHERE `pt_faclty_patient`={$patient} AND pt_faclty_start_date > 0 AND (pt_faclty_end_date =0 OR pt_faclty_end_date is NULL OR pt_faclty_end_date > CURDATE( ))");		if($res){			$arr =  explode(",",mysql_result($res,0));			if(!is_array($arr)){				return array($arr);			}			return $arr;		}		return array();	}		public function updateStatus($id, $isDeactive=0){		 if($this->readObject(array("pt_faclty_id"=>$id))){		 if(is_gt_zero_num($isDeactive)){			$this->setpt_faclty_start_date("0000-00-00 00:00:00");			$this->setpt_faclty_end_date(date("Y-m-d H:i:s"));		 }else{		 	$this->setpt_faclty_start_date(date("Y-m-d H:i:s"));			$this->setpt_faclty_end_date("0000-00-00 00:00:00");		 }		 	$this->insert();		 }	}}?>