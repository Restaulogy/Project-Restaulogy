<?php/**********************************************************************tbl_service_category.class.phpGenerated by STRUCTY 2013.03.20 07:07:15.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_SERVICE_CATEGORY", "tbl_service_category"); define('SRVC_CAT_ID', 'srvc_cat_id'); define('SRVC_CAT_CODE', 'srvc_cat_code'); define('SRVC_CAT_DESC', 'srvc_cat_desc'); define('SRVC_CAT_START_DATE', 'srvc_cat_start_date'); define('SRVC_CAT_END_DATE', 'srvc_cat_end_date'); define("TBL_SERVICE_CATEGORY_ACTIVE_DATE", "srvc_cat_start_date");define("TBL_SERVICE_CATEGORY_DEACTIVE_DATE", "srvc_cat_end_date");$tbl_service_category_active_condition= " (".TBL_SERVICE_CATEGORY_DEACTIVE_DATE." is NULL OR ".TBL_SERVICE_CATEGORY_DEACTIVE_DATE." = 0 OR ".TBL_SERVICE_CATEGORY_DEACTIVE_DATE." > CURDATE( )) ";class tbl_service_category {	private $srvc_cat_id;	private $srvc_cat_code;	private $srvc_cat_desc;	private $srvc_cat_start_date;	private $srvc_cat_end_date;	private $tbl_service_category_active_date;	private $tbl_service_category_deactive_date;	public function setsrvc_cat_id($pArg="0") {$this->srvc_cat_id=$pArg;}	public function setsrvc_cat_code($pArg="0") {$this->srvc_cat_code=$pArg;}	public function setsrvc_cat_desc($pArg="0") {$this->srvc_cat_desc=$pArg;}	public function setsrvc_cat_start_date($pArg="0") {$this->srvc_cat_start_date=$pArg;}	public function setsrvc_cat_end_date($pArg="0") {$this->srvc_cat_end_date=$pArg;}	public function settbl_service_category_active_date($pArg="0") {$this->tbl_service_category_active_date=$pArg;}	public function settbl_service_category_deactive_date($pArg="0") {$this->tbl_service_category_deactive_date=$pArg;}	public function getsrvc_cat_id() {return $this->srvc_cat_id;}	public function getsrvc_cat_code() {return $this->srvc_cat_code;}	public function getsrvc_cat_desc() {return $this->srvc_cat_desc;}	public function getsrvc_cat_start_date() {return $this->srvc_cat_start_date;}	public function getsrvc_cat_end_date() {return $this->srvc_cat_end_date;}	public function gettbl_service_category_active_date($pArg="0") {return $this->tbl_service_category_active_date;}	public function gettbl_service_category_deactive_date($pArg="0") {return $this->tbl_service_category_deactive_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_SERVICE_CATEGORY.RET;		$and = "WHERE".RET;		if($array[SRVC_CAT_ID] != "") {			$qry .= $and.SRVC_CAT_ID." = '".$array[SRVC_CAT_ID]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_CODE] != "") {			$qry .= $and.SRVC_CAT_CODE." = '".$array[SRVC_CAT_CODE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_DESC] != "") {			$qry .= $and.SRVC_CAT_DESC." = '".$array[SRVC_CAT_DESC]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_START_DATE] != "") {			$qry .= $and.SRVC_CAT_START_DATE." = '".$array[SRVC_CAT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_END_DATE] != "") {			$qry .= $and.SRVC_CAT_END_DATE." = '".$array[SRVC_CAT_END_DATE]."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setsrvc_cat_id($record[SRVC_CAT_ID]);				$this->setsrvc_cat_code($record[SRVC_CAT_CODE]);				$this->setsrvc_cat_desc($record[SRVC_CAT_DESC]);				$this->setsrvc_cat_start_date($record[SRVC_CAT_START_DATE]);				$this->setsrvc_cat_end_date($record[SRVC_CAT_END_DATE]);				$this->settbl_service_category_active_date($record[TBL_SERVICE_CATEGORY_ACTIVE_DATE]);				$this->settbl_service_category_deactive_date($record[TBL_SERVICE_CATEGORY_DEACTIVE_DATE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {		global $tbl_service_category_active_condition;		$qry = "SELECT *".RET."FROM ".TBL_SERVICE_CATEGORY.RET;		$and = "WHERE".RET;		if($array[SRVC_CAT_ID] != "") {			$qry .= $and.SRVC_CAT_ID." = '".$array[SRVC_CAT_ID]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_CODE] != "") {			$qry .= $and.SRVC_CAT_CODE." = '".$array[SRVC_CAT_CODE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_DESC] != "") {			$qry .= $and.SRVC_CAT_DESC." = '".$array[SRVC_CAT_DESC]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_START_DATE] != "") {			$qry .= $and.SRVC_CAT_START_DATE." = '".$array[SRVC_CAT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_END_DATE] != "") {			$qry .= $and.SRVC_CAT_END_DATE." = '".$array[SRVC_CAT_END_DATE]."'".RET;			$and = "AND".RET;		}		if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_service_category_active_condition;;			$and = "AND".RET;		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		$result = mysql_query ($qry_with_limit);		$r1 = mysql_query($qry);		$result_found = mysql_num_rows($r1);		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;								//..check deactive date is not set or 0				if((is_not_empty($record[TBL_SERVICE_CATEGORY_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_SERVICE_CATEGORY_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date 					if(strtotime($record[TBL_SERVICE_CATEGORY_DEACTIVE_DATE]) > strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}			 				 				if($isArray){					$class_object = array();					$class_object["srvc_cat_id"]=$record[SRVC_CAT_ID];					$class_object["srvc_cat_code"]=$record[SRVC_CAT_CODE];					$class_object["srvc_cat_desc"]=$record[SRVC_CAT_DESC];					$class_object["srvc_cat_start_date"]=$record[SRVC_CAT_START_DATE];					$class_object["srvc_cat_end_date"]=$record[SRVC_CAT_END_DATE];					$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_service_category();					$class_object->setsrvc_cat_id($record[SRVC_CAT_ID]);					$class_object->setsrvc_cat_code($record[SRVC_CAT_CODE]);					$class_object->setsrvc_cat_desc($record[SRVC_CAT_DESC]);					$class_object->setsrvc_cat_start_date($record[SRVC_CAT_START_DATE]);					$class_object->setsrvc_cat_end_date($record[SRVC_CAT_END_DATE]);				}				$class_objects[$record[SRVC_CAT_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->getsrvc_cat_id() != '') {			$qry  = "UPDATE ".TBL_SERVICE_CATEGORY.RET."SET".RET."			".SRVC_CAT_ID." = '".$this->getsrvc_cat_id()."',".RET."			".SRVC_CAT_CODE." = '".$this->getsrvc_cat_code()."',".RET."			".SRVC_CAT_DESC." = '".$this->getsrvc_cat_desc()."',".RET."			".SRVC_CAT_START_DATE." = '".$this->getsrvc_cat_start_date()."',".RET."			".SRVC_CAT_END_DATE." = '".$this->getsrvc_cat_end_date()."'".RET.			"WHERE ".SRVC_CAT_ID." = ".$this->getsrvc_cat_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_SERVICE_CATEGORY." (".RET.			"".SRVC_CAT_CODE.", ".SRVC_CAT_DESC.", ".SRVC_CAT_START_DATE.", ".SRVC_CAT_END_DATE.RET.				") VALUES (".RET.			"'".$this->getsrvc_cat_code()."',".RET.			"'".$this->getsrvc_cat_desc()."',".RET.			"'".$this->getsrvc_cat_start_date()."',".RET.			"'".$this->getsrvc_cat_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setsrvc_cat_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_SERVICE_CATEGORY.RET;		$and = "WHERE".RET;		if($array[SRVC_CAT_ID] != "") {			$qry .= $and.SRVC_CAT_ID." = '".$array[SRVC_CAT_ID]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_CODE] != "") {			$qry .= $and.SRVC_CAT_CODE." = '".$array[SRVC_CAT_CODE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_DESC] != "") {			$qry .= $and.SRVC_CAT_DESC." = '".$array[SRVC_CAT_DESC]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_START_DATE] != "") {			$qry .= $and.SRVC_CAT_START_DATE." = '".$array[SRVC_CAT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[SRVC_CAT_END_DATE] != "") {			$qry .= $and.SRVC_CAT_END_DATE." = '".$array[SRVC_CAT_END_DATE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($srvc_cat_code ,$srvc_cat_desc ,$srvc_cat_start_date ,$srvc_cat_end_date) {		$unique_arr = array();			//$unique_arr[SRVC_CAT_ID]=$srvc_cat_id;			$unique_arr[SRVC_CAT_CODE]=$srvc_cat_code;			//$unique_arr[SRVC_CAT_DESC]=$srvc_cat_desc;			//$unique_arr[SRVC_CAT_START_DATE]=$srvc_cat_start_date;			//$unique_arr[SRVC_CAT_END_DATE]=$srvc_cat_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($srvc_cat_code ,$srvc_cat_desc ,$srvc_cat_start_date ,$srvc_cat_end_date) {		if(is_not_empty($srvc_cat_code)){			if($this->isAlreadyThere($srvc_cat_code ,$srvc_cat_desc ,$srvc_cat_start_date ,$srvc_cat_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->setsrvc_cat_id("");				$this->setsrvc_cat_code($srvc_cat_code);				$this->setsrvc_cat_desc($srvc_cat_desc);				$this->setsrvc_cat_start_date(date(DATE_FORMAT)); 				$this->insert();				return $this->getsrvc_cat_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($srvc_cat_id, $srvc_cat_code, $srvc_cat_desc, $srvc_cat_start_date, $srvc_cat_end_date) {		if(is_gt_zero_num($srvc_cat_id)){			if ($this->readObject(array(SRVC_CAT_ID=>$srvc_cat_id))){				$this->setsrvc_cat_code($srvc_cat_code);				$this->setsrvc_cat_desc($srvc_cat_desc);				 				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update	public function activate($srvc_cat_id){		if(is_gt_zero_num($srvc_cat_id)){			if ($this->readObject(array(SRVC_CAT_ID=>$srvc_cat_id))){				$qry  = "UPDATE ".TBL_SERVICE_CATEGORY.RET."SET".RET."			".TBL_SERVICE_CATEGORY_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".SRVC_CAT_ID."={$srvc_cat_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($srvc_cat_id){		if(is_gt_zero_num($srvc_cat_id)){			if ($this->readObject(array(SRVC_CAT_ID=>$srvc_cat_id))){				$qry  = "UPDATE ".TBL_SERVICE_CATEGORY.RET."SET".RET."			".TBL_SERVICE_CATEGORY_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".SRVC_CAT_ID."={$srvc_cat_id}";			 				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public function GetInfo($srvc_cat_id) {		$info = array();		if($srvc_cat_id != ""){			if($this->readObject(array("srvc_cat_id"=>$srvc_cat_id))){				$info["srvc_cat_id"]=$this->getsrvc_cat_id();				$info["srvc_cat_code"]=$this->getsrvc_cat_code();				$info["srvc_cat_desc"]=$this->getsrvc_cat_desc();				$info["srvc_cat_start_date"]=$this->getsrvc_cat_start_date();				$info["srvc_cat_end_date"]=$this->getsrvc_cat_end_date();				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($this->gettbl_service_category_deactive_date())==false)  || (is_gt_zero_num(strtotime($this->gettbl_service_category_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($this->gettbl_service_category_deactive_date()) >= strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		return $info;		}	}//..End GetInfo}//..End tbl_service_category?>