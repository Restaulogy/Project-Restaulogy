<?php/**********************************************************************tbl_prom_reminder.class.phpGenerated by STRUCTY 2014.07.03 10:39:31.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_PROM_REMINDER", "tbl_prom_reminder"); define('PREM_ID', 'prem_id'); define('PREM_PROMOTION', 'prem_promotion'); define('PREM_USER', 'prem_user'); define('PREM_BEFORE', 'prem_before'); define('PREM_AFTER', 'prem_after'); define('PREM_SPC_DATE', 'prem_spc_date'); define('PREM_ACT_SEND_DT', 'prem_act_send_dt'); define('PREM_IS_SEND', 'prem_is_send'); define('PREM_START_DATE', 'prem_start_date'); define('PREM_END_DATE', 'prem_end_date'); define('PREM_PHONE', 'prem_phone'); define("TBL_PROM_REMINDER_ACTIVE_DATE",  PREM_START_DATE);define("TBL_PROM_REMINDER_DEACTIVE_DATE",  PREM_END_DATE);$tbl_prom_reminder_active_condition= " (".TBL_PROM_REMINDER_DEACTIVE_DATE." is NULL OR ".TBL_PROM_REMINDER_DEACTIVE_DATE." = 0 OR ".TBL_PROM_REMINDER_DEACTIVE_DATE." > CURDATE( )) ";class tbl_prom_reminder {	private $prem_id;	private $prem_promotion;	private $prem_user;	private $prem_before;	private $prem_after;	private $prem_spc_date;	private $prem_act_send_dt;	private $prem_is_send;	private $prem_start_date;	private $prem_end_date;	private $tbl_prom_reminder_active_date;	private $tbl_prom_reminder_deactive_date;		private $prem_phone;	public function setprem_id($pArg="0") {$this->prem_id=$pArg;}	public function setprem_promotion($pArg="0") {$this->prem_promotion=$pArg;}	public function setprem_user($pArg="0") {$this->prem_user=$pArg;}	public function setprem_before($pArg="0") {$this->prem_before=$pArg;}	public function setprem_after($pArg="0") {$this->prem_after=$pArg;}	public function setprem_spc_date($pArg="0") {$this->prem_spc_date=$pArg;}	public function setprem_act_send_dt($pArg="0") {$this->prem_act_send_dt=$pArg;}	public function setprem_is_send($pArg="0") {$this->prem_is_send=$pArg;}	public function setprem_start_date($pArg="0") {$this->prem_start_date=$pArg;}	public function setprem_end_date($pArg="0") {$this->prem_end_date=$pArg;}	public function settbl_prom_reminder_active_date($pArg="0") {$this->tbl_prom_reminder_active_date=$pArg;}	public function settbl_prom_reminder_deactive_date($pArg="0") {$this->tbl_prom_reminder_deactive_date=$pArg;}		public function setprem_phone($pArg="0") {$this->prem_phone=$pArg;}	public function getprem_id() {return $this->prem_id;}	public function getprem_promotion() {return $this->prem_promotion;}	public function getprem_user() {return $this->prem_user;}	public function getprem_before() {return $this->prem_before;}	public function getprem_after() {return $this->prem_after;}	public function getprem_spc_date() {return $this->prem_spc_date;}	public function getprem_act_send_dt() {return $this->prem_act_send_dt;}	public function getprem_is_send() {return $this->prem_is_send;}	public function getprem_start_date() {return $this->prem_start_date;}	public function getprem_end_date() {return $this->prem_end_date;}	public function gettbl_prom_reminder_active_date($pArg="0") {return $this->tbl_prom_reminder_active_date;}	public function gettbl_prom_reminder_deactive_date($pArg="0") {return $this->tbl_prom_reminder_deactive_date;}		public function getprem_phone() {return $this->prem_phone;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_PROM_REMINDER.RET;		$and = "WHERE".RET;		if($array[PREM_ID] != "") {			$qry .= $and.PREM_ID." = '".$array[PREM_ID]."'".RET;			$and = "AND".RET;		}		if($array[PREM_PROMOTION] != "") {			$qry .= $and.PREM_PROMOTION." = '".$array[PREM_PROMOTION]."'".RET;			$and = "AND".RET;		}		if($array[PREM_USER] != "") {			$qry .= $and.PREM_USER." = '".$array[PREM_USER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_BEFORE] != "") {			$qry .= $and.PREM_BEFORE." = '".$array[PREM_BEFORE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_AFTER] != "") {			$qry .= $and.PREM_AFTER." = '".$array[PREM_AFTER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_SPC_DATE] != "") {			$qry .= $and.PREM_SPC_DATE." = '".$array[PREM_SPC_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_ACT_SEND_DT] != "") {			$qry .= $and.PREM_ACT_SEND_DT." = '".$array[PREM_ACT_SEND_DT]."'".RET;			$and = "AND".RET;		}		if($array[PREM_IS_SEND] != "") {			$qry .= $and.PREM_IS_SEND." = '".$array[PREM_IS_SEND]."'".RET;			$and = "AND".RET;		}		if($array[PREM_START_DATE] != "") {			$qry .= $and.PREM_START_DATE." = '".$array[PREM_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_END_DATE] != "") {			$qry .= $and.PREM_END_DATE." = '".$array[PREM_END_DATE]."'".RET;			$and = "AND".RET;		}				if($array[PREM_PHONE] != "") {			$qry .= $and.PREM_PHONE." = '".$array[PREM_PHONE]."'".RET;			$and = "AND".RET;		}//echo $qry;	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setprem_id($record[PREM_ID]);				$this->setprem_promotion($record[PREM_PROMOTION]);				$this->setprem_user($record[PREM_USER]);				$this->setprem_before($record[PREM_BEFORE]);				$this->setprem_after($record[PREM_AFTER]);				$this->setprem_spc_date($record[PREM_SPC_DATE]);				$this->setprem_act_send_dt($record[PREM_ACT_SEND_DT]);				$this->setprem_is_send($record[PREM_IS_SEND]);				$this->setprem_start_date($record[PREM_START_DATE]);				$this->setprem_end_date($record[PREM_END_DATE]);				$this->settbl_prom_reminder_active_date($record[TBL_PROM_REMINDER_ACTIVE_DATE]);				$this->settbl_prom_reminder_deactive_date($record[TBL_PROM_REMINDER_DEACTIVE_DATE]);				$this->setprem_phone($record[PREM_PHONE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {		global $tbl_prom_reminder_active_condition;		$qry = "SELECT *".RET."FROM ".TBL_PROM_REMINDER.RET;		$and = "WHERE".RET;		if($array[PREM_ID] != "") {			$qry .= $and.PREM_ID." = '".$array[PREM_ID]."'".RET;			$and = "AND".RET;		}		if($array[PREM_PROMOTION] != "") {			$qry .= $and.PREM_PROMOTION." = '".$array[PREM_PROMOTION]."'".RET;			$and = "AND".RET;		}		if($array[PREM_USER] != "") {			$qry .= $and.PREM_USER." = '".$array[PREM_USER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_BEFORE] != "") {			$qry .= $and.PREM_BEFORE." = '".$array[PREM_BEFORE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_AFTER] != "") {			$qry .= $and.PREM_AFTER." = '".$array[PREM_AFTER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_SPC_DATE] != "") {			$qry .= $and.PREM_SPC_DATE." = '".$array[PREM_SPC_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_ACT_SEND_DT] != "") {			$qry .= $and.PREM_ACT_SEND_DT." = '".$array[PREM_ACT_SEND_DT]."'".RET;			$and = "AND".RET;		}		if($array[PREM_IS_SEND] != "") {			$qry .= $and.PREM_IS_SEND." = '".$array[PREM_IS_SEND]."'".RET;			$and = "AND".RET;		}		if($array[PREM_START_DATE] != "") {			$qry .= $and.PREM_START_DATE." = '".$array[PREM_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_END_DATE] != "") {			$qry .= $and.PREM_END_DATE." = '".$array[PREM_END_DATE]."'".RET;			$and = "AND".RET;		}		if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_prom_reminder_active_condition;;			$and = "AND".RET;		}				if($array[PREM_PHONE] != "") {			$qry .= $and.PREM_PHONE." = '".$array[PREM_PHONE]."'".RET;			$and = "AND".RET;		}		if(is_not_empty($array[SORT_ON]) && is_not_empty($array[SORT_BY])) {		$qry .=" ORDER BY ".$array[SORT_ON]." ".$array[SORT_BY];		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		$result = mysql_query ($qry_with_limit);		$r1 = mysql_query($qry);		if($r1){			$result_found = mysql_num_rows($r1);		}		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;				//..check deactive date is not set or 0				if((is_not_empty($record[TBL_PROM_REMINDER_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_PROM_REMINDER_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date					if(strtotime($record[TBL_PROM_REMINDER_DEACTIVE_DATE]) > strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}				if($isArray){					$class_object = array();					$class_object["prem_id"]=$record[PREM_ID];					$class_object["prem_promotion"]=$record[PREM_PROMOTION];					$class_object["prem_user"]=$record[PREM_USER];					$class_object["prem_before"]=$record[PREM_BEFORE];					$class_object["prem_after"]=$record[PREM_AFTER];					if($record[PREM_SPC_DATE]!=NULL)						$class_object["prem_spc_date"]=date('m/d/Y',strtotime($record[PREM_SPC_DATE]));					else							$class_object["prem_spc_date"]=NULL;												$class_object["prem_act_send_dt"]=$record[PREM_ACT_SEND_DT];					$class_object["prem_is_send"]=$record[PREM_IS_SEND];					$class_object["prem_start_date"]=$record[PREM_START_DATE];					$class_object["prem_end_date"]=$record[PREM_END_DATE];										$class_object["prem_phone"]=$record[PREM_PHONE];										$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_prom_reminder();					$class_object->setprem_id($record[PREM_ID]);					$class_object->setprem_promotion($record[PREM_PROMOTION]);					$class_object->setprem_user($record[PREM_USER]);					$class_object->setprem_before($record[PREM_BEFORE]);					$class_object->setprem_after($record[PREM_AFTER]);					$class_object->setprem_spc_date($record[PREM_SPC_DATE]);					$class_object->setprem_act_send_dt($record[PREM_ACT_SEND_DT]);					$class_object->setprem_is_send($record[PREM_IS_SEND]);					$class_object->setprem_start_date($record[PREM_START_DATE]);					$class_object->setprem_end_date($record[PREM_END_DATE]);										$class_object->setprem_phone($record[PREM_PHONE]);				}				$class_objects[$record[PREM_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->getprem_id() != '') {			$qry  = "UPDATE ".TBL_PROM_REMINDER.RET."SET".RET."			".PREM_ID." = '".$this->getprem_id()."',".RET."			".PREM_PROMOTION." = '".$this->getprem_promotion()."',".RET."			".PREM_USER." = '".$this->getprem_user()."',".RET."			".PREM_BEFORE." = '".$this->getprem_before()."',".RET."			".PREM_AFTER." = '". $this->getprem_after()."',".RET."			".PREM_SPC_DATE." = ".( ($this->getprem_spc_date()==NULL) ? 'NULL' : "'".$this->getprem_spc_date()."'").",".RET."			".PREM_ACT_SEND_DT." = '".$this->getprem_act_send_dt()."',".RET."			".PREM_IS_SEND." = '".$this->getprem_is_send()."',".RET."						".PREM_PHONE." = '".$this->getprem_phone()."',".RET."						".PREM_START_DATE." = '".$this->getprem_start_date()."',".RET."			".PREM_END_DATE." = '".$this->getprem_end_date()."'".RET.			"WHERE ".PREM_ID." = ".$this->getprem_id().RET;						mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_PROM_REMINDER." (".RET.			"".PREM_PROMOTION.", ".PREM_USER.", ".PREM_BEFORE.", ".PREM_AFTER.", ".PREM_SPC_DATE.", ".PREM_ACT_SEND_DT.", ".PREM_IS_SEND.", ".PREM_PHONE.", ".PREM_START_DATE.", ".PREM_END_DATE.RET.				") VALUES (".RET.			"'".$this->getprem_promotion()."',".RET.			"'".$this->getprem_user()."',".RET.			"'".$this->getprem_before()."',".RET.			"'".$this->getprem_after()."',".RET.			"".(($this->getprem_spc_date()==NULL) ? 'NULL' : "'".$this->getprem_spc_date()."'").",".RET.			"'".$this->getprem_act_send_dt()."',".RET.			"'".$this->getprem_is_send()."',".RET.						"'".$this->getprem_phone()."',".RET.						"'".$this->getprem_start_date()."',".RET.			"'".$this->getprem_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setprem_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_PROM_REMINDER.RET;		$and = "WHERE".RET;		if($array[PREM_ID] != "") {			$qry .= $and.PREM_ID." = '".$array[PREM_ID]."'".RET;			$and = "AND".RET;		}		if($array[PREM_PROMOTION] != "") {			$qry .= $and.PREM_PROMOTION." = '".$array[PREM_PROMOTION]."'".RET;			$and = "AND".RET;		}		if($array[PREM_USER] != "") {			$qry .= $and.PREM_USER." = '".$array[PREM_USER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_BEFORE] != "") {			$qry .= $and.PREM_BEFORE." = '".$array[PREM_BEFORE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_AFTER] != "") {			$qry .= $and.PREM_AFTER." = '".$array[PREM_AFTER]."'".RET;			$and = "AND".RET;		}		if($array[PREM_SPC_DATE] != "") {			$qry .= $and.PREM_SPC_DATE." = '".$array[PREM_SPC_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_ACT_SEND_DT] != "") {			$qry .= $and.PREM_ACT_SEND_DT." = '".$array[PREM_ACT_SEND_DT]."'".RET;			$and = "AND".RET;		}		if($array[PREM_IS_SEND] != "") {			$qry .= $and.PREM_IS_SEND." = '".$array[PREM_IS_SEND]."'".RET;			$and = "AND".RET;		}		if($array[PREM_START_DATE] != "") {			$qry .= $and.PREM_START_DATE." = '".$array[PREM_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[PREM_END_DATE] != "") {			$qry .= $and.PREM_END_DATE." = '".$array[PREM_END_DATE]."'".RET;			$and = "AND".RET;		}				if($array[PREM_PHONE] != "") {			$qry .= $and.PREM_PHONE." = '".$array[PREM_PHONE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($prem_promotion ,$prem_user ,$prem_before ,$prem_after ,$prem_spc_date ,$prem_act_send_dt ,$prem_is_send ,$prem_start_date ,$prem_end_date) {		$unique_arr = array();			//$unique_arr[PREM_ID]=$prem_id;			//$unique_arr[PREM_PROMOTION]=$prem_promotion;			//$unique_arr[PREM_USER]=$prem_user;			//$unique_arr[PREM_BEFORE]=$prem_before;			//$unique_arr[PREM_AFTER]=$prem_after;			//$unique_arr[PREM_SPC_DATE]=$prem_spc_date;			//$unique_arr[PREM_ACT_SEND_DT]=$prem_act_send_dt;			//$unique_arr[PREM_IS_SEND]=$prem_is_send;			//$unique_arr[PREM_START_DATE]=$prem_start_date;			//$unique_arr[PREM_END_DATE]=$prem_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($prem_promotion ,$prem_user ,$prem_before ,$prem_after ,$prem_spc_date ,$prem_act_send_dt ,$prem_is_send ,$prem_start_date ,$prem_end_date,$prem_phone='') {		if(is_not_empty($prem_promotion)){			if($this->isAlreadyThere($prem_promotion ,$prem_user ,$prem_before ,$prem_after ,$prem_spc_date ,$prem_act_send_dt ,$prem_is_send ,$prem_start_date ,$prem_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->setprem_id("");				$this->setprem_promotion($prem_promotion);				$this->setprem_user($prem_user);				$this->setprem_before($prem_before);				$this->setprem_after($prem_after);				if($prem_spc_date!=NULL)					$this->setprem_spc_date(date(DATE_FORMAT,strtotime($prem_spc_date)));				else					$this->setprem_spc_date(NULL);					$this->setprem_act_send_dt($prem_act_send_dt);				$this->setprem_is_send($prem_is_send);								$this->setprem_phone($prem_phone);								$this->setprem_start_date(date(DATE_FORMAT));				$this->insert();				return $this->getprem_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($prem_id, $prem_promotion, $prem_user, $prem_before, $prem_after, $prem_spc_date, $prem_act_send_dt, $prem_is_send, $prem_start_date, $prem_end_date,$prem_phone='') {		if(is_gt_zero_num($prem_id)){			if ($this->readObject(array(PREM_ID=>$prem_id))){				$this->setprem_promotion($prem_promotion);				$this->setprem_user($prem_user);				$this->setprem_before($prem_before);				$this->setprem_after($prem_after);				if($prem_spc_date!=NULL)					$this->setprem_spc_date(date(DATE_FORMAT,strtotime($prem_spc_date)));				else					$this->setprem_spc_date(NULL);										$this->setprem_act_send_dt($prem_act_send_dt);								$this->setprem_phone($prem_phone);								$this->setprem_is_send($prem_is_send);				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update	public function activate($prem_id){		if(is_gt_zero_num($prem_id)){			if ($this->readObject(array(PREM_ID=>$prem_id))){				$qry  = "UPDATE ".TBL_PROM_REMINDER.RET."SET".RET."			".TBL_PROM_REMINDER_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".PREM_ID."={$prem_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($prem_id){		if(is_gt_zero_num($prem_id)){			if ($this->readObject(array(PREM_ID=>$prem_id))){				$qry  = "UPDATE ".TBL_PROM_REMINDER.RET."SET".RET."			".TBL_PROM_REMINDER_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".PREM_ID."={$prem_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public static function GetInfo($prem_id=0,$promotion=0) {		$info = array();		$arr_filter=array();				if(is_gt_zero_num($prem_id)){			$arr_filter[PREM_ID]=$prem_id;		}		if(is_gt_zero_num($promotion)){			$arr_filter[PREM_PROMOTION]=$promotion;		}				//if($prem_id != ""){		if(is_not_empty($arr_filter)){			$obj_tbl_prom_reminder = new tbl_prom_reminder();			//if($obj_tbl_prom_reminder->readObject(array("prem_id"=>$prem_id))){			if($obj_tbl_prom_reminder->readObject($arr_filter)){				$info["prem_id"]=$obj_tbl_prom_reminder->getprem_id();				$info["prem_promotion"]=$obj_tbl_prom_reminder->getprem_promotion();				$info["prem_user"]=$obj_tbl_prom_reminder->getprem_user();				$info["prem_before"]=$obj_tbl_prom_reminder->getprem_before();				$info["prem_after"]=$obj_tbl_prom_reminder->getprem_after();				$info["prem_spc_date"]=$obj_tbl_prom_reminder->getprem_spc_date();				$info["prem_act_send_dt"]=$obj_tbl_prom_reminder->getprem_act_send_dt();				$info["prem_is_send"]=$obj_tbl_prom_reminder->getprem_is_send();								$info["prem_phone"]=$obj_tbl_prom_reminder->getprem_phone();								$info["prem_start_date"]=$obj_tbl_prom_reminder->getprem_start_date();				$info["prem_end_date"]=$obj_tbl_prom_reminder->getprem_end_date();				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($obj_tbl_prom_reminder->gettbl_prom_reminder_deactive_date())==false)  || (is_gt_zero_num(strtotime($obj_tbl_prom_reminder->gettbl_prom_reminder_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($obj_tbl_prom_reminder->gettbl_prom_reminder_deactive_date()) > strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		unset($obj_tbl_prom_reminder);		return $info;		}	}//..End GetInfo	public static function GetFields($data){		global $tbl_prom_reminder_active_condition;		$arr = array();		if(is_not_empty($data)){			$qry ="SELECT ".$data['key_field'].",".$data['value_field']." FROM ".TBL_PROM_REMINDER."";			if(is_gt_zero_num($data['isActive'])){				$qry .= " WHERE ".$tbl_prom_reminder_active_condition;			}			$res = mysql_query($qry); 			if($res){				while($row=mysql_fetch_assoc($res)){					$arr[$row[$data['key_field']]] = $row[$data['value_field']];				}			}		}		return $arr;	}//.. End of GetFields}//..End tbl_prom_reminder?>