<?php/**********************************************************************tbl_customers.class.phpGenerated by STRUCTY 2013.03.22 06:45:17.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_CUSTOMERS", "tbl_customers"); define('CUSTOMER_ID', 'customer_id'); define('CUTOMER_NAME', 'cutomer_name'); define('CUTOMER_PHONE_NO', 'cutomer_phone_no'); define('CUSTOMER_EMAIL', 'customer_email'); define('CUSTOMER_ADDRESS', 'customer_address'); define('CUSTOMER_CITY', 'customer_city'); define('CUSTOMER_ZIP', 'customer_zip'); define('CUTOMER_CREATED_ON', 'cutomer_created_on'); define('CUSTOMER_END_DATE', 'customer_end_date'); define("TBL_CUSTOMERS_ACTIVE_DATE", "cutomer_created_on");define("TBL_CUSTOMERS_DEACTIVE_DATE", "customer_end_date");$tbl_customers_active_condition= " (".TBL_CUSTOMERS_DEACTIVE_DATE." is NULL OR ".TBL_CUSTOMERS_DEACTIVE_DATE." = 0 OR ".TBL_CUSTOMERS_DEACTIVE_DATE." > CURDATE( )) ";class tbl_customers {	private $customer_id;	private $cutomer_name;	private $cutomer_phone_no;	private $customer_email;	private $customer_address;	private $customer_city;	private $customer_zip;	private $cutomer_created_on;	private $customer_end_date;	private $tbl_customers_active_date;	private $tbl_customers_deactive_date;	public function setcustomer_id($pArg="0") {$this->customer_id=$pArg;}	public function setcutomer_name($pArg="0") {$this->cutomer_name=$pArg;}	public function setcutomer_phone_no($pArg="0") {$this->cutomer_phone_no=$pArg;}	public function setcustomer_email($pArg="0") {$this->customer_email=$pArg;}	public function setcustomer_address($pArg="0") {$this->customer_address=$pArg;}	public function setcustomer_city($pArg="0") {$this->customer_city=$pArg;}	public function setcustomer_zip($pArg="0") {$this->customer_zip=$pArg;}	public function setcutomer_created_on($pArg="0") {$this->cutomer_created_on=$pArg;}	public function setcustomer_end_date($pArg="0") {$this->customer_end_date=$pArg;}	public function settbl_customers_active_date($pArg="0") {$this->tbl_customers_active_date=$pArg;}	public function settbl_customers_deactive_date($pArg="0") {$this->tbl_customers_deactive_date=$pArg;}	public function getcustomer_id() {return $this->customer_id;}	public function getcutomer_name() {return $this->cutomer_name;}	public function getcutomer_phone_no() {return $this->cutomer_phone_no;}	public function getcustomer_email() {return $this->customer_email;}	public function getcustomer_address() {return $this->customer_address;}	public function getcustomer_city() {return $this->customer_city;}	public function getcustomer_zip() {return $this->customer_zip;}	public function getcutomer_created_on() {return $this->cutomer_created_on;}	public function getcustomer_end_date() {return $this->customer_end_date;}	public function gettbl_customers_active_date($pArg="0") {return $this->tbl_customers_active_date;}	public function gettbl_customers_deactive_date($pArg="0") {return $this->tbl_customers_deactive_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_CUSTOMERS.RET;		$and = "WHERE".RET;		if($array[CUSTOMER_ID] != "") {			$qry .= $and.CUSTOMER_ID." = '".$array[CUSTOMER_ID]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_NAME] != "") {			$qry .= $and.CUTOMER_NAME." = '".$array[CUTOMER_NAME]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_PHONE_NO] != "") {			$qry .= $and.CUTOMER_PHONE_NO." = '".$array[CUTOMER_PHONE_NO]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_EMAIL] != "") {			$qry .= $and.CUSTOMER_EMAIL." = '".$array[CUSTOMER_EMAIL]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ADDRESS] != "") {			$qry .= $and.CUSTOMER_ADDRESS." = '".$array[CUSTOMER_ADDRESS]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_CITY] != "") {			$qry .= $and.CUSTOMER_CITY." = '".$array[CUSTOMER_CITY]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ZIP] != "") {			$qry .= $and.CUSTOMER_ZIP." = '".$array[CUSTOMER_ZIP]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_CREATED_ON] != "") {			$qry .= $and.CUTOMER_CREATED_ON." = '".$array[CUTOMER_CREATED_ON]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_END_DATE] != "") {			$qry .= $and.CUSTOMER_END_DATE." = '".$array[CUSTOMER_END_DATE]."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setcustomer_id($record[CUSTOMER_ID]);				$this->setcutomer_name($record[CUTOMER_NAME]);				$this->setcutomer_phone_no($record[CUTOMER_PHONE_NO]);				$this->setcustomer_email($record[CUSTOMER_EMAIL]);				$this->setcustomer_address($record[CUSTOMER_ADDRESS]);				$this->setcustomer_city($record[CUSTOMER_CITY]);				$this->setcustomer_zip($record[CUSTOMER_ZIP]);				$this->setcutomer_created_on($record[CUTOMER_CREATED_ON]);				$this->setcustomer_end_date($record[CUSTOMER_END_DATE]);				$this->settbl_customers_active_date($record[TBL_CUSTOMERS_ACTIVE_DATE]);				$this->settbl_customers_deactive_date($record[TBL_CUSTOMERS_DEACTIVE_DATE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {		global $tbl_customers_active_condition;		$qry = "SELECT *".RET."FROM ".TBL_CUSTOMERS.RET;		$and = "WHERE".RET;		if($array[CUSTOMER_ID] != "") {			$qry .= $and.CUSTOMER_ID." = '".$array[CUSTOMER_ID]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_NAME] != "") {			$qry .= $and.CUTOMER_NAME." = '".$array[CUTOMER_NAME]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_PHONE_NO] != "") {			$qry .= $and.CUTOMER_PHONE_NO." = '".$array[CUTOMER_PHONE_NO]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_EMAIL] != "") {			$qry .= $and.CUSTOMER_EMAIL." = '".$array[CUSTOMER_EMAIL]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ADDRESS] != "") {			$qry .= $and.CUSTOMER_ADDRESS." = '".$array[CUSTOMER_ADDRESS]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_CITY] != "") {			$qry .= $and.CUSTOMER_CITY." = '".$array[CUSTOMER_CITY]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ZIP] != "") {			$qry .= $and.CUSTOMER_ZIP." = '".$array[CUSTOMER_ZIP]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_CREATED_ON] != "") {			$qry .= $and.CUTOMER_CREATED_ON." = '".$array[CUTOMER_CREATED_ON]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_END_DATE] != "") {			$qry .= $and.CUSTOMER_END_DATE." = '".$array[CUSTOMER_END_DATE]."'".RET;			$and = "AND".RET;		}		if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_customers_active_condition;;			$and = "AND".RET;		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		$result = mysql_query ($qry_with_limit);		$r1 = mysql_query($qry);		$result_found = mysql_num_rows($r1);		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;				//..check deactive date is not set or 0				if((is_not_empty($record[TBL_CUSTOMERS_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_CUSTOMERS_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date					if(strtotime($record[TBL_CUSTOMERS_DEACTIVE_DATE]) >= strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}				if($isArray){					$class_object = array();					$class_object["customer_id"]=$record[CUSTOMER_ID];					$class_object["cutomer_name"]=$record[CUTOMER_NAME];					$class_object["cutomer_phone_no"]=$record[CUTOMER_PHONE_NO];					$class_object["customer_email"]=$record[CUSTOMER_EMAIL];					$class_object["customer_address"]=$record[CUSTOMER_ADDRESS];					$class_object["customer_city"]=$record[CUSTOMER_CITY];					$class_object["customer_zip"]=$record[CUSTOMER_ZIP];					$class_object["cutomer_created_on"]=$record[CUTOMER_CREATED_ON];					$class_object["customer_end_date"]=$record[CUSTOMER_END_DATE];					$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_customers();					$class_object->setcustomer_id($record[CUSTOMER_ID]);					$class_object->setcutomer_name($record[CUTOMER_NAME]);					$class_object->setcutomer_phone_no($record[CUTOMER_PHONE_NO]);					$class_object->setcustomer_email($record[CUSTOMER_EMAIL]);					$class_object->setcustomer_address($record[CUSTOMER_ADDRESS]);					$class_object->setcustomer_city($record[CUSTOMER_CITY]);					$class_object->setcustomer_zip($record[CUSTOMER_ZIP]);					$class_object->setcutomer_created_on($record[CUTOMER_CREATED_ON]);					$class_object->setcustomer_end_date($record[CUSTOMER_END_DATE]);				}				$class_objects[$record[CUSTOMER_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->getcustomer_id() != '') {			$qry  = "UPDATE ".TBL_CUSTOMERS.RET."SET".RET."			".CUSTOMER_ID." = '".$this->getcustomer_id()."',".RET."			".CUTOMER_NAME." = '".$this->getcutomer_name()."',".RET."			".CUTOMER_PHONE_NO." = '".$this->getcutomer_phone_no()."',".RET."			".CUSTOMER_EMAIL." = '".$this->getcustomer_email()."',".RET."			".CUSTOMER_ADDRESS." = '".$this->getcustomer_address()."',".RET."			".CUSTOMER_CITY." = '".$this->getcustomer_city()."',".RET."			".CUSTOMER_ZIP." = '".$this->getcustomer_zip()."',".RET."			".CUTOMER_CREATED_ON." = '".$this->getcutomer_created_on()."',".RET."			".CUSTOMER_END_DATE." = '".$this->getcustomer_end_date()."'".RET.			"WHERE ".CUSTOMER_ID." = ".$this->getcustomer_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_CUSTOMERS." (".RET.			"".CUTOMER_NAME.", ".CUTOMER_PHONE_NO.", ".CUSTOMER_EMAIL.", ".CUSTOMER_ADDRESS.", ".CUSTOMER_CITY.", ".CUSTOMER_ZIP.", ".CUTOMER_CREATED_ON.", ".CUSTOMER_END_DATE.RET.				") VALUES (".RET.			"'".$this->getcutomer_name()."',".RET.			"'".$this->getcutomer_phone_no()."',".RET.			"'".$this->getcustomer_email()."',".RET.			"'".$this->getcustomer_address()."',".RET.			"'".$this->getcustomer_city()."',".RET.			"'".$this->getcustomer_zip()."',".RET.			"'".$this->getcutomer_created_on()."',".RET.			"'".$this->getcustomer_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setcustomer_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_CUSTOMERS.RET;		$and = "WHERE".RET;		if($array[CUSTOMER_ID] != "") {			$qry .= $and.CUSTOMER_ID." = '".$array[CUSTOMER_ID]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_NAME] != "") {			$qry .= $and.CUTOMER_NAME." = '".$array[CUTOMER_NAME]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_PHONE_NO] != "") {			$qry .= $and.CUTOMER_PHONE_NO." = '".$array[CUTOMER_PHONE_NO]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_EMAIL] != "") {			$qry .= $and.CUSTOMER_EMAIL." = '".$array[CUSTOMER_EMAIL]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ADDRESS] != "") {			$qry .= $and.CUSTOMER_ADDRESS." = '".$array[CUSTOMER_ADDRESS]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_CITY] != "") {			$qry .= $and.CUSTOMER_CITY." = '".$array[CUSTOMER_CITY]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_ZIP] != "") {			$qry .= $and.CUSTOMER_ZIP." = '".$array[CUSTOMER_ZIP]."'".RET;			$and = "AND".RET;		}		if($array[CUTOMER_CREATED_ON] != "") {			$qry .= $and.CUTOMER_CREATED_ON." = '".$array[CUTOMER_CREATED_ON]."'".RET;			$and = "AND".RET;		}		if($array[CUSTOMER_END_DATE] != "") {			$qry .= $and.CUSTOMER_END_DATE." = '".$array[CUSTOMER_END_DATE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($cutomer_name ,$cutomer_phone_no ,$customer_email ,$customer_address ,$customer_city ,$customer_zip ,$cutomer_created_on ,$customer_end_date) {		$unique_arr = array();			//$unique_arr[CUSTOMER_ID]=$customer_id;			  $unique_arr[CUTOMER_NAME]=$cutomer_name;			//$unique_arr[CUTOMER_PHONE_NO]=$cutomer_phone_no;			  $unique_arr[CUSTOMER_EMAIL]=$customer_email;			//$unique_arr[CUSTOMER_ADDRESS]=$customer_address;			//$unique_arr[CUSTOMER_CITY]=$customer_city;			//$unique_arr[CUSTOMER_ZIP]=$customer_zip;			//$unique_arr[CUTOMER_CREATED_ON]=$cutomer_created_on;			//$unique_arr[CUSTOMER_END_DATE]=$customer_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($cutomer_name ,$cutomer_phone_no ,$customer_email ,$customer_address ,$customer_city ,$customer_zip ,$cutomer_created_on ,$customer_end_date) {		if(is_not_empty($cutomer_name)){			if($this->isAlreadyThere($cutomer_name ,$cutomer_phone_no ,$customer_email ,$customer_address ,$customer_city ,$customer_zip ,$cutomer_created_on ,$customer_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->setcustomer_id("");				$this->setcutomer_name($cutomer_name);				$this->setcutomer_phone_no($cutomer_phone_no);				$this->setcustomer_email($customer_email);				$this->setcustomer_address($customer_address);				$this->setcustomer_city($customer_city);				$this->setcustomer_zip($customer_zip);				$this->setcutomer_created_on(date(DATE_FORMAT));				$this->setcustomer_end_date($customer_end_date);				$this->insert();				return $this->getcustomer_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($customer_id, $cutomer_name, $cutomer_phone_no, $customer_email, $customer_address, $customer_city, $customer_zip, $cutomer_created_on, $customer_end_date) {		if(is_gt_zero_num($customer_id)){			if ($this->readObject(array(CUSTOMER_ID=>$customer_id))){				$this->setcutomer_name($cutomer_name);				$this->setcutomer_phone_no($cutomer_phone_no);				$this->setcustomer_email($customer_email);				$this->setcustomer_address($customer_address);				$this->setcustomer_city($customer_city);				$this->setcustomer_zip($customer_zip);				//$this->setcutomer_created_on($cutomer_created_on);				//$this->setcustomer_end_date($customer_end_date);				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update	public function activate($customer_id){		if(is_gt_zero_num($customer_id)){			if ($this->readObject(array(CUSTOMER_ID=>$customer_id))){				$qry  = "UPDATE ".TBL_CUSTOMERS.RET."SET".RET."			".TBL_CUSTOMERS_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".CUSTOMER_ID."={$customer_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($customer_id){		if(is_gt_zero_num($customer_id)){			if ($this->readObject(array(CUSTOMER_ID=>$customer_id))){				$qry  = "UPDATE ".TBL_CUSTOMERS.RET."SET".RET."			".TBL_CUSTOMERS_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".CUSTOMER_ID."={$customer_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public function GetInfo($customer_id) {		$info = array();		if($customer_id != ""){			if($this->readObject(array("customer_id"=>$customer_id))){				$info["customer_id"]=$this->getcustomer_id();				$info["cutomer_name"]=$this->getcutomer_name();				$info["cutomer_phone_no"]=$this->getcutomer_phone_no();				$info["customer_email"]=$this->getcustomer_email();				$info["customer_address"]=$this->getcustomer_address();				$info["customer_city"]=$this->getcustomer_city();				$info["customer_zip"]=$this->getcustomer_zip();				$info["cutomer_created_on"]=$this->getcutomer_created_on();				$info["customer_end_date"]=$this->getcustomer_end_date();				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($this->gettbl_customers_deactive_date())==false)  || (is_gt_zero_num(strtotime($this->gettbl_customers_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($this->gettbl_customers_deactive_date()) >= strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		return $info;		}	}//..End GetInfo}//..End tbl_customers?>