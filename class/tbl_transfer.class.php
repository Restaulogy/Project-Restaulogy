<?php/**********************************************************************tbl_transfer.class.phpGenerated by STRUCTY 2013.09.24 10:53:16.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_TRANSFER", "tbl_transfer"); define('TRANS_ID', 'trans_id'); define('TRANS_TABLE', 'trans_table'); define('TRANS_OLD_SERVER', 'trans_old_server'); define('TRANS_NEW_SERVER', 'trans_new_server'); define('TRANS_CREATED_BY', 'trans_created_by'); define('TRANS_TIME_FROM', 'trans_time_from'); define('TRANS_TIME_TO', 'trans_time_to'); define('TRANS_START_DATE', 'trans_start_date'); define('TRANS_END_DATE', 'trans_end_date'); define("TBL_TRANSFER_ACTIVE_DATE",  TRANS_START_DATE);define("TBL_TRANSFER_DEACTIVE_DATE",  TRANS_END_DATE);$tbl_transfer_active_condition= " (".TBL_TRANSFER_DEACTIVE_DATE." is NULL OR ".TBL_TRANSFER_DEACTIVE_DATE." = 0 OR ".TBL_TRANSFER_DEACTIVE_DATE." > CURDATE( )) ";class tbl_transfer {	private $trans_id;	private $trans_table;	private $trans_old_server;	private $trans_new_server;	private $trans_created_by;	private $trans_time_from;	private $trans_time_to;	private $trans_start_date;	private $trans_end_date;	private $tbl_transfer_active_date;	private $tbl_transfer_deactive_date;	public function settrans_id($pArg="0") {$this->trans_id=$pArg;}	public function settrans_table($pArg="0") {$this->trans_table=$pArg;}	public function settrans_old_server($pArg="0") {$this->trans_old_server=$pArg;}	public function settrans_new_server($pArg="0") {$this->trans_new_server=$pArg;}	public function settrans_created_by($pArg="0") {$this->trans_created_by=$pArg;}	public function settrans_time_from($pArg="0") {$this->trans_time_from=$pArg;}	public function settrans_time_to($pArg="0") {$this->trans_time_to=$pArg;}	public function settrans_start_date($pArg="0") {$this->trans_start_date=$pArg;}	public function settrans_end_date($pArg="0") {$this->trans_end_date=$pArg;}	public function settbl_transfer_active_date($pArg="0") {$this->tbl_transfer_active_date=$pArg;}	public function settbl_transfer_deactive_date($pArg="0") {$this->tbl_transfer_deactive_date=$pArg;}	public function gettrans_id() {return $this->trans_id;}	public function gettrans_table() {return $this->trans_table;}	public function gettrans_old_server() {return $this->trans_old_server;}	public function gettrans_new_server() {return $this->trans_new_server;}	public function gettrans_created_by() {return $this->trans_created_by;}	public function gettrans_time_from() {return $this->trans_time_from;}	public function gettrans_time_to() {return $this->trans_time_to;}	public function gettrans_start_date() {return $this->trans_start_date;}	public function gettrans_end_date() {return $this->trans_end_date;}	public function gettbl_transfer_active_date($pArg="0") {return $this->tbl_transfer_active_date;}	public function gettbl_transfer_deactive_date($pArg="0") {return $this->tbl_transfer_deactive_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_TRANSFER.RET;		$and = "WHERE".RET;		if($array[TRANS_ID] != "") {			$qry .= $and.TRANS_ID." = '".$array[TRANS_ID]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TABLE] != "") {			$qry .= $and.TRANS_TABLE." = '".$array[TRANS_TABLE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_OLD_SERVER] != "") {			$qry .= $and.TRANS_OLD_SERVER." = '".$array[TRANS_OLD_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_NEW_SERVER] != "") {			$qry .= $and.TRANS_NEW_SERVER." = '".$array[TRANS_NEW_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_CREATED_BY] != "") {			$qry .= $and.TRANS_CREATED_BY." = '".$array[TRANS_CREATED_BY]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_FROM] != "") {			$qry .= $and.TRANS_TIME_FROM." = '".$array[TRANS_TIME_FROM]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_TO] != "") {			$qry .= $and.TRANS_TIME_TO." = '".$array[TRANS_TIME_TO]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_START_DATE] != "") {			$qry .= $and.TRANS_START_DATE." = '".$array[TRANS_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_END_DATE] != "") {			$qry .= $and.TRANS_END_DATE." = '".$array[TRANS_END_DATE]."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->settrans_id($record[TRANS_ID]);				$this->settrans_table($record[TRANS_TABLE]);				$this->settrans_old_server($record[TRANS_OLD_SERVER]);				$this->settrans_new_server($record[TRANS_NEW_SERVER]);				$this->settrans_created_by($record[TRANS_CREATED_BY]);				$this->settrans_time_from($record[TRANS_TIME_FROM]);				$this->settrans_time_to($record[TRANS_TIME_TO]);				$this->settrans_start_date($record[TRANS_START_DATE]);				$this->settrans_end_date($record[TRANS_END_DATE]);				$this->settbl_transfer_active_date($record[TBL_TRANSFER_ACTIVE_DATE]);				$this->settbl_transfer_deactive_date($record[TBL_TRANSFER_DEACTIVE_DATE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {		global $tbl_transfer_active_condition;		$qry = "SELECT *".RET."FROM ".TBL_TRANSFER.RET;		$and = "WHERE".RET;		if($array[TRANS_ID] != "") {			$qry .= $and.TRANS_ID." = '".$array[TRANS_ID]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TABLE] != "") {			$qry .= $and.TRANS_TABLE." = '".$array[TRANS_TABLE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_OLD_SERVER] != "") {			$qry .= $and.TRANS_OLD_SERVER." = '".$array[TRANS_OLD_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_NEW_SERVER] != "") {			$qry .= $and.TRANS_NEW_SERVER." = '".$array[TRANS_NEW_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_CREATED_BY] != "") {			$qry .= $and.TRANS_CREATED_BY." = '".$array[TRANS_CREATED_BY]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_FROM] != "") {			$qry .= $and.TRANS_TIME_FROM." = '".$array[TRANS_TIME_FROM]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_TO] != "") {			$qry .= $and.TRANS_TIME_TO." = '".$array[TRANS_TIME_TO]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_START_DATE] != "") {			$qry .= $and.TRANS_START_DATE." = '".$array[TRANS_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_END_DATE] != "") {			$qry .= $and.TRANS_END_DATE." = '".$array[TRANS_END_DATE]."'".RET;			$and = "AND".RET;		}		if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_transfer_active_condition;;			$and = "AND".RET;		}		if(is_not_empty($array[SORT_ON]) && is_not_empty($array[SORT_BY])) {		$qry .=" ORDER BY ".$array[SORT_ON]." ".$array[SORT_BY];		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		$result = mysql_query ($qry_with_limit);		$r1 = mysql_query($qry);		if($r1){			$result_found = mysql_num_rows($r1);		}		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;				//..check deactive date is not set or 0				if((is_not_empty($record[TBL_TRANSFER_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_TRANSFER_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date					if(strtotime($record[TBL_TRANSFER_DEACTIVE_DATE]) > strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}				if($isArray){					$class_object = array();					$class_object["trans_id"]=$record[TRANS_ID];					$class_object["trans_table"]=$record[TRANS_TABLE];					$class_object["trans_old_server"]=$record[TRANS_OLD_SERVER];					$class_object["trans_new_server"]=$record[TRANS_NEW_SERVER];					$class_object["trans_created_by"]=$record[TRANS_CREATED_BY];					$class_object["trans_time_from"]=$record[TRANS_TIME_FROM];					$class_object["trans_time_to"]=$record[TRANS_TIME_TO];					$class_object["trans_start_date"]=$record[TRANS_START_DATE];					$class_object["trans_end_date"]=$record[TRANS_END_DATE];					$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_transfer();					$class_object->settrans_id($record[TRANS_ID]);					$class_object->settrans_table($record[TRANS_TABLE]);					$class_object->settrans_old_server($record[TRANS_OLD_SERVER]);					$class_object->settrans_new_server($record[TRANS_NEW_SERVER]);					$class_object->settrans_created_by($record[TRANS_CREATED_BY]);					$class_object->settrans_time_from($record[TRANS_TIME_FROM]);					$class_object->settrans_time_to($record[TRANS_TIME_TO]);					$class_object->settrans_start_date($record[TRANS_START_DATE]);					$class_object->settrans_end_date($record[TRANS_END_DATE]);				}				$class_objects[$record[TRANS_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->gettrans_id() != '') {			$qry  = "UPDATE ".TBL_TRANSFER.RET."SET".RET."			".TRANS_ID." = '".$this->gettrans_id()."',".RET."			".TRANS_TABLE." = '".$this->gettrans_table()."',".RET."			".TRANS_OLD_SERVER." = '".$this->gettrans_old_server()."',".RET."			".TRANS_NEW_SERVER." = '".$this->gettrans_new_server()."',".RET."			".TRANS_CREATED_BY." = '".$this->gettrans_created_by()."',".RET."			".TRANS_TIME_FROM." = '".$this->gettrans_time_from()."',".RET."			".TRANS_TIME_TO." = '".$this->gettrans_time_to()."',".RET."			".TRANS_START_DATE." = '".$this->gettrans_start_date()."',".RET."			".TRANS_END_DATE." = '".$this->gettrans_end_date()."'".RET.			"WHERE ".TRANS_ID." = ".$this->gettrans_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_TRANSFER." (".RET.			"".TRANS_TABLE.", ".TRANS_OLD_SERVER.", ".TRANS_NEW_SERVER.", ".TRANS_CREATED_BY.", ".TRANS_TIME_FROM.", ".TRANS_TIME_TO.", ".TRANS_START_DATE.", ".TRANS_END_DATE.RET.				") VALUES (".RET.			"'".$this->gettrans_table()."',".RET.			"'".$this->gettrans_old_server()."',".RET.			"'".$this->gettrans_new_server()."',".RET.			"'".$this->gettrans_created_by()."',".RET.			"'".$this->gettrans_time_from()."',".RET.			"'".$this->gettrans_time_to()."',".RET.			"'".$this->gettrans_start_date()."',".RET.			"'".$this->gettrans_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->settrans_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_TRANSFER.RET;		$and = "WHERE".RET;		if($array[TRANS_ID] != "") {			$qry .= $and.TRANS_ID." = '".$array[TRANS_ID]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TABLE] != "") {			$qry .= $and.TRANS_TABLE." = '".$array[TRANS_TABLE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_OLD_SERVER] != "") {			$qry .= $and.TRANS_OLD_SERVER." = '".$array[TRANS_OLD_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_NEW_SERVER] != "") {			$qry .= $and.TRANS_NEW_SERVER." = '".$array[TRANS_NEW_SERVER]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_CREATED_BY] != "") {			$qry .= $and.TRANS_CREATED_BY." = '".$array[TRANS_CREATED_BY]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_FROM] != "") {			$qry .= $and.TRANS_TIME_FROM." = '".$array[TRANS_TIME_FROM]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_TIME_TO] != "") {			$qry .= $and.TRANS_TIME_TO." = '".$array[TRANS_TIME_TO]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_START_DATE] != "") {			$qry .= $and.TRANS_START_DATE." = '".$array[TRANS_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TRANS_END_DATE] != "") {			$qry .= $and.TRANS_END_DATE." = '".$array[TRANS_END_DATE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($trans_table ,$trans_old_server ,$trans_new_server ,$trans_created_by ,$trans_time_from ,$trans_time_to ,$trans_start_date ,$trans_end_date) {		$unique_arr = array();			//$unique_arr[TRANS_ID]=$trans_id;			//$unique_arr[TRANS_TABLE]=$trans_table;			//$unique_arr[TRANS_OLD_SERVER]=$trans_old_server;			//$unique_arr[TRANS_NEW_SERVER]=$trans_new_server;			//$unique_arr[TRANS_CREATED_BY]=$trans_created_by;			//$unique_arr[TRANS_TIME_FROM]=$trans_time_from;			//$unique_arr[TRANS_TIME_TO]=$trans_time_to;			//$unique_arr[TRANS_START_DATE]=$trans_start_date;			//$unique_arr[TRANS_END_DATE]=$trans_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($trans_table ,$trans_old_server ,$trans_new_server ,$trans_created_by ,$trans_time_from ,$trans_time_to ,$trans_start_date ,$trans_end_date) {		if(is_not_empty($trans_table)){			if($this->isAlreadyThere($trans_table ,$trans_old_server ,$trans_new_server ,$trans_created_by ,$trans_time_from ,$trans_time_to ,$trans_start_date ,$trans_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->settrans_id("");				$this->settrans_table($trans_table);				$this->settrans_old_server($trans_old_server);				$this->settrans_new_server($trans_new_server);				$this->settrans_created_by($trans_created_by);				$this->settrans_time_from($trans_time_from);				$this->settrans_time_to($trans_time_to);				$this->settrans_start_date(date(DATE_FORMAT));				$this->insert();				return $this->gettrans_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($trans_id, $trans_table, $trans_old_server, $trans_new_server, $trans_created_by, $trans_time_from, $trans_time_to, $trans_start_date, $trans_end_date) {		if(is_gt_zero_num($trans_id)){			if ($this->readObject(array(TRANS_ID=>$trans_id))){				$this->settrans_table($trans_table);				$this->settrans_old_server($trans_old_server);				$this->settrans_new_server($trans_new_server);				$this->settrans_created_by($trans_created_by);				$this->settrans_time_from($trans_time_from);				$this->settrans_time_to($trans_time_to);				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update	public function activate($trans_id){		if(is_gt_zero_num($trans_id)){			if ($this->readObject(array(TRANS_ID=>$trans_id))){				$qry  = "UPDATE ".TBL_TRANSFER.RET."SET".RET."			".TBL_TRANSFER_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".TRANS_ID."={$trans_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($trans_id){		if(is_gt_zero_num($trans_id)){			if ($this->readObject(array(TRANS_ID=>$trans_id))){				$qry  = "UPDATE ".TBL_TRANSFER.RET."SET".RET."			".TBL_TRANSFER_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".TRANS_ID."={$trans_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public static function GetInfo($trans_id) {		$info = array();		if($trans_id != ""){			$obj_tbl_transfer = new tbl_transfer();			if($obj_tbl_transfer->readObject(array("trans_id"=>$trans_id))){				$info["trans_id"]=$obj_tbl_transfer->gettrans_id();				$info["trans_table"]=$obj_tbl_transfer->gettrans_table();				$info["trans_old_server"]=$obj_tbl_transfer->gettrans_old_server();				$info["trans_new_server"]=$obj_tbl_transfer->gettrans_new_server();				$info["trans_created_by"]=$obj_tbl_transfer->gettrans_created_by();				$info["trans_time_from"]=$obj_tbl_transfer->gettrans_time_from();				$info["trans_time_to"]=$obj_tbl_transfer->gettrans_time_to();				$info["trans_start_date"]=$obj_tbl_transfer->gettrans_start_date();				$info["trans_end_date"]=$obj_tbl_transfer->gettrans_end_date();				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($obj_tbl_transfer->gettbl_transfer_deactive_date())==false)  || (is_gt_zero_num(strtotime($obj_tbl_transfer->gettbl_transfer_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($obj_tbl_transfer->gettbl_transfer_deactive_date()) > strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		unset($obj_tbl_transfer);		return $info;		}	}//..End GetInfo	public static function GetFields($data){		global $tbl_transfer_active_condition;		$arr = array();		if(is_not_empty($data)){			$qry ="SELECT ".$data['key_field'].",".$data['value_field']." FROM ".TBL_TRANSFER."";			if(is_gt_zero_num($data['isActive'])){				$qry .= " WHERE ".$tbl_transfer_active_condition;			}			$res = mysql_query($qry); 			if($res){				while($row=mysql_fetch_assoc($res)){					$arr[$row[$data['key_field']]] = $row[$data['value_field']];				}			}		}		return $arr;	}//.. End of GetFields}//..End tbl_transfer?>