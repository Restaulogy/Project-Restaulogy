<?php/**********************************************************************tbl_temp_reward_sess.class.phpGenerated by STRUCTY 2014.04.30 09:50:02.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_TEMP_REWARD_SESS", "tbl_temp_reward_sess"); define('TMP_RWSE_ID', 'tmp_rwse_id'); define('TMP_RWSE_USER_ID', 'tmp_rwse_user_id'); define('TMP_RWSE_TABLE_ID', 'tmp_rwse_table_id'); define('TMP_RWSE_TABLE_SESSION', 'tmp_rwse_table_session'); define('TMP_RWSE_UNIQUE_CD', 'tmp_rwse_unique_cd'); define('TMP_RWSE_REQUEST_TYPE', 'tmp_rwse_request_type');define('TMP_RWSE_STATUS', 'tmp_rwse_status'); define('TMP_RWSE_COOKIE_ID', 'tmp_rwse_cookie_id'); define('TMP_RWSE_START_DATE', 'tmp_rwse_start_date'); define('TMP_RWSE_END_DATE', 'tmp_rwse_end_date'); define("TBL_TEMP_REWARD_SESS_ACTIVE_DATE",  TMP_RWSE_START_DATE);define("TBL_TEMP_REWARD_SESS_DEACTIVE_DATE",  TMP_RWSE_END_DATE);$tbl_temp_reward_sess_active_condition= " (".TBL_TEMP_REWARD_SESS_DEACTIVE_DATE." is NULL OR ".TBL_TEMP_REWARD_SESS_DEACTIVE_DATE." = 0 OR ".TBL_TEMP_REWARD_SESS_DEACTIVE_DATE." > CURDATE( )) ";class tbl_temp_reward_sess {	private $tmp_rwse_id;	private $tmp_rwse_user_id;	private $tmp_rwse_table_id;	private $tmp_rwse_table_session;	private $tmp_rwse_unique_cd;		private $tmp_rwse_request_type;		private $tmp_rwse_status;	private $tmp_rwse_cookie_id;	private $tmp_rwse_start_date;	private $tmp_rwse_end_date;	private $tbl_temp_reward_sess_active_date;	private $tbl_temp_reward_sess_deactive_date;	public function settmp_rwse_id($pArg="0") {$this->tmp_rwse_id=$pArg;}	public function settmp_rwse_user_id($pArg="0") {$this->tmp_rwse_user_id=$pArg;}	public function settmp_rwse_table_id($pArg="0") {$this->tmp_rwse_table_id=$pArg;}	public function settmp_rwse_table_session($pArg="0") {$this->tmp_rwse_table_session=$pArg;}	public function settmp_rwse_request_type($pArg="0") {$this->tmp_rwse_request_type=$pArg;}		public function settmp_rwse_unique_cd($pArg="0") {$this->tmp_rwse_unique_cd=$pArg;}		public function settmp_rwse_status($pArg="0") {$this->tmp_rwse_status=$pArg;}	public function settmp_rwse_cookie_id($pArg="0") {$this->tmp_rwse_cookie_id=$pArg;}	public function settmp_rwse_start_date($pArg="0") {$this->tmp_rwse_start_date=$pArg;}	public function settmp_rwse_end_date($pArg="0") {$this->tmp_rwse_end_date=$pArg;}	public function settbl_temp_reward_sess_active_date($pArg="0") {$this->tbl_temp_reward_sess_active_date=$pArg;}	public function settbl_temp_reward_sess_deactive_date($pArg="0") {$this->tbl_temp_reward_sess_deactive_date=$pArg;}	public function gettmp_rwse_id() {return $this->tmp_rwse_id;}	public function gettmp_rwse_user_id() {return $this->tmp_rwse_user_id;}	public function gettmp_rwse_table_id() {return $this->tmp_rwse_table_id;}	public function gettmp_rwse_table_session() {return $this->tmp_rwse_table_session;}	public function gettmp_rwse_unique_cd() {return $this->tmp_rwse_unique_cd;}		public function gettmp_rwse_request_type() {return $this->tmp_rwse_request_type;}		public function gettmp_rwse_status() {return $this->tmp_rwse_status;}	public function gettmp_rwse_cookie_id() {return $this->tmp_rwse_cookie_id;}	public function gettmp_rwse_start_date() {return $this->tmp_rwse_start_date;}	public function gettmp_rwse_end_date() {return $this->tmp_rwse_end_date;}	public function gettbl_temp_reward_sess_active_date($pArg="0") {return $this->tbl_temp_reward_sess_active_date;}	public function gettbl_temp_reward_sess_deactive_date($pArg="0") {return $this->tbl_temp_reward_sess_deactive_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_TEMP_REWARD_SESS.RET;		$and = "WHERE".RET;		if($array[TMP_RWSE_ID] != "") {			$qry .= $and.TMP_RWSE_ID." = '".$array[TMP_RWSE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_USER_ID] != "") {			$qry .= $and.TMP_RWSE_USER_ID." = '".$array[TMP_RWSE_USER_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_ID] != "") {			$qry .= $and.TMP_RWSE_TABLE_ID." = '".$array[TMP_RWSE_TABLE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_SESSION] != "") {			$qry .= $and.TMP_RWSE_TABLE_SESSION." = '".$array[TMP_RWSE_TABLE_SESSION]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_UNIQUE_CD] != "") {			$qry .= $and.TMP_RWSE_UNIQUE_CD." = '".$array[TMP_RWSE_UNIQUE_CD]."'".RET;			$and = "AND".RET;		}				if($array[TMP_RWSE_REQUEST_TYPE] != "") {			$qry .= $and.TMP_RWSE_REQUEST_TYPE." = '".$array[TMP_RWSE_REQUEST_TYPE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_STATUS] != "") {			$qry .= $and.TMP_RWSE_STATUS." = '".$array[TMP_RWSE_STATUS]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_COOKIE_ID] != "") {			$qry .= $and.TMP_RWSE_COOKIE_ID." = '".$array[TMP_RWSE_COOKIE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_START_DATE] != "") {			$qry .= $and.TMP_RWSE_START_DATE." = '".$array[TMP_RWSE_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_END_DATE] != "") {			$qry .= $and.TMP_RWSE_END_DATE." = '".$array[TMP_RWSE_END_DATE]."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->settmp_rwse_id($record[TMP_RWSE_ID]);				$this->settmp_rwse_user_id($record[TMP_RWSE_USER_ID]);				$this->settmp_rwse_table_id($record[TMP_RWSE_TABLE_ID]);				$this->settmp_rwse_table_session($record[TMP_RWSE_TABLE_SESSION]);								$this->settmp_rwse_request_type($record[TMP_RWSE_REQUEST_TYPE]);								$this->settmp_rwse_unique_cd($record[TMP_RWSE_UNIQUE_CD]);				$this->settmp_rwse_status($record[TMP_RWSE_STATUS]);				$this->settmp_rwse_cookie_id($record[TMP_RWSE_COOKIE_ID]);				$this->settmp_rwse_start_date($record[TMP_RWSE_START_DATE]);				$this->settmp_rwse_end_date($record[TMP_RWSE_END_DATE]);				$this->settbl_temp_reward_sess_active_date($record[TBL_TEMP_REWARD_SESS_ACTIVE_DATE]);				$this->settbl_temp_reward_sess_deactive_date($record[TBL_TEMP_REWARD_SESS_DEACTIVE_DATE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {		global $tbl_temp_reward_sess_active_condition;		//$qry = "SELECT *".RET."FROM ".TBL_TEMP_REWARD_SESS.RET;		$qry = "SELECT `r`.*,`t`.`".TABLE_RESTAURANT."`,`t`.`".TABLE_NUMBER."`,									CONCAT(`".TBL_STAFF."`.`".STAFF_FNAME."`,',',`".TBL_STAFF."`.`".STAFF_LNAME."`) as `staff_full_name`,									`".MEMBERS."`.`email` as `staff_email` 						FROM `".TBL_TEMP_REWARD_SESS."` as `r`  						INNER JOIN `".TBL_DINING_TABLE."` as `t` ON						`r`.`".TMP_RWSE_TABLE_ID."`=`t`.`".TABLE_ID."`						INNER JOIN ".TBL_STAFF." ON 						".STAFF_MEMBER_ID."=".TMP_RWSE_USER_ID." 						INNER JOIN ".MEMBERS." ON 						".STAFF_MEMBER_ID."=".MEMBERS.".`id` 						";				$and = "WHERE".RET;				if($array[TABLE_RESTAURANT] != "") {			$qry .= $and.TABLE_RESTAURANT." = ".$array[TABLE_RESTAURANT]."".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_ID] != "") {			$qry .= $and.TMP_RWSE_ID." = '".$array[TMP_RWSE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_USER_ID] != "") {			$qry .= $and.TMP_RWSE_USER_ID." = '".$array[TMP_RWSE_USER_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_ID] != "") {			$qry .= $and.TMP_RWSE_TABLE_ID." = '".$array[TMP_RWSE_TABLE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_SESSION] != "") {			$qry .= $and.TMP_RWSE_TABLE_SESSION." = '".$array[TMP_RWSE_TABLE_SESSION]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_UNIQUE_CD] != "") {			$qry .= $and.TMP_RWSE_UNIQUE_CD." = '".$array[TMP_RWSE_UNIQUE_CD]."'".RET;			$and = "AND".RET;		}			  if($array[TMP_RWSE_REQUEST_TYPE] != "") {			$qry .= $and.TMP_RWSE_REQUEST_TYPE." = '".$array[TMP_RWSE_REQUEST_TYPE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_STATUS] != "") {			$qry .= $and.TMP_RWSE_STATUS." = '".$array[TMP_RWSE_STATUS]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_COOKIE_ID] != "") {			$qry .= $and.TMP_RWSE_COOKIE_ID." = '".$array[TMP_RWSE_COOKIE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_START_DATE] != "") {			$qry .= $and.TMP_RWSE_START_DATE." = '".$array[TMP_RWSE_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_END_DATE] != "") {			$qry .= $and.TMP_RWSE_END_DATE." = '".$array[TMP_RWSE_END_DATE]."'".RET;			$and = "AND".RET;		}				if(is_gt_zero_num($array['todays_only'])){						$qry .= $and.TMP_RWSE_START_DATE.' >= \''.date('Y-m-d 00:00:00').'\''.RET.'AND '.TMP_RWSE_START_DATE.' <= \''.date('Y-m-d 23:59:59').'\''.RET;			$and = 'AND'.RET;		}			if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_temp_reward_sess_active_condition;;			$and = "AND".RET;		}		if(is_not_empty($array[SORT_ON]) && is_not_empty($array[SORT_BY])) {		$qry .=" ORDER BY ".$array[SORT_ON]." ".$array[SORT_BY];		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		$result = mysql_query ($qry_with_limit);		//echo $qry_with_limit;				$r1 = mysql_query($qry);		if($r1){			$result_found = mysql_num_rows($r1);		}		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;				//..check deactive date is not set or 0				if((is_not_empty($record[TBL_TEMP_REWARD_SESS_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_TEMP_REWARD_SESS_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date					if(strtotime($record[TBL_TEMP_REWARD_SESS_DEACTIVE_DATE]) > strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}				if($isArray){					$class_object = array();					$class_object["tmp_rwse_id"]=$record[TMP_RWSE_ID];					$class_object["tmp_rwse_user_id"]=$record[TMP_RWSE_USER_ID];					$class_object["tmp_rwse_table_id"]=$record[TMP_RWSE_TABLE_ID];					$class_object["tmp_rwse_table_session"]=$record[TMP_RWSE_TABLE_SESSION];										$class_object["tmp_rwse_request_type"]=$record[TMP_RWSE_REQUEST_TYPE];										$class_object["tmp_rwse_unique_cd"]=$record[TMP_RWSE_UNIQUE_CD];					$class_object["tmp_rwse_status"]=$record[TMP_RWSE_STATUS];					$class_object["tmp_rwse_cookie_id"]=$record[TMP_RWSE_COOKIE_ID];					$class_object["tmp_rwse_start_date"]=$record[TMP_RWSE_START_DATE];					$class_object["tmp_rwse_end_date"]=$record[TMP_RWSE_END_DATE];										$class_object['staff_table']=$record[TABLE_NUMBER];					$class_object["staff_full_name"]=$record['staff_full_name'];					$class_object["staff_email"]=$record['staff_email'];										$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_temp_reward_sess();					$class_object->settmp_rwse_id($record[TMP_RWSE_ID]);					$class_object->settmp_rwse_user_id($record[TMP_RWSE_USER_ID]);					$class_object->settmp_rwse_table_id($record[TMP_RWSE_TABLE_ID]);					$class_object->settmp_rwse_table_session($record[TMP_RWSE_TABLE_SESSION]);										$class_object->settmp_rwse_request_type($record[TMP_RWSE_REQUEST_TYPE]);										$class_object->settmp_rwse_unique_cd($record[TMP_RWSE_UNIQUE_CD]);					$class_object->settmp_rwse_status($record[TMP_RWSE_STATUS]);					$class_object->settmp_rwse_cookie_id($record[TMP_RWSE_COOKIE_ID]);					$class_object->settmp_rwse_start_date($record[TMP_RWSE_START_DATE]);					$class_object->settmp_rwse_end_date($record[TMP_RWSE_END_DATE]);				}				$class_objects[$record[TMP_RWSE_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->gettmp_rwse_id() != '') {			$qry  = "UPDATE ".TBL_TEMP_REWARD_SESS.RET."SET".RET."			".TMP_RWSE_ID." = '".$this->gettmp_rwse_id()."',".RET."			".TMP_RWSE_USER_ID." = '".$this->gettmp_rwse_user_id()."',".RET."			".TMP_RWSE_TABLE_ID." = '".$this->gettmp_rwse_table_id()."',".RET."			".TMP_RWSE_TABLE_SESSION." = '".$this->gettmp_rwse_table_session()."',".RET."						".TMP_RWSE_REQUEST_TYPE." = '".$this->gettmp_rwse_request_type()."',".RET."						".TMP_RWSE_UNIQUE_CD." = '".$this->gettmp_rwse_unique_cd()."',".RET."			".TMP_RWSE_STATUS." = '".$this->gettmp_rwse_status()."',".RET."			".TMP_RWSE_COOKIE_ID." = '".$this->gettmp_rwse_cookie_id()."',".RET."			".TMP_RWSE_START_DATE." = '".$this->gettmp_rwse_start_date()."',".RET."			".TMP_RWSE_END_DATE." = '".$this->gettmp_rwse_end_date()."'".RET.			"WHERE ".TMP_RWSE_ID." = ".$this->gettmp_rwse_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_TEMP_REWARD_SESS." (".RET.			"".TMP_RWSE_USER_ID.", ".TMP_RWSE_TABLE_ID.", ".TMP_RWSE_TABLE_SESSION.", ".TMP_RWSE_REQUEST_TYPE.", ".TMP_RWSE_UNIQUE_CD.", ".TMP_RWSE_STATUS.", ".TMP_RWSE_COOKIE_ID.", ".TMP_RWSE_START_DATE.", ".TMP_RWSE_END_DATE.RET.				") VALUES (".RET.			"'".$this->gettmp_rwse_user_id()."',".RET.			"'".$this->gettmp_rwse_table_id()."',".RET.			"'".$this->gettmp_rwse_table_session()."',".RET.						"'".$this->gettmp_rwse_request_type()."',".RET.						"'".$this->gettmp_rwse_unique_cd()."',".RET.			"'".$this->gettmp_rwse_status()."',".RET.			"'".$this->gettmp_rwse_cookie_id()."',".RET.			"'".$this->gettmp_rwse_start_date()."',".RET.			"'".$this->gettmp_rwse_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->settmp_rwse_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_TEMP_REWARD_SESS.RET;		$and = "WHERE".RET;		if($array[TMP_RWSE_ID] != "") {			$qry .= $and.TMP_RWSE_ID." = '".$array[TMP_RWSE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_USER_ID] != "") {			$qry .= $and.TMP_RWSE_USER_ID." = '".$array[TMP_RWSE_USER_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_ID] != "") {			$qry .= $and.TMP_RWSE_TABLE_ID." = '".$array[TMP_RWSE_TABLE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_TABLE_SESSION] != "") {			$qry .= $and.TMP_RWSE_TABLE_SESSION." = '".$array[TMP_RWSE_TABLE_SESSION]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_UNIQUE_CD] != "") {			$qry .= $and.TMP_RWSE_UNIQUE_CD." = '".$array[TMP_RWSE_UNIQUE_CD]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_REQUEST_TYPE] != "") {			$qry .= $and.TMP_RWSE_REQUEST_TYPE." = '".$array[TMP_RWSE_REQUEST_TYPE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_STATUS] != "") {			$qry .= $and.TMP_RWSE_STATUS." = '".$array[TMP_RWSE_STATUS]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_COOKIE_ID] != "") {			$qry .= $and.TMP_RWSE_COOKIE_ID." = '".$array[TMP_RWSE_COOKIE_ID]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_START_DATE] != "") {			$qry .= $and.TMP_RWSE_START_DATE." = '".$array[TMP_RWSE_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[TMP_RWSE_END_DATE] != "") {			$qry .= $and.TMP_RWSE_END_DATE." = '".$array[TMP_RWSE_END_DATE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($tmp_rwse_user_id ,$tmp_rwse_table_id ,$tmp_rwse_table_session ,$tmp_rwse_unique_cd ,$tmp_rwse_status ,$tmp_rwse_cookie_id ,$tmp_rwse_start_date ,$tmp_rwse_end_date) {		$unique_arr = array();			//$unique_arr[TMP_RWSE_ID]=$tmp_rwse_id;			//$unique_arr[TMP_RWSE_USER_ID]=$tmp_rwse_user_id;			//$unique_arr[TMP_RWSE_TABLE_ID]=$tmp_rwse_table_id;			//$unique_arr[TMP_RWSE_TABLE_SESSION]=$tmp_rwse_table_session;			//$unique_arr[TMP_RWSE_UNIQUE_CD]=$tmp_rwse_unique_cd;			//$unique_arr[TMP_RWSE_STATUS]=$tmp_rwse_status;			//$unique_arr[TMP_RWSE_COOKIE_ID]=$tmp_rwse_cookie_id;			//$unique_arr[TMP_RWSE_START_DATE]=$tmp_rwse_start_date;			//$unique_arr[TMP_RWSE_END_DATE]=$tmp_rwse_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($tmp_rwse_user_id ,$tmp_rwse_table_id ,$tmp_rwse_table_session ,$tmp_rwse_unique_cd ,$tmp_rwse_status ,$tmp_rwse_cookie_id ,$tmp_rwse_start_date ,$tmp_rwse_end_date,$tmp_rwse_request_type='VISIT') {		if(is_not_empty($tmp_rwse_user_id)){			if($this->isAlreadyThere($tmp_rwse_user_id ,$tmp_rwse_table_id ,$tmp_rwse_table_session ,$tmp_rwse_unique_cd ,$tmp_rwse_status ,$tmp_rwse_cookie_id ,$tmp_rwse_start_date ,$tmp_rwse_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->settmp_rwse_id("");				$this->settmp_rwse_user_id($tmp_rwse_user_id);				$this->settmp_rwse_table_id($tmp_rwse_table_id);				$this->settmp_rwse_table_session($tmp_rwse_table_session);								$this->settmp_rwse_request_type($tmp_rwse_request_type);								$this->settmp_rwse_unique_cd($tmp_rwse_unique_cd);				$this->settmp_rwse_status($tmp_rwse_status);				$this->settmp_rwse_cookie_id($tmp_rwse_cookie_id);				$this->settmp_rwse_start_date(date(DATE_FORMAT));				$this->insert();				return $this->gettmp_rwse_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($tmp_rwse_id, $tmp_rwse_user_id, $tmp_rwse_table_id, $tmp_rwse_table_session, $tmp_rwse_unique_cd, $tmp_rwse_status, $tmp_rwse_cookie_id, $tmp_rwse_start_date, $tmp_rwse_end_date,$tmp_rwse_request_type='VISIT') {		if(is_gt_zero_num($tmp_rwse_id)){			if ($this->readObject(array(TMP_RWSE_ID=>$tmp_rwse_id))){				$this->settmp_rwse_user_id($tmp_rwse_user_id);				$this->settmp_rwse_table_id($tmp_rwse_table_id);				$this->settmp_rwse_table_session($tmp_rwse_table_session);								$this->settmp_rwse_request_type($tmp_rwse_request_type);								$this->settmp_rwse_unique_cd($tmp_rwse_unique_cd);				$this->settmp_rwse_status($tmp_rwse_status);				$this->settmp_rwse_cookie_id($tmp_rwse_cookie_id);				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update		public function _update_status($tmp_rwse_id,$new_status){		if(is_gt_zero_num($tmp_rwse_id)){			if ($this->readObject(array(TMP_RWSE_ID=>$tmp_rwse_id))){				$qry  = "UPDATE `".TBL_TEMP_REWARD_SESS."` SET".RET."			`".TMP_RWSE_STATUS."` = '".$new_status."' WHERE `".TMP_RWSE_ID."`={$tmp_rwse_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function activate($tmp_rwse_id){		if(is_gt_zero_num($tmp_rwse_id)){			if ($this->readObject(array(TMP_RWSE_ID=>$tmp_rwse_id))){				$qry  = "UPDATE ".TBL_TEMP_REWARD_SESS.RET."SET".RET."			".TBL_TEMP_REWARD_SESS_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".TMP_RWSE_ID."={$tmp_rwse_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($tmp_rwse_id){		if(is_gt_zero_num($tmp_rwse_id)){			if ($this->readObject(array(TMP_RWSE_ID=>$tmp_rwse_id))){				$qry  = "UPDATE ".TBL_TEMP_REWARD_SESS.RET."SET".RET."			".TBL_TEMP_REWARD_SESS_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".TMP_RWSE_ID."={$tmp_rwse_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public static function GetInfo($tmp_rwse_id) {		$info = array();		if($tmp_rwse_id != ""){			$obj_tbl_temp_reward_sess = new tbl_temp_reward_sess();			if($obj_tbl_temp_reward_sess->readObject(array("tmp_rwse_id"=>$tmp_rwse_id))){				$info["tmp_rwse_id"]=$obj_tbl_temp_reward_sess->gettmp_rwse_id();				$info["tmp_rwse_user_id"]=$obj_tbl_temp_reward_sess->gettmp_rwse_user_id();				$info["tmp_rwse_table_id"]=$obj_tbl_temp_reward_sess->gettmp_rwse_table_id();				$info["tmp_rwse_table_session"]=$obj_tbl_temp_reward_sess->gettmp_rwse_table_session();				$info["tmp_rwse_request_type"]=$obj_tbl_temp_reward_sess->gettmp_rwse_request_type();								$info["tmp_rwse_unique_cd"]=$obj_tbl_temp_reward_sess->gettmp_rwse_unique_cd();				$info["tmp_rwse_status"]=$obj_tbl_temp_reward_sess->gettmp_rwse_status();				$info["tmp_rwse_cookie_id"]=$obj_tbl_temp_reward_sess->gettmp_rwse_cookie_id();				$info["tmp_rwse_start_date"]=$obj_tbl_temp_reward_sess->gettmp_rwse_start_date();				$info["tmp_rwse_end_date"]=$obj_tbl_temp_reward_sess->gettmp_rwse_end_date();				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($obj_tbl_temp_reward_sess->gettbl_temp_reward_sess_deactive_date())==false)  || (is_gt_zero_num(strtotime($obj_tbl_temp_reward_sess->gettbl_temp_reward_sess_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($obj_tbl_temp_reward_sess->gettbl_temp_reward_sess_deactive_date()) > strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		unset($obj_tbl_temp_reward_sess);		return $info;		}	}//..End GetInfo	public static function GetFields($data){		global $tbl_temp_reward_sess_active_condition;		$arr = array();		if(is_not_empty($data)){			$qry ="SELECT ".$data['key_field'].",".$data['value_field']." FROM ".TBL_TEMP_REWARD_SESS."";			if(is_gt_zero_num($data['isActive'])){				$qry .= " WHERE ".$tbl_temp_reward_sess_active_condition;			}			$res = mysql_query($qry); 			if($res){				while($row=mysql_fetch_assoc($res)){					$arr[$row[$data['key_field']]] = $row[$data['value_field']];				}			}		}		return $arr;	}//.. End of GetFields		public static function chk_if_record_wthin_2_hrs($cust_id,$tbl_id,$req_type){		//echo 'SELECT `'.TMP_RWSE_ID.'` FROM `'.TBL_TEMP_REWARD_SESS.'` WHERE  `'.TMP_RWSE_USER_ID.'`='.$cust_id.' AND `'.TMP_RWSE_TABLE_ID.'`='.$tbl_id.' AND `'.TMP_RWSE_REQUEST_TYPE.'`="'.$req_type.'" AND `'.TMP_RWSE_START_DATE.'` > SUBDATE( "'.date(DATE_FORMAT).'", INTERVAL 2 HOUR);';		$is_found=DB::ExecScalarQry('SELECT COUNT(`'.TMP_RWSE_ID.'`) as `is_fnd` FROM `'.TBL_TEMP_REWARD_SESS.'` WHERE  `'.TMP_RWSE_USER_ID.'`='.$cust_id.' AND `'.TMP_RWSE_TABLE_ID.'`='.$tbl_id.' AND `'.TMP_RWSE_REQUEST_TYPE.'`="'.$req_type.'" AND `'.TMP_RWSE_START_DATE.'` > SUBDATE( "'.date(DATE_FORMAT).'", INTERVAL 2 HOUR);');	//echo "is_found=$is_found";		return $is_found;	} }//..End tbl_temp_reward_sess?>