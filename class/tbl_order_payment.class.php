<?php/**********************************************************************tbl_order_payment.class.phpGenerated by STRUCTY 2013.07.03 06:14:00.Copyright 2011 Structy, Frédéric Aebi. All rights reserved.**********************************************************************/define("TBL_ORDER_PAYMENT", "tbl_order_payment"); define('ORD_PMNT_ID', 'ord_pmnt_id'); define('ORD_PMNT_TABLE_SESS', 'ord_pmnt_table_sess'); define('ORD_PMNT_ORDER', 'ord_pmnt_order'); define('ORD_PMNT_BILL_AMNT', 'ord_pmnt_bill_amnt'); define('ORD_PMNT_CREATED_BY', 'ord_pmnt_created_by'); define('ORD_PMNT_OPTION', 'ord_pmnt_option'); define('ORD_PMNT_SPLIT_AMNG', 'ord_pmnt_split_amng'); define('ORD_PMNT_PAID_BY', 'ord_pmnt_paid_by'); define('ORD_PMNT_AMNT_PAID', 'ord_pmnt_amnt_paid'); define('ORD_PMNT_CREATED_TYPE','ord_pmnt_created_type');define('ORD_PMNT_PAID_TYPE','ord_pmnt_paid_type');define('ORD_PMNT_ISPAYBYCASH','ord_pmnt_ispaybycash');define('ORD_PMNT_START_DATE', 'ord_pmnt_start_date'); define('ORD_PMNT_END_DATE', 'ord_pmnt_end_date'); define("TBL_ORDER_PAYMENT_ACTIVE_DATE",  ORD_PMNT_START_DATE);define("TBL_ORDER_PAYMENT_DEACTIVE_DATE",  ORD_PMNT_END_DATE);$tbl_order_payment_active_condition= " (".TBL_ORDER_PAYMENT_DEACTIVE_DATE." is NULL OR ".TBL_ORDER_PAYMENT_DEACTIVE_DATE." = 0 OR ".TBL_ORDER_PAYMENT_DEACTIVE_DATE." > CURDATE( )) ";define('PMNT_OPT_INDIVIDIUAL','INDIVIDUAL'); define('PMNT_OPT_SINGLE','SINGLE'); define('PMNT_OPT_SPLIT','SPLIT'); class tbl_order_payment {	private $ord_pmnt_id;	private $ord_pmnt_table_sess;	private $ord_pmnt_order;	private $ord_pmnt_bill_amnt;	private $ord_pmnt_created_by;	private $ord_pmnt_option;	private $ord_pmnt_split_amng;	private $ord_pmnt_paid_by;	private $ord_pmnt_amnt_paid;	private $ord_pmnt_ispaybycash;	private $ord_pmnt_start_date;	private $ord_pmnt_end_date;	private $ord_pmnt_created_type;	private $ord_pmnt_paid_type;	private $tbl_order_payment_active_date;	private $tbl_order_payment_deactive_date;	public function setord_pmnt_id($pArg="0") {$this->ord_pmnt_id=$pArg;}	public function setord_pmnt_table_sess($pArg="0") {$this->ord_pmnt_table_sess=$pArg;}	public function setord_pmnt_order($pArg="0") {$this->ord_pmnt_order=$pArg;}	public function setord_pmnt_bill_amnt($pArg="0") {$this->ord_pmnt_bill_amnt=$pArg;}	public function setord_pmnt_created_by($pArg="0") {$this->ord_pmnt_created_by=$pArg;}	public function setord_pmnt_option($pArg="0") {$this->ord_pmnt_option=$pArg;}	public function setord_pmnt_split_amng($pArg="0") {$this->ord_pmnt_split_amng=$pArg;}	public function setord_pmnt_ispaybycash($pArg="0") {$this->ord_pmnt_ispaybycash=$pArg;}		public function setord_pmnt_paid_by($pArg="0") {$this->ord_pmnt_paid_by=$pArg;}	public function setord_pmnt_amnt_paid($pArg="0") {$this->ord_pmnt_amnt_paid=$pArg;}	public function setord_pmnt_created_type($pArg="0") {$this->ord_pmnt_created_type=$pArg;}	public function setord_pmnt_paid_type($pArg="0") {$this->ord_pmnt_paid_type=$pArg;}	public function setord_pmnt_start_date($pArg="0") {$this->ord_pmnt_start_date=$pArg;}	public function setord_pmnt_end_date($pArg="0") {$this->ord_pmnt_end_date=$pArg;}	public function settbl_order_payment_active_date($pArg="0") {$this->tbl_order_payment_active_date=$pArg;}	public function settbl_order_payment_deactive_date($pArg="0") {$this->tbl_order_payment_deactive_date=$pArg;}	public function getord_pmnt_id() {return $this->ord_pmnt_id;}	public function getord_pmnt_table_sess() {return $this->ord_pmnt_table_sess;}	public function getord_pmnt_order() {return $this->ord_pmnt_order;}	public function getord_pmnt_bill_amnt() {return $this->ord_pmnt_bill_amnt;}	public function getord_pmnt_created_by() {return $this->ord_pmnt_created_by;}	public function getord_pmnt_option() {return $this->ord_pmnt_option;}	public function getord_pmnt_split_amng() {return $this->ord_pmnt_split_amng;}	public function getord_pmnt_ispaybycash() {return $this->ord_pmnt_ispaybycash;}	public function getord_pmnt_paid_by() {return $this->ord_pmnt_paid_by;}	public function getord_pmnt_amnt_paid() {return $this->ord_pmnt_amnt_paid;}	public function getord_pmnt_created_type() {return $this->ord_pmnt_created_type;}	public function getord_pmnt_paid_type() {return $this->ord_pmnt_paid_type;}	public function getord_pmnt_start_date() {return $this->ord_pmnt_start_date;}	public function getord_pmnt_end_date() {return $this->ord_pmnt_end_date;}	public function gettbl_order_payment_active_date($pArg="0") {return $this->tbl_order_payment_active_date;}	public function gettbl_order_payment_deactive_date($pArg="0") {return $this->tbl_order_payment_deactive_date;}	public function readObject($array = array()) {		$qry = "SELECT *".RET."FROM ".TBL_ORDER_PAYMENT.RET;		$and = "WHERE".RET;		if($array[ORD_PMNT_ID] != "") {			$qry .= $and.ORD_PMNT_ID." = '".$array[ORD_PMNT_ID]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_TABLE_SESS] != "") {			$qry .= $and.ORD_PMNT_TABLE_SESS." = '".$array[ORD_PMNT_TABLE_SESS]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_ORDER] != "") {			$qry .= $and.ORD_PMNT_ORDER." = '".$array[ORD_PMNT_ORDER]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_BILL_AMNT] != "") {			$qry .= $and.ORD_PMNT_BILL_AMNT." = '".$array[ORD_PMNT_BILL_AMNT]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_CREATED_BY] != "") {			$qry .= $and.ORD_PMNT_CREATED_BY." = '".$array[ORD_PMNT_CREATED_BY]."'".RET;			$and = "AND".RET;		}				if($array[ORD_PMNT_ISPAYBYCASH] != "") {			$qry .= $and.ORD_PMNT_ISPAYBYCASH." = '".$array[ORD_PMNT_ISPAYBYCASH]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_OPTION] != "") {			$qry .= $and.ORD_PMNT_OPTION." = '".$array[ORD_PMNT_OPTION]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_SPLIT_AMNG] != "") {			$qry .= $and.ORD_PMNT_SPLIT_AMNG." = '".$array[ORD_PMNT_SPLIT_AMNG]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_PAID_BY] != "") {			$qry .= $and.ORD_PMNT_PAID_BY." = '".$array[ORD_PMNT_PAID_BY]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_AMNT_PAID] != "") {			$qry .= $and.ORD_PMNT_AMNT_PAID." = '".$array[ORD_PMNT_AMNT_PAID]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_START_DATE] != "") {			$qry .= $and.ORD_PMNT_START_DATE." = '".$array[ORD_PMNT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_END_DATE] != "") {			$qry .= $and.ORD_PMNT_END_DATE." = '".$array[ORD_PMNT_END_DATE]."'".RET;			$and = "AND".RET;		}	$result = mysql_query($qry);		if($result) {			while ($row = mysql_fetch_array($result)) {				$record = $row;				break;//end after first record			}			if(count($record[0]) == 0) {				return array();			} else {				$this->setord_pmnt_id($record[ORD_PMNT_ID]);				$this->setord_pmnt_table_sess($record[ORD_PMNT_TABLE_SESS]);				$this->setord_pmnt_order($record[ORD_PMNT_ORDER]);				$this->setord_pmnt_bill_amnt($record[ORD_PMNT_BILL_AMNT]);				$this->setord_pmnt_created_by($record[ORD_PMNT_CREATED_BY]);				$this->setord_pmnt_option($record[ORD_PMNT_OPTION]);				$this->setord_pmnt_split_amng($record[ORD_PMNT_SPLIT_AMNG]);				$this->setord_pmnt_paid_by($record[ORD_PMNT_PAID_BY]);				$this->setord_pmnt_amnt_paid($record[ORD_PMNT_AMNT_PAID]);				$this->setord_pmnt_created_type($record[ORD_PMNT_CREATED_TYPE]);				$this->setord_pmnt_ispaybycash($record[ORD_PMNT_ISPAYBYCASH]);				$this->setord_pmnt_paid_type($record[ORD_PMNT_PAID_TYPE]);				$this->setord_pmnt_start_date($record[ORD_PMNT_START_DATE]);				$this->setord_pmnt_end_date($record[ORD_PMNT_END_DATE]);				$this->settbl_order_payment_active_date($record[TBL_ORDER_PAYMENT_ACTIVE_DATE]);				$this->settbl_order_payment_deactive_date($record[TBL_ORDER_PAYMENT_DEACTIVE_DATE]);				return true;			}		}	}	public static function readArray($array = array(),&$result_found=0,$isArray=1) {				global $tbl_order_payment_active_condition;		$qry = "SELECT *".RET."FROM ".TBL_ORDER_PAYMENT.RET;		$and = "WHERE".RET;		if($array[ORD_PMNT_ID] != "") {			$qry .= $and.ORD_PMNT_ID." = '".$array[ORD_PMNT_ID]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_TABLE_SESS] != "") {			$qry .= $and.ORD_PMNT_TABLE_SESS." = '".$array[ORD_PMNT_TABLE_SESS]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_ORDER] != "") {			//$qry .= $and.ORD_PMNT_ORDER." = '".$array[ORD_PMNT_ORDER]."'".RET;			$qry .= $and." FIND_IN_SET('".$array[ORD_PMNT_ORDER]."',".ORD_PMNT_ORDER.") ".RET;						$and = "AND".RET;		}		if($array[ORD_PMNT_BILL_AMNT] != "") {			$qry .= $and.ORD_PMNT_BILL_AMNT." = '".$array[ORD_PMNT_BILL_AMNT]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_CREATED_BY] != "") {			$qry .= $and.ORD_PMNT_CREATED_BY." = '".$array[ORD_PMNT_CREATED_BY]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_OPTION] != "") {			$qry .= $and.ORD_PMNT_OPTION." = '".$array[ORD_PMNT_OPTION]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_SPLIT_AMNG] != "") {			$qry .= $and.ORD_PMNT_SPLIT_AMNG." = '".$array[ORD_PMNT_SPLIT_AMNG]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_PAID_BY] != "") {			$qry .= $and.ORD_PMNT_PAID_BY." = '".$array[ORD_PMNT_PAID_BY]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_AMNT_PAID] != "") {			$qry .= $and.ORD_PMNT_AMNT_PAID." = '".$array[ORD_PMNT_AMNT_PAID]."'".RET;			$and = "AND".RET;		}				if($array[ORD_PMNT_ISPAYBYCASH] != "") {			$qry .= $and.ORD_PMNT_ISPAYBYCASH." = '".$array[ORD_PMNT_ISPAYBYCASH]."'".RET;			$and = "AND".RET;		} 		if($array[ORD_PMNT_START_DATE] != "") {			$qry .= $and.ORD_PMNT_START_DATE." = '".$array[ORD_PMNT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_END_DATE] != "") {			$qry .= $and.ORD_PMNT_END_DATE." = '".$array[ORD_PMNT_END_DATE]."'".RET;			$and = "AND".RET;		}		if(is_gt_zero_num($array["isActive"])) {			$qry .= $and.$tbl_order_payment_active_condition;;			$and = "AND".RET;		}		if(is_not_empty($array[SORT_ON]) && is_not_empty($array[SORT_BY])) {		$qry .=" ORDER BY ".$array[SORT_ON]." ".$array[SORT_BY];		}		if(is_not_empty($array[OFFSET_TITLE]) && is_not_empty($array[LIMIT_TITLE])) {			$qry_with_limit  = $qry." LIMIT ".$array[OFFSET_TITLE].",".$array[LIMIT_TITLE];		}else{			$qry_with_limit  = $qry;		}		//echo $qry_with_limit;		$result = mysql_query ($qry_with_limit);		$r1 = mysql_query($qry);		if($r1){			$result_found = mysql_num_rows($r1);		}		$class_objects = array();		if($result) {			while ($record = mysql_fetch_assoc($result)) {				$isActive= 0;				//..check deactive date is not set or 0				if((is_not_empty($record[TBL_ORDER_PAYMENT_DEACTIVE_DATE])==false) || (is_gt_zero_num(strtotime($record[TBL_ORDER_PAYMENT_DEACTIVE_DATE]))== false)){					$isActive = 1; 				}else{					//..check the deactive date is greater than todays date					if(strtotime($record[TBL_ORDER_PAYMENT_DEACTIVE_DATE]) > strtotime(date(DATE_FORMAT))){						$isActive = 1;					}				}				if($isArray){					$class_object = array();					$class_object["ord_pmnt_id"]=$record[ORD_PMNT_ID];					$class_object["ord_pmnt_table_sess"]=$record[ORD_PMNT_TABLE_SESS];					$class_object["ord_pmnt_order"]=$record[ORD_PMNT_ORDER];					$class_object["ord_pmnt_bill_amnt"]=$record[ORD_PMNT_BILL_AMNT];					$class_object["ord_pmnt_created_by"]=$record[ORD_PMNT_CREATED_BY];					$class_object["ord_pmnt_option"]=$record[ORD_PMNT_OPTION];					$class_object["ord_pmnt_split_amng"]=$record[ORD_PMNT_SPLIT_AMNG];					$class_object["ord_pmnt_paid_by"]=$record[ORD_PMNT_PAID_BY];					$class_object['ord_pmnt_created_type']=$record[ORD_PMNT_CREATED_TYPE];				$class_object['ord_pmnt_paid_type']=$record[ORD_PMNT_PAID_TYPE];					$class_object["ord_pmnt_amnt_paid"]=$record[ORD_PMNT_AMNT_PAID];					$class_object["ord_pmnt_start_date"]=$record[ORD_PMNT_START_DATE];					$class_object["ord_pmnt_end_date"]=$record[ORD_PMNT_END_DATE];					$class_object[ORD_PMNT_ISPAYBYCASH] = $record[ORD_PMNT_ISPAYBYCASH];					$class_object["isActive"]=$isActive;				}else{					$class_object = new tbl_order_payment();					$class_object->setord_pmnt_id($record[ORD_PMNT_ID]);					$class_object->setord_pmnt_table_sess($record[ORD_PMNT_TABLE_SESS]);					$class_object->setord_pmnt_order($record[ORD_PMNT_ORDER]);					$class_object->setord_pmnt_bill_amnt($record[ORD_PMNT_BILL_AMNT]);					$class_object->setord_pmnt_created_by($record[ORD_PMNT_CREATED_BY]);					$class_object->setord_pmnt_option($record[ORD_PMNT_OPTION]);					$class_object->setord_pmnt_split_amng($record[ORD_PMNT_SPLIT_AMNG]);					$class_object->setord_pmnt_paid_by($record[ORD_PMNT_PAID_BY]);					$class_object->setord_pmnt_amnt_paid($record[ORD_PMNT_AMNT_PAID]);					$class_object->setord_pmnt_created_type($record[ORD_PMNT_CREATED_TYPE]);					$class_object->setord_pmnt_paid_type($record[ORD_PMNT_PAID_TYPE]);					$class_object->setord_pmnt_ispaybycash($record[ORD_PMNT_ISPAYBYCASH]);					$class_object->setord_pmnt_start_date($record[ORD_PMNT_START_DATE]);					$class_object->setord_pmnt_end_date($record[ORD_PMNT_END_DATE]);				}				$class_objects[$record[ORD_PMNT_ID]] = $class_object;			}		}		return $class_objects;	}//..End readArray	public function insert() {		if($this->getord_pmnt_id() != '') {			$qry  = "UPDATE ".TBL_ORDER_PAYMENT.RET."SET".RET."			".ORD_PMNT_ID." = '".$this->getord_pmnt_id()."',".RET."			".ORD_PMNT_TABLE_SESS." = '".$this->getord_pmnt_table_sess()."',".RET."			".ORD_PMNT_ORDER." = '".$this->getord_pmnt_order()."',".RET."			".ORD_PMNT_BILL_AMNT." = '".$this->getord_pmnt_bill_amnt()."',".RET."			".ORD_PMNT_CREATED_BY." = '".$this->getord_pmnt_created_by()."',".RET."			".ORD_PMNT_OPTION." = '".$this->getord_pmnt_option()."',".RET."			".ORD_PMNT_SPLIT_AMNG." = '".$this->getord_pmnt_split_amng()."',".RET."			".ORD_PMNT_PAID_BY." = '".$this->getord_pmnt_paid_by()."',".RET."			".ORD_PMNT_AMNT_PAID." = '".$this->getord_pmnt_amnt_paid()."',".RET."			".ORD_PMNT_CREATED_TYPE." = '".$this->getord_pmnt_created_type()."',".RET."			".ORD_PMNT_PAID_TYPE." = '".$this->getord_pmnt_paid_type()."',".RET."			".ORD_PMNT_ISPAYBYCASH." = '".$this->getord_pmnt_ispaybycash()."',".RET."			".ORD_PMNT_START_DATE." = '".$this->getord_pmnt_start_date()."',".RET."			".ORD_PMNT_END_DATE." = '".$this->getord_pmnt_end_date()."'".RET.			"WHERE ".ORD_PMNT_ID." = ".$this->getord_pmnt_id().RET;			mysql_query($qry);		} else {			$qry  = "INSERT INTO ".TBL_ORDER_PAYMENT." (".RET.			"".ORD_PMNT_TABLE_SESS.", ".ORD_PMNT_ORDER.", ".ORD_PMNT_BILL_AMNT.", ".ORD_PMNT_CREATED_BY.", ".ORD_PMNT_OPTION.", ".ORD_PMNT_SPLIT_AMNG.", ".ORD_PMNT_PAID_BY.", ".ORD_PMNT_AMNT_PAID.", ".ORD_PMNT_CREATED_TYPE.", ".ORD_PMNT_PAID_TYPE.", ".ORD_PMNT_ISPAYBYCASH.",".ORD_PMNT_START_DATE.", ".ORD_PMNT_END_DATE.RET.				") VALUES (".RET.			"'".$this->getord_pmnt_table_sess()."',".RET.			"'".$this->getord_pmnt_order()."',".RET.			"'".$this->getord_pmnt_bill_amnt()."',".RET.			"'".$this->getord_pmnt_created_by()."',".RET.			"'".$this->getord_pmnt_option()."',".RET.			"'".$this->getord_pmnt_split_amng()."',".RET.			"'".$this->getord_pmnt_paid_by()."',".RET.			"'".$this->getord_pmnt_amnt_paid()."',".RET.			"'".$this->getord_pmnt_created_type()."',".RET.			"'".$this->getord_pmnt_paid_type()."',".RET.			"'".$this->getord_pmnt_ispaybycash()."',".RET.			"'".$this->getord_pmnt_start_date()."',".RET.			"'".$this->getord_pmnt_end_date()."'".RET.			")".RET;			$res = mysql_query($qry);			$this->setord_pmnt_id(mysql_insert_id());		}	}//..End Insert	public static function delete($array = array()) {		$qry = "DELETE".RET."FROM ".TBL_ORDER_PAYMENT.RET;		$and = "WHERE".RET;		if($array[ORD_PMNT_ID] != "") {			$qry .= $and.ORD_PMNT_ID." = '".$array[ORD_PMNT_ID]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_TABLE_SESS] != "") {			$qry .= $and.ORD_PMNT_TABLE_SESS." = '".$array[ORD_PMNT_TABLE_SESS]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_ORDER] != "") {			$qry .= $and.ORD_PMNT_ORDER." = '".$array[ORD_PMNT_ORDER]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_BILL_AMNT] != "") {			$qry .= $and.ORD_PMNT_BILL_AMNT." = '".$array[ORD_PMNT_BILL_AMNT]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_CREATED_BY] != "") {			$qry .= $and.ORD_PMNT_CREATED_BY." = '".$array[ORD_PMNT_CREATED_BY]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_OPTION] != "") {			$qry .= $and.ORD_PMNT_OPTION." = '".$array[ORD_PMNT_OPTION]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_SPLIT_AMNG] != "") {			$qry .= $and.ORD_PMNT_SPLIT_AMNG." = '".$array[ORD_PMNT_SPLIT_AMNG]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_PAID_BY] != "") {			$qry .= $and.ORD_PMNT_PAID_BY." = '".$array[ORD_PMNT_PAID_BY]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_AMNT_PAID] != "") {			$qry .= $and.ORD_PMNT_AMNT_PAID." = '".$array[ORD_PMNT_AMNT_PAID]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_START_DATE] != "") {			$qry .= $and.ORD_PMNT_START_DATE." = '".$array[ORD_PMNT_START_DATE]."'".RET;			$and = "AND".RET;		}		if($array[ORD_PMNT_END_DATE] != "") {			$qry .= $and.ORD_PMNT_END_DATE." = '".$array[ORD_PMNT_END_DATE]."'".RET;			$and = "AND".RET;		}		$res = mysql_query($qry);		if($res){			return OPERATION_SUCCESS;		};		return OPERATION_FAIL;	}//..End Delete	public function isAlreadyThere($ord_pmnt_table_sess ,$ord_pmnt_order ,$ord_pmnt_bill_amnt ,$ord_pmnt_created_by ,$ord_pmnt_option ,$ord_pmnt_split_amng ,$ord_pmnt_paid_by ,$ord_pmnt_amnt_paid ,$ord_pmnt_start_date ,$ord_pmnt_end_date) {		$unique_arr = array();			//$unique_arr[ORD_PMNT_ID]=$ord_pmnt_id;			//$unique_arr[ORD_PMNT_TABLE_SESS]=$ord_pmnt_table_sess;			//$unique_arr[ORD_PMNT_ORDER]=$ord_pmnt_order;			//$unique_arr[ORD_PMNT_BILL_AMNT]=$ord_pmnt_bill_amnt;			//$unique_arr[ORD_PMNT_CREATED_BY]=$ord_pmnt_created_by;			//$unique_arr[ORD_PMNT_OPTION]=$ord_pmnt_option;			//$unique_arr[ORD_PMNT_SPLIT_AMNG]=$ord_pmnt_split_amng;			//$unique_arr[ORD_PMNT_PAID_BY]=$ord_pmnt_paid_by;			//$unique_arr[ORD_PMNT_AMNT_PAID]=$ord_pmnt_amnt_paid;			//$unique_arr[ORD_PMNT_START_DATE]=$ord_pmnt_start_date;			//$unique_arr[ORD_PMNT_END_DATE]=$ord_pmnt_end_date;		if(is_not_empty($unique_arr)){			return $this->readObject($unique_arr);		}		return false;	}//..isAlreadyThere	public function create($ord_pmnt_table_sess ,$ord_pmnt_order ,$ord_pmnt_bill_amnt ,$ord_pmnt_created_by ,$ord_pmnt_option ,$ord_pmnt_split_amng ,$ord_pmnt_paid_by ,$ord_pmnt_amnt_paid ,$ord_pmnt_start_date ,$ord_pmnt_end_date,$ord_pmnt_created_type=CUST_TYPE_LOGIN,$ord_pmnt_paid_type=CUST_TYPE_LOGIN,$ord_pmnt_ispaybycash=0) {		if(is_not_empty($ord_pmnt_table_sess)){			if($this->isAlreadyThere($ord_pmnt_table_sess ,$ord_pmnt_order ,$ord_pmnt_bill_amnt ,$ord_pmnt_created_by ,$ord_pmnt_option ,$ord_pmnt_split_amng ,$ord_pmnt_paid_by ,$ord_pmnt_amnt_paid ,$ord_pmnt_start_date ,$ord_pmnt_end_date)){				return OPERATION_DUPLICATE;			}else{				$this->setord_pmnt_id("");				$this->setord_pmnt_table_sess($ord_pmnt_table_sess);				$this->setord_pmnt_order($ord_pmnt_order);				$this->setord_pmnt_bill_amnt($ord_pmnt_bill_amnt);				$this->setord_pmnt_created_by($ord_pmnt_created_by);				$this->setord_pmnt_option($ord_pmnt_option);				$this->setord_pmnt_split_amng($ord_pmnt_split_amng);				$this->setord_pmnt_paid_by($ord_pmnt_paid_by);				$this->setord_pmnt_amnt_paid($ord_pmnt_amnt_paid);				$this->setord_pmnt_created_type($ord_pmnt_created_type);				$this->setord_pmnt_paid_type($ord_pmnt_paid_type);				$this->setord_pmnt_ispaybycash($ord_pmnt_ispaybycash);				$this->setord_pmnt_start_date(date(DATE_FORMAT));				$this->insert();								return $this->getord_pmnt_id();			}		}		return OPERATION_FAIL;	}//..create	public function update($ord_pmnt_id, $ord_pmnt_table_sess, $ord_pmnt_order, $ord_pmnt_bill_amnt, $ord_pmnt_created_by, $ord_pmnt_option, $ord_pmnt_split_amng, $ord_pmnt_paid_by, $ord_pmnt_amnt_paid, $ord_pmnt_start_date, $ord_pmnt_end_date) {		if(is_gt_zero_num($ord_pmnt_id)){			if ($this->readObject(array(ORD_PMNT_ID=>$ord_pmnt_id))){				$this->setord_pmnt_table_sess($ord_pmnt_table_sess);				$this->setord_pmnt_order($ord_pmnt_order);				$this->setord_pmnt_bill_amnt($ord_pmnt_bill_amnt);				$this->setord_pmnt_created_by($ord_pmnt_created_by);				$this->setord_pmnt_option($ord_pmnt_option);				$this->setord_pmnt_split_amng($ord_pmnt_split_amng);				$this->setord_pmnt_paid_by($ord_pmnt_paid_by);				$this->setord_pmnt_amnt_paid($ord_pmnt_amnt_paid);				$this->insert();				return OPERATION_SUCCESS;			}		}		return OPERATION_FAIL;	}//..update	public function activate($ord_pmnt_id){		if(is_gt_zero_num($ord_pmnt_id)){			if ($this->readObject(array(ORD_PMNT_ID=>$ord_pmnt_id))){				$qry  = "UPDATE ".TBL_ORDER_PAYMENT.RET."SET".RET."			".TBL_ORDER_PAYMENT_DEACTIVE_DATE." = '".date(EMPTY_DATE_FORMAT)."' WHERE ".ORD_PMNT_ID."={$ord_pmnt_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end activate	public function deactivate($ord_pmnt_id){		if(is_gt_zero_num($ord_pmnt_id)){			if ($this->readObject(array(ORD_PMNT_ID=>$ord_pmnt_id))){				$qry  = "UPDATE ".TBL_ORDER_PAYMENT.RET."SET".RET."			".TBL_ORDER_PAYMENT_DEACTIVE_DATE." = '".date(DATE_FORMAT)."' WHERE ".ORD_PMNT_ID."={$ord_pmnt_id}";				$res = mysql_query($qry);				if($res){					return 1;				}			}		}		return 0;	}//..end deactivate	public static function GetInfo($ord_pmnt_id) {		$info = array();		if($ord_pmnt_id != ""){			$obj_tbl_order_payment = new tbl_order_payment();			if($obj_tbl_order_payment->readObject(array("ord_pmnt_id"=>$ord_pmnt_id))){				$info["ord_pmnt_id"]=$obj_tbl_order_payment->getord_pmnt_id();				$info["ord_pmnt_table_sess"]=$obj_tbl_order_payment->getord_pmnt_table_sess();				$info["ord_pmnt_order"]=$obj_tbl_order_payment->getord_pmnt_order();				 				$info["order_list"] = biz_explode(',',$info["ord_pmnt_order"]);								$info["ord_pmnt_bill_amnt"]=$obj_tbl_order_payment->getord_pmnt_bill_amnt();				$info["ord_pmnt_created_by"]=$obj_tbl_order_payment->getord_pmnt_created_by();				$info["ord_pmnt_option"]=$obj_tbl_order_payment->getord_pmnt_option();				$info["ord_pmnt_split_amng"]=$obj_tbl_order_payment->getord_pmnt_split_amng();				$info["ord_pmnt_paid_by"]=$obj_tbl_order_payment->getord_pmnt_paid_by();				$info["ord_pmnt_paid_type"] = $obj_tbl_order_payment->getord_pmnt_paid_type();  				$info["payer_list"] = biz_explode(',',$info["ord_pmnt_paid_by"]);				 				$info["payer_type_list"] = biz_explode(',',$info["ord_pmnt_paid_type"]);								$info["ord_pmnt_amnt_paid"]=$obj_tbl_order_payment->getord_pmnt_amnt_paid();				$info["ord_pmnt_ispaybycash"]=$obj_tbl_order_payment->getord_pmnt_ispaybycash();				$info["ord_pmnt_start_date"]=$obj_tbl_order_payment->getord_pmnt_start_date();				$info["ord_pmnt_end_date"]=$obj_tbl_order_payment->getord_pmnt_end_date();				 				$info["isActive"] = 0;				//..check deactive date is not set or 0				if((is_not_empty($obj_tbl_order_payment->gettbl_order_payment_deactive_date())==false)  || (is_gt_zero_num(strtotime($obj_tbl_order_payment->gettbl_order_payment_deactive_date()))== false)){					$info["isActive"] = 1;				}else{					//..check the deactive date is greater than todays date					if(strtotime($obj_tbl_order_payment->gettbl_order_payment_deactive_date()) > strtotime(date(DATE_FORMAT))){						$info["isActive"] = 1;					}				}			}		unset($obj_tbl_order_payment);		return $info;		}	}//..End GetInfo	public static function GetFields($data){		global $tbl_order_payment_active_condition;		$arr = array();		if(is_not_empty($data)){			$qry ="SELECT ".$data['key_field'].",".$data['value_field']." FROM ".TBL_ORDER_PAYMENT."";			if(is_gt_zero_num($data['isActive'])){				$qry .= " WHERE ".$tbl_order_payment_active_condition;			}			$res = mysql_query($qry); 			if($res){				while($row=mysql_fetch_assoc($res)){					$arr[$row[$data['key_field']]] = $row[$data['value_field']];				}			}		}		return $arr;	}//.. End of GetFields			/**	* append the order payment with payer,amount and order 	* @param int $ord_pmt_id 			-- Order Payment Id	* @param int $payer_id 				-- customer id 	* @param float $amt					-- Amount paid	* @param int tbl_cust_sess_id		-- table session id	* @param int $order_id (Optional)	-- order id if 'individual' payment	* @param string $payer_type (Optional)	* return boolean 	* 	*/	public function updateOrderPayment($ord_pmt_id, $payer_id,$amt, $tbl_cust_sess_id, $order_id=0,$payer_type=CUST_LOGIN_TYPE,$ord_rest=0,$ord_pmnt_split_pay_for=1){		global $Global_member; 		$isSuccess = 0;		 if(is_gt_zero_num($ord_pmt_id) && is_gt_zero_num($payer_id) &&  is_numeric($amt) && is_gt_zero_num($tbl_cust_sess_id)){	 		 	 if($this->readObject(array(ORD_PMNT_ID=>$ord_pmt_id))){		 	$info =  self::GetInfo($ord_pmt_id);					 	//..check whether payment bill amt is greater thant paid amt	$alrdy_paid_mem=0;	if(is_not_empty($info[ORD_PMNT_PAID_BY])){			$lst_paid_by=explode(',',$info[ORD_PMNT_PAID_BY]); 			if(is_array($lst_paid_by)){					$alrdy_paid_mem=count($lst_paid_by);			}	}		if($info[ORD_PMNT_SPLIT_AMNG]>$alrdy_paid_mem){	//if($info[ORD_PMNT_BILL_AMNT] > $info[ORD_PMNT_AMNT_PAID]){ 					$payers =  $info['payer_list'];					$payer_types = $info['payer_type_list'];					$can_pay = 1; //flag for payer can pay																			if(is_not_empty($payers)){						//..if payers is in the list						if(($Global_member['member_role_id']==ROLE_MANAGER || $Global_member['member_role_id']==ROLE_WAITER)){							if($ord_pmnt_split_pay_for>1){									for($i=0;$i<$ord_pmnt_split_pay_for;$i++){										array_push($payers,$payer_id);									}							}							  						}else{							if(in_array($payer_id,$payers)){								$can_pay = 0;							}else{								array_push($payers,$payer_id); 							}						}											}else{						$payers = array();						$payers[0]= $payer_id;					}											foreach($payers as $key=>$val){					  if($val == $payer_id){							$payer_types[$key] = $payer_type;						}else{							$payer_types[$key] = if_null($payer_types[$key],CUST_TYPE_LOGIN);						}					} 		 			//..add the amount in bill				 	if(is_gt_zero_num($can_pay)){						 //$ord_amt =  $info[ORD_PMNT_AMNT_PAID] + $amt;						 //..If this is last payment then 						 if($ord_pmnt_split_pay_for>1){						 			$amt=($amt*$ord_pmnt_split_pay_for);						 }						 $payment_step=($info[ORD_PMNT_SPLIT_AMNG]-$alrdy_paid_mem);						 if($payment_step==1){						 		$ord_amt = $info[ORD_PMNT_BILL_AMNT];						 }else{						 		$ord_amt =  $info[ORD_PMNT_AMNT_PAID] + $amt; 						 }													 $this->setord_pmnt_amnt_paid($ord_amt);		 						 						 $this->setord_pmnt_paid_by(biz_implode(',',$payers));						 $this->setord_pmnt_paid_type(biz_implode(',',$payer_types));						 if($info[ORD_PMNT_OPTION] == PMNT_OPT_INDIVIDIUAL){						 	if(is_gt_zero_num($order_id)){								$orders = $info['order_list'];								array_push($orders,$order_id); 						 		$this->setord_pmnt_order(biz_implode(',',$orders));							}						 							 } 						 $this->insert();						 $isSuccess = 1;  	 					}					 //..if opertaion is success full					if($isSuccess == 1){					 	//..for individual update the order status to check					 	if($info[ORD_PMNT_OPTION] == PMNT_OPT_INDIVIDIUAL){							if(is_gt_zero_num($order_id)){ 								$obj_order = new tbl_orders();								$obj_order->update_ord_sts($order_id,TBL_STATUS_CHECK);								unset($obj_order);							} 						} 						//..if order amount is equal to bill ammount then 						//update the all tbl session order check paid					 	//if( $info[ORD_PMNT_BILL_AMNT] == $ord_amt){						//incase the paid amnt is greater than or equal to order_amount						if($info[ORD_PMNT_BILL_AMNT] <= $ord_amt){					 		$isSuccess = tbl_orders::updateAllTblSessOrdChkPaid($tbl_cust_sess_id,$ord_rest);							if(is_gt_zero_num($order_id)){								//..change table status to check paid										 	$tbl_ordersinfo= tbl_orders::GetInfo($order_id);								$objtbl_table_status_link=new tbl_table_status_link();								$isSuccess = $objtbl_table_status_link->create($tbl_ordersinfo['order_table_id'], $tbl_ordersinfo['order_customer_name'], TBL_STATUS_CHECK, $tbl_ordersinfo['order_emp_id'],$tbl_cust_sess_id, date(DATE_FORMAT), NULL);				if($isSuccess){			/*	biz_send_alert($tbl_ordersinfo['order_table_id'],$tbl_ordersinfo['order_customer_name'],$order_id,$_lang[TBL_ALERTS]['manager'][ALERT_CHK_OUT],ALERT_FOR_MANGER,ALERT_ORDER);				//..alert to server 				biz_send_alert($tbl_ordersinfo['order_table_id'],$tbl_ordersinfo['order_customer_name'],$order_id,$_lang[TBL_ALERTS]['manager'][ALERT_CHK_OUT],$tbl_ordersinfo['order_emp_id'],ALERT_ORDER); */				//..Notifications based on teh statuses @26 Oct 2013 					biz_send_status_notifications($tbl_ordersinfo['order_table_id'],$tbl_ordersinfo['order_customer_name'],$order_id,STS_ORDER_CHECK_PAID,$tbl_ordersinfo['order_emp_id'],$tbl_ordersinfo['order_customer_id'],$tbl_ordersinfo['order_customer_type']);			}									 								unset($tbl_ordersinfo);									unset($objtbl_table_status_link);								}					 	}											}  			}		} 	 }		   return $isSuccess; 	}//..updateOrderPayment	 }//..End tbl_order_payment?>