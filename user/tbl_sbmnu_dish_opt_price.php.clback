<?phpinclude_once(dirname(dirname(__FILE__))."/init.php");include_once("header.php");$active_page = "tbl_sbmnu_dish_opt_price";$sbmdopt_pr_id= get_input("sbmdopt_pr_id");$sbmdopt_pr_sbmnu_dish= get_input("sbmdopt_pr_sbmnu_dish",$_SESSION[SES_SUB_MENU_DISH]);$sbmdopt_pr_option_value= get_input("sbmdopt_pr_option_value");$sbmdopt_pr_price= get_input("sbmdopt_pr_price");$action = strtoupper(get_input(ACTION_TITLE));$mode = strtoupper(get_input(MODE_TITLE));$offset = get_input(OFFSET_TITLE,OFFSET_VALUE);$limit =  get_input(LIMIT_TITLE,LIMIT_VALUE);$sort_on = get_input(SORT_ON,"sbmdopt_pr_id");$sort_by=$new_sort="";biz_set_sorting_var($sort_by,$new_sort);$url = "{$website}/user/tbl_sbmnu_dish_opt_price.php";$navigationURL = $url."?".SORT_ON."={$sort_on}&".SORT_BY."={$sort_by}";$isSuccess = ""; if(($sesslife==true) && (is_gt_zero_num($sbmdopt_pr_sbmnu_dish))){$_SESSION[SES_SUB_MENU_DISH] = $sbmdopt_pr_sbmnu_dish;/* print_r($currSubMenuDish['optionsPrice'] );print_r($currDishAllOptionValues);*/$objtbl_sbmnu_dish_opt_price= new tbl_sbmnu_dish_opt_price(); if(is_not_empty($action)){	switch($action){		case ACTION_CREATE: 			$isSuccess = $objtbl_sbmnu_dish_opt_price->create($sbmdopt_pr_sbmnu_dish, $sbmdopt_pr_option_value, $sbmdopt_pr_price);			break;		case ACTION_UPDATE: 			$isSuccess = $objtbl_sbmnu_dish_opt_price->update($sbmdopt_pr_id, $sbmdopt_pr_sbmnu_dish, $sbmdopt_pr_option_value, $sbmdopt_pr_price);			break;		case ACTION_DELETE: 			$isSuccess = $objtbl_sbmnu_dish_opt_price->delete(array(SBMDOPT_PR_ID=>$sbmdopt_pr_id));			break;		case ACTION_ACTIVATE: 			$isSuccess = $objtbl_sbmnu_dish_opt_price->activate($sbmdopt_pr_id);			break;		case ACTION_DEACTIVATE: 			$isSuccess = $objtbl_sbmnu_dish_opt_price->deactivate($sbmdopt_pr_id);			break;	}//..switch}//..ifif(is_not_empty($isSuccess)){  	if(is_gt_zero_num($isSuccess)){		$_SESSION[SES_FLASH_MSG] = "<div class='success'>".$_lang['tbl_sbmnu_dish_opt_price'][$action]['SUCCESS_MSG']."</div>";	}elseif($isSuccess == OPERATION_FAIL){		$_SESSION[SES_FLASH_MSG] ="<div class='error'>".$_lang['tbl_sbmnu_dish_opt_price'][$action]['FAILURE_MSG']."</div>";	}elseif($isSuccess == OPERATION_DUPLICATE){		$_SESSION[SES_FLASH_MSG] = "<div class='info'>".$_lang['tbl_sbmnu_dish_opt_price'][$action]['DUPLICATE_MSG']."</div>";	}    if(is_gt_zero_num($_REQUEST['sbmnu_dish_submenu'])){ 	biz_script_forward($website.'/user/tbl_submenu_dishes.php?sbmnu_dish_id='.$sbmdopt_pr_sbmnu_dish.'&sbmnu_dish_submenu='.$_REQUEST['sbmnu_dish_submenu'].'&'.MODE_TITLE.'='.MODE_UPDATE);	}//..if 		$currSubMenuDish =   tbl_submenu_dishes::GetInfo($sbmdopt_pr_sbmnu_dish);  	$currSubMenuDish['optionsPrice'] = tbl_sbmnu_dish_opt_price::getAllOptionValuePricesForDish($sbmdopt_pr_sbmnu_dish,$currSubMenuDish[SBMNU_DISH_DISH]);  		/*var_dump($currSubMenuDish);*/	$result_found=0;	$tbl_sbmnu_dish_opt_pricelist = $objtbl_sbmnu_dish_opt_price->readArray(array(OFFSET_TITLE=>$offset,LIMIT_TITLE=>$limit,SORT_BY=>$sort_by,SORT_ON=>$sort_on),$result_found,1);	$allpageCount = 0;	$currentPage = 0;	$smarty->assign('pagination',biz_pagination(array("url"=>$navigationURL,LIMIT_TITLE=>$limit,OFFSET_TITLE=>$offset,"count"=>$result_found),$allpageCount,$currentPage));	$smarty->assign('allpageCount',$allpageCount);	$smarty->assign('currentPage',$currentPage);	$smarty->assign('tbl_sbmnu_dish_opt_pricelist', $tbl_sbmnu_dish_opt_pricelist);	$smarty->assign('result_found',$result_found);	$smarty->assign('currSubMenuDish',$currSubMenuDish);	$template = "tbl_sbmnu_dish_opt_price/tbl_sbmnu_dish_opt_price.tpl";	if (is_not_empty($mode)){		if(($mode == MODE_VIEW || $mode==MODE_UPDATE) && is_gt_zero_num($sbmdopt_pr_id)){			$tbl_sbmnu_dish_opt_priceinfo= $objtbl_sbmnu_dish_opt_price->GetInfo($sbmdopt_pr_id);			$smarty->assign('tbl_sbmnu_dish_opt_priceinfo',$tbl_sbmnu_dish_opt_priceinfo);			if($mode==MODE_UPDATE){				$smarty->assign("isUpdate",1);			}			$template = "tbl_sbmnu_dish_opt_price/view.tpl";		}elseif($mode == MODE_CREATE){			$template = "tbl_sbmnu_dish_opt_price/create.tpl";					}}	$smarty->assign('page_url', $url);	$smarty->assign('navigationURL',$navigationURL);	$smarty->assign('new_sort',$new_sort);	$smarty->assign('active_page',$active_page); }else{	$template="index.tpl";} include_once("footer.php");?>