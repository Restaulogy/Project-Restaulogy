<?phpinclude_once(dirname(dirname(__FILE__)).'/init.php');include_once('header.php');$active_page = 'tbl_dish_options_values';$dish_opt_val_id= get_sql_input('dish_opt_val_id');$dish_opt_val_option_id= get_sql_input('dish_opt_val_option_id', $_SESSION[SES_DISH_OPTION]);$dish_opt_val_value= get_sql_input('dish_opt_val_value');$dish_opt_val_ethor_variant= get_sql_input('dish_opt_val_ethor_variant');$action = strtoupper(get_input(ACTION_TITLE));$mode = strtoupper(get_input(MODE_TITLE));$offset = get_sql_input(OFFSET_TITLE,OFFSET_VALUE);$limit =  get_sql_input(LIMIT_TITLE,LIMIT_VALUE);$is_from_option = get_sql_input('is_from_option',0);$sort_on = get_sql_input(SORT_ON,'dish_opt_val_id');$sort_by=$new_sort='';biz_set_sorting_var($sort_by,$new_sort);$url = $website.'/user/tbl_dish_options_values.php';$navigationURL = $url.'?'.SORT_ON.'='.$sort_on.'&'.SORT_BY.'='.$sort_by;$isSuccess = '';$sel_dish_options_values=get_input("sel_dish_options_values");$lst_sel_ids='';if(is_not_empty($sel_dish_options_values)){		$lst_sel_ids=implode(',', array_keys($sel_dish_options_values));} if($sesslife==true && is_gt_zero_num($dish_opt_val_option_id)){$_SESSION[SES_DISH_OPTION] =   $dish_opt_val_option_id;$currDishOption = tbl_dish_options::GetInfo($dish_opt_val_option_id);$objtbl_dish_options_values= new tbl_dish_options_values();if(is_not_empty($action)){  	switch($action){		case ACTION_CREATE: 			$isSuccess = $objtbl_dish_options_values->create($dish_opt_val_option_id, $dish_opt_val_value,$dish_opt_val_ethor_variant);			break;		case ACTION_UPDATE: 			$isSuccess = $objtbl_dish_options_values->update($dish_opt_val_id, $dish_opt_val_option_id, $dish_opt_val_value,$dish_opt_val_ethor_variant);			break;					case ACTION_DELETE: 						if(is_not_empty($lst_sel_ids)){					//$isSuccess = $objtbl_dish_options_values->delete(array(DISH_OPT_VAL_ID=>$lst_sel_ids));					$isSuccess = $objtbl_dish_options_values->remove(array(DISH_OPT_VAL_ID=>$lst_sel_ids));			}else{				$isSuccess = OPERATION_FAIL;			} 			break;			//$isSuccess = $objtbl_dish_options_values->delete(array(DISH_OPT_VAL_ID=>$dish_opt_val_id));					case ACTION_ACTIVATE: 			$isSuccess = $objtbl_dish_options_values->activate($dish_opt_val_id);			break;		case ACTION_DEACTIVATE: 			$isSuccess = $objtbl_dish_options_values->deactivate($dish_opt_val_id);			break;	}//..switch}//..if  if(is_not_empty($isSuccess)){	if(is_gt_zero_num($isSuccess)){		$_SESSION[SES_FLASH_MSG] .= '<div class="success">'.$_lang['tbl_dish_options_values'][$action]['SUCCESS_MSG'].'</div>';	}elseif($isSuccess == OPERATION_FAIL){		$_SESSION[SES_FLASH_MSG] .= '<div class="error">'.$_lang['tbl_dish_options_values'][$action]['FAILURE_MSG'].'</div>';	}elseif($isSuccess == OPERATION_DUPLICATE){		$_SESSION[SES_FLASH_MSG] .= '<div class="info">'.$_lang['tbl_dish_options_values'][$action]['DUPLICATE_MSG'].'</div>';	}}//..if  	if(is_gt_zero_num($is_from_option) && is_gt_zero_num($dish_opt_val_option_id)){		biz_script_forward($website.'/user/tbl_dish_options.php?mode=UPDATE&dish_opt_id='.$dish_opt_val_option_id);	}	$result_found=0;	$tbl_dish_options_valueslist = $objtbl_dish_options_values->readArray(array(DISH_OPT_VAL_OPTION_ID=>$dish_opt_val_option_id,OFFSET_TITLE=>$offset,LIMIT_TITLE=>$limit,SORT_BY=>$sort_by,SORT_ON=>$sort_on),$result_found,1);	$allpageCount = 0;	$currentPage = 0;	$smarty->assign('pagination',biz_pagination(array('url'=>$navigationURL,LIMIT_TITLE=>$limit,OFFSET_TITLE=>$offset,'count'=>$result_found),$allpageCount,$currentPage));	$smarty->assign('allpageCount',$allpageCount);	$smarty->assign('currentPage',$currentPage);	$smarty->assign('tbl_dish_options_valueslist', $tbl_dish_options_valueslist);	$smarty->assign('result_found',$result_found);	$template = 'tbl_dish_options_values/tbl_dish_options_values.tpl';	if (is_not_empty($mode)){		if(($mode == MODE_VIEW || $mode==MODE_UPDATE) && is_gt_zero_num($dish_opt_val_id)){			$tbl_dish_options_valuesinfo= $objtbl_dish_options_values->GetInfo($dish_opt_val_id);			if($tbl_dish_options_valuesinfo[DISH_OPT_VAL_OPTION_ID] == $dish_opt_val_option_id){				$tbl_dish_options_valuesinfo['option_detail'] = $currDishOption;			}else{				$tbl_dish_options_valuesinfo['option_detail'] = tbl_dish_options::GetInfo($tbl_dish_options_valuesinfo[DISH_OPT_VAL_OPTION_ID]);				 			}						$smarty->assign('tbl_dish_options_valuesinfo',$tbl_dish_options_valuesinfo);			if($mode==MODE_UPDATE){				$smarty->assign('isUpdate',1);			}			$template = 'tbl_dish_options_values/view.tpl';		}elseif($mode == MODE_CREATE){			$template = 'tbl_dish_options_values/create.tpl';		}}	$smarty->assign('page_url', $url);	$smarty->assign('navigationURL',$navigationURL);	$smarty->assign('new_sort',$new_sort);	$smarty->assign('active_page',$active_page);	$smarty->assign('currDishOption',$currDishOption);	$breadcrumbs = array( 					array(						'link'=>$website.'/user/pref_mng_cntrols.php',						'title'=>$_lang['main']['pref_mng_cntrls']),					 array(					 	'link'=>$website.'/user/tbl_dishes.php',						'title'=>$_lang['tbl_dishes']['listing_title']),					array(					 	'link'=>$website.'/user/tbl_dish_options.php',						'title'=>$_lang['tbl_dish_options']['listing_title']),					array(					 	'link'=>$url,						'title'=>$_lang['tbl_dish_options_values']['listing_title']));  }else{	$template='index.tpl';} include_once('footer.php');?>