{literal}<script type="text/javascript">function sendOrderConfirmationCode(){  var customerName ="{/literal}{$smarty.session[$smarty.const.SES_REWARD].phone}{literal}"; var isValid = true;	info = {};	info['customer_phone'] = customerName;  	info['restaurant']  = "{/literal}{$smarty.session[$smarty.const.SES_RESTAURANT]}{literal}";  	info['action']  = 'SEND';	$.ajax({             type     : "POST",        url      : "{/literal}{$website}{literal}/ajax/orderConfirmationCode.php",        data     : info,        dataType : "json",		async	 : false,        success  : function(data) {        	   								            if(data){                	            	 $('#confirmation_timestamp').val(data.timestamp);            	 $('#btnSendConfirmation,#blockCustomerPhone').hide();				 $('#btnPlaceOrder,#blockConfirmationCode,#blockConfirmationMsg').show();				             }        },        error: function( objRequest ){        	alert("Error occured" + objRequest.responseText);        }  });    } function verifyConfirmationCode(){  var confirmCode = $('#confirmation_code').val(); var am_i_cust= $('#am_i_cust').val(); var cust_rest_pin ='';  var isValid = true; if(am_i_cust == 1){ 		cust_rest_pin =$('#restaurant_pin').val(); 		if(IsNonEmpty(cust_rest_pin) == false){    		alert("Please provide Restaurant Pin.");    		isValid =false;     	} } if(Number($('#rwd_points').val())>Number($("#tmp_allowed_pts").val())){ 	alert("Maximum points which you can redeem are "+$("#tmp_allowed_pts").val());    isValid =false; }  /*if(IsNonEmpty(confirmCode) == false){    	alert("Please provide Confirmation Code.");    	isValid =false;  }*/ if(IsNonEmpty($('#rwd_points').val()) == false){    	alert("Please provide redeem points.");    	isValid =false;  }  if(isValid){		info = {};		info['customer_phone'] = "{/literal}{$smarty.session[$smarty.const.SES_REWARD].phone}{literal}";  		info['restaurant']  = "{/literal}{$smarty.session[$smarty.const.SES_RESTAURANT]}{literal}";		info['code']  = 1;//confirmCode;  		info['timestamp']  = $('#confirmation_timestamp').val();		info['cust_rest_pin']  = cust_rest_pin; 		info['action']  = 'VERIFY';		$.ajax({                 type     : "POST",            url      : "{/literal}{$website}{literal}/ajax/orderConfirmationCode.php",            data     : info,            dataType : "json",			async	 : false,            success  : function(response) {                 if(response.verified){                  	//alert('SUCCESS');                      	{/literal}{assign var="server_validated" value=1}{literal}                 	      	                   	post_to_redeem($('#mob_val_rwd_id').val(),$('#mob_val_promotion').val(),$('#rwd_points').val(),$('#rwd_invoice').val());                 }else{                	alert(response.msg);										    	                	//alert("Please provide Valid Confirmation Code.");                  }            },            error: function( objRequest ){            	alert("Error occured" + objRequest.responseText);            }      });   }   } function toggle_isnonending(){  //if (!$("input[name='rwd_is_non_ending']:checked").val()) {  if (elemById("rwd_is_non_ending").checked){    $('#div_rwd_end_dt').hide();  }else{    $('#div_rwd_end_dt').show();  }}function cal_rwd_points_by_multi(){  var tmp_pt=$('#chkin_amount').val();  var tmp_multi=$('#tmp_mulitplier').val();  if(IsNonEmpty(tmp_pt)==true && IsNonEmpty(tmp_multi)==true){        $('#chkin_points').val((tmp_pt * tmp_multi).toFixed(0));  }}function set_chk_bx(lr_tpe){  if(lr_tpe=='b' || lr_tpe=='rm'){     $("#div_rwd_is_reduction").hide();     $("#div_rwd_is_recurring").hide();     $("#div_rwd_is_one_time").hide();}else{      $("#div_rwd_is_reduction").show();      $("#div_rwd_is_recurring").show();      $("#div_rwd_is_one_time").show();  }}function set_act_submit(is_approve){    if(is_approve==1){        $('#act_app_rej').val('approve_cust_rwd_sess');    }else{        $('#act_app_rej').val('reject_cust_rwd_sess');    }    $('#frm_customer_rewards').submit();}function askCustEmail(){    $('#popupAskCustEmail').popup('open');	$('#ask_cust_email_err').html('');	$('#ask_cust_email').html('');}function saveCustEmail(){	$('#ask_cust_email_err').html('');	if(IsNonEmpty($('#ask_cust_email').val())){        if(isEmail($('#ask_cust_email').val())==false){            $('#ask_cust_email_err').html('{/literal}{$_lang.messages.validation.email}{literal}');        }else{            var info = {};    		info['action'] = 'askCustomerEmail';    		info['var1'] = $('#ask_cust_email').val();    		$.ajax({    	        type     : "POST",    	        url      :website + "/ajax/custom_functions.php" ,    	        dataType : "json",    					data		 : info,    					async		 : false,    	    		success  : function(data) {    						if(data==1){window.location.reload();}    					},error: function(objResponse){    					//	alert(objResponse.responseText);    					}    		});        }	}else{		$('#ask_cust_email_err').html('{/literal}{$_lang.messages.validation.not_empty|sprintf:"customer email"}{literal}');	}}function post_for_add_vist(cust_demand){	var info ={};	info['cust_demand'] = cust_demand;	info['is_req'] = 0;    postForm(info,"{/literal}{$page_url}{literal}");}function post_to_redeem(rwd_id,promotion,rwd_points,rwd_invoice){	var info ={};	info['redim'] = 1;	info['rwd_id'] = rwd_id;	info['promotion'] = promotion;	info['rwd_points'] = rwd_points;	info['rwd_invoice'] = rwd_invoice;		info['is_req'] = 0;	info['server_validated'] = "{/literal}{$server_validated}{literal}";    info['manager_cust_sess_id'] = "{/literal}{$manager_cust_sess_id}{literal}";    //alert('is_val::'+info['server_validated']);    	if((info['rwd_id']>0) && (info['promotion']>0)){		postForm(info,"{/literal}{$page_url}{literal}");	}else{		alert("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_id}{literal}");	}}function openServerPin(rwd_id,promotion){    $("#promotion").val(promotion);    $("#rwd_id").val(rwd_id);    $('#cust_popupServerPin').popup('open');}function openMobileValidation(rwd_id,promotion,rdm_pts,rdm_unit,is_customer){    $("#mob_val_promotion").val(promotion);    $("#mob_val_rwd_id").val(rwd_id);    if(rdm_unit=='Pts'){    	$("#div_reward_points").show();    	    	$("#rwd_points").val(rdm_pts);    	$("#tmp_allowed_pts").val(rdm_pts);    	    }else{    	$("#rwd_points").val(0);    	$("#div_reward_points").hide();    	$("#rwd_points").hide();    	$("#tmp_allowed_pts").val(0);    }           $('#popup_mobile_validate').popup('open');}function toggleRewardType(){    if($("#rwd_type").val()=='visit_based'){        $("#row_rwd_one_point_val").hide();        $("#row_rwd_point_limit").hide();        $("#row_rwd_check_in").show();    }else{        $("#row_rwd_one_point_val").show();        $("#row_rwd_point_limit").show();        $("#row_rwd_check_in").hide();    }}function actionbiz_rewards(action){	var varId = $("input:checked").length;	var isValid = 0;	if(varId > 0){	if(action != ""){		switch (action) {			case '{/literal}{$smarty.const.ACTION_DELETE}{literal}':			     if(confirm("{/literal}{$_lang.biz_rewards.DELETE.CONFIRM_MSG}{literal}")==true){					isValid = 1;				 }			break;			case '{/literal}{$smarty.const.ACTION_DEACTIVATE}{literal}':			         isValid = 1;			break;			case '{/literal}{$smarty.const.ACTION_ACTIVATE}{literal}':					isValid = 1;			break;		}		if(isValid){		 	$('#action').val(action);		    $('#frm_biz_rewards').submit();		}	} }else{			alert("{/literal}{$_lang.main.select_ids.empty}{literal}"); }}        function deletebiz_rewards(varId){	if(varId > 0){		if(confirm("{/literal}{$_lang.biz_rewards.DELETE.CONFIRM_MSG}{literal}")==true){			window.location.href="{/literal}{$page_url}{literal}?action=delete&rwd_id="+varId;		}	}}function validatebiz_rewards(){	$("#rwd_id_err").html("");	$("#rwd_buss_id_err").html("");	$("#rwd_cup_id_err").html("");	$("#rwd_type_err").html("");	$("#rwd_one_point_val_err").html("");	$("#rwd_point_limit_err").html("");		$("#rwd_basic_err").html("");	$("#rwd_total_balance_err").html("");	$("#rwd_lr_type_err").html("");	$("#rwd_is_reduction_err").html("");	$("#rwd_is_recurring_err").html("");	$("#rwd_is_one_time_err").html("");		$("#rwd_check_in_err").html("");	$("#rwd_is_quest_asc_err").html("");	$("#rwd_coupon_id_err").html("");	$("#rwd_start_dt_err").html("");	$("#rwd_end_dt_err").html("");	$("#rwd_created_dt_err").html("");	$("#rwd_updated_dt_err").html("");	var isErr = true;	if(elemById("action").value=="update"){		if(IsNonEmpty(elemById("rwd_id").value)==false){			$("#rwd_id_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_id}{literal}");			isErr = false;		}	}	if(IsNonEmpty(elemById("rwd_buss_id").value)==false){		$("#rwd_buss_id_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_buss_id}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_cup_id").value)==false){		$("#rwd_cup_id_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_cup_id}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_type").value)==false){		$("#rwd_type_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_type}{literal}");		isErr = false;	}    if($("#rwd_type").val()=='point_based'){    	if(IsNonEmpty(elemById("rwd_one_point_val").value)==false){    		$("#rwd_one_point_val_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_one_point_val}{literal}");    		isErr = false;    	}else{    		if(IsNumeric(elemById("rwd_one_point_val").value)==false){    			$("#rwd_one_point_val_err").html("{/literal}Invalid Point Value{literal}");    			isErr = false;    		}    	}    	if(IsNonEmpty(elemById("rwd_point_limit").value)==false){    		$("#rwd_point_limit_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_point_limit}{literal}");    		isErr = false;    	}else{    		if(IsNumeric(elemById("rwd_point_limit").value)==false){    			$("#rwd_point_limit_err").html("{/literal}Invalid Points Reqd.{literal}");    			isErr = false;    		}    	}    }else{        if(IsNonEmpty(elemById("rwd_check_in").value)==false){    		$("#rwd_check_in_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_check_in}{literal}");    		isErr = false;    	}else{    		if(IsNumeric(elemById("rwd_check_in").value)==false){    			$("#rwd_check_in_err").html("{/literal}Invalid Check ins Reqd.{literal}");    			isErr = false;    		}    	}    }    if(IsNonEmpty(elemById("rwd_basic").value)==false){		$("#rwd_basic_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_basic}{literal}");		isErr = false;	}/*	if(IsNumeric(elemById("rwd_basic").value)==false){		$("#rwd_basic_err").html("{/literal}Invalid basic.{literal}");		isErr = false;	}		if(IsNonEmpty(elemById("rwd_total_balance").value)==false){		$("#rwd_total_balance_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_total_balance}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_lr_type").value)==false){		$("#rwd_lr_type_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_lr_type}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_is_reduction").value)==false){		$("#rwd_is_reduction_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_is_reduction}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_is_recurring").value)==false){		$("#rwd_is_recurring_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_is_recurring}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_is_one_time").value)==false){		$("#rwd_is_one_time_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_is_one_time}{literal}");		isErr = false;	}    */	if(IsNonEmpty(elemById("rwd_is_quest_asc").value)==false){		$("#rwd_is_quest_asc_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_is_quest_asc}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_coupon_id").value)==false){		$("#rwd_coupon_id_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_coupon_id}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_start_dt").value)==false){		$("#rwd_start_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_start_dt}{literal}");		isErr = false;	}/*	if(IsNonEmpty(elemById("rwd_end_dt").value)==false){		$("#rwd_end_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_end_dt}{literal}");		isErr = false;	}*/	var compare_date = 0;	if(IsNonEmpty(elemById("rwd_start_dt").value)==false){		$("#rwd_start_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_start_dt}{literal}");		isErr = false;		compare_date = 0;	}	if(IsNonEmpty(elemById("rwd_end_dt").value)==false){        if (elemById("rwd_is_non_ending").checked==false){            $("#rwd_end_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_end_dt}{literal}");    		isErr = false;    		compare_date = 0;		}	}else{		if(compareDate(elemById("rwd_start_dt").value,elemById("rwd_end_dt").value)== false){			$("#rwd_end_dt_err").html("{/literal}{$_lang.messages.validation.gt_others_date|sprintf:$_lang.tbl_shift.label.shift_terminated_on:$_lang.tbl_shift.label.shift_created_on}{literal}");;			isErr = false;			compare_date = 0;		}	}    /*	if(IsNonEmpty(elemById("rwd_created_dt").value)==false){		$("#rwd_created_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_created_dt}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("rwd_updated_dt").value)==false){		$("#rwd_updated_dt_err").html("{/literal}{$_lang.biz_rewards.not_empty_msg.rwd_updated_dt}{literal}");		isErr = false;	}     */	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validatebiz_checkins(){	$("#reward_code_err").html("");	$("#chkin_points_err").html("");		$("#chkin_amount_err").html("");	$("#tmp_mulitplier_err").html("");		var isErr = true;    if(IsNonEmpty(elemById("reward_code").value)==false){		$("#reward_code_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.reward_code}{literal}");		isErr = false;	}		if(IsNonEmpty(elemById("chkin_amount").value)==false){		$("#chkin_amount_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.tmp_points}{literal}");		isErr = false;	}		if(IsNonEmpty(elemById("tmp_mulitplier").value)==false){		$("#tmp_mulitplier_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.tmp_mulitplier}{literal}");		isErr = false;	}		if(IsNumeric(elemById("chkin_amount").value)==false){		$("#tmp_points_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.tmp_points}{literal}");		isErr = false;	}	if(IsNumeric(elemById("tmp_mulitplier").value)==false){		$("#tmp_mulitplier_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.tmp_mulitplier}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("chkin_points").value)==false){		$("#chkin_points_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.chkin_points}{literal}");		isErr = false;	}		if(IsNumeric(elemById("chkin_points").value)==false){		$("#chkin_points_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.chkin_points}{literal}");		isErr = false;	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validate_server_pin(){	$("#server_pin_err").html("");	var isErr = true;    if(IsNonEmpty(elemById("server_pin").value)==false){		$("#server_pin_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.reward_code}{literal}");		isErr = false;	}		if(IsNonEmpty(elemById("server_code").value)==false){		$("#server_code_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.server_code}{literal}");		isErr = false;	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validate_cust_server_pin(){	$("#cust_server_pin_err").html("");	var isErr = true;    if(IsNonEmpty(elemById("cust_server_pin").value)==false){		$("#cust_server_pin_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.reward_code}{literal}");		isErr = false;	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validate_fetch_cust_rwd_sess(){	$("#sel_reward_sess_err").html("");	var isErr = true;    //if(IsNonEmpty(elemById("sel_reward_sess").value)==false){      if (!$("input[name='sel_reward_sess']:checked").val()) {		$("#sel_reward_sess_err").html("{/literal}{$_lang.tbl_temp_reward_sess.not_empty_msg.tmp_rwse_unique_cd}{literal}");		isErr = false;	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..function</script>{/literal}