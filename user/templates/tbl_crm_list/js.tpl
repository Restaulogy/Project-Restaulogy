{literal}<script type="text/javascript" src="{/literal}{$website}{literal}/js/flashMessage.js"></script><script type="text/javascript">function giveFlashMsg(obj){    if (obj.checked){       // $('#_all_sel_ppoup').show();       // setTimeout( "$('#_all_sel_ppoup').hide();",3000);       flashMessage('<div class="info">All contacts selected</div>');    }}function add_promotion_list_lnk(email_sms){    var str_lin="<a href='{/literal}{$prom_lst_link}{literal}'>Promotions</a>";    if(email_sms=='sms'){        $('#sms_text_msg').val($('#sms_text_msg').val()+str_lin);    }else{        $('#sms_msg').val($('#sms_msg').val()+str_lin);        //$('#email_preview').html($('#sms_msg').val()).trigger('create');    }}function val_and_submit(pg_to_show){  if(typeof(pg_to_show)==='undefined'){			pg_to_show="promotions";  }		  if(validate_email_sms_form(pg_to_show)){    $.mobile.loading( 'show', {    	text: 'Loading',    	textVisible: false,    	theme: 'c',    	html: ""    });    $('#frm_tbl_stafflist').submit();  }}function softdeletetbl_staff(){	var varId = $("input:checked").length;	if((varId-1) > 0) {        if((document.getElementById('_is_all_selected').checked==false)){            if(confirm("{/literal}{$_lang.tbl_staff.BANN_USER.CONFIRM_MSG}{literal}")==true){    			$('#action').val("BANN_USER");    			$('#frm_tbl_stafflist').submit();    		}        }else{            alert('You cannot select all contacts at at time for delete');        }	}else{		alert("{/literal}{$_lang.main.select_ids.empty}{literal}");	}}function add_to_sess_now(selc_rec_id,sel_check){        var isfound=0;		var info = {};        		info['action'] = "addChkValToSess";		info['var1'] = selc_rec_id;		if(sel_check.checked)            info['var2'] = 1;		else            info['var2'] = 0;		$.ajax({	        type     : "POST",	        url      : website + "/ajax/custom_functions.php" ,			data	 : info,	        dataType : "json",			async	 : false,	    	success  : function(response){                  if(response){                    $('#recipent_sel').val(response);                  }                },			error: function(objResponse){				//alert(objResponse.responseText);			}		});      	   return isfound; } function textCounter(field,field2,maxlimit){     var countfield = document.getElementById(field2);     if ( field.value.length > maxlimit ) {      field.value = field.value.substring( 0, maxlimit );      return false;     } else {      countfield.value = maxlimit - field.value.length;     }}function cal_rwd_points_by_multi(){  var tmp_pt=$('#chkin_amount').val();  var tmp_multi=$('#tmp_mulitplier').val();  if(IsNonEmpty(tmp_pt)==true && IsNonEmpty(tmp_multi)==true){        $('#chkin_points').val((tmp_pt * tmp_multi).toFixed(0));  }}function set_cust_id(cust_id,pts_earlier_today,award_multiplier){    if(cust_id>0){        $('#cust_id').val(cust_id);        $('#tmp_mulitplier').val(award_multiplier);                $('#popupAddVisit').popup('open');        if(pts_earlier_today >0){          $('#div_earlier_today').html('Points added earlier today - '+ pts_earlier_today);        }else{          $('#div_earlier_today').html('');        }    }else{        alert('Please select the customer first');    }}function validatebiz_checkins(){	$("#reward_code_err").html("");	$("#chkin_points_err").html("");	$("#tmp_points_err").html("");	$("#tmp_mulitplier_err").html("");	var isErr = true;	    if(IsNonEmpty(elemById("reward_code").value)==false){		$("#reward_code_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.reward_code}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("tmp_points").value)==false){		$("#tmp_points_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.tmp_points}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("tmp_mulitplier").value)==false){		$("#tmp_mulitplier_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.tmp_mulitplier}{literal}");		isErr = false;	}	if(IsNumeric(elemById("tmp_points").value)==false){		$("#tmp_points_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.tmp_points}{literal}");		isErr = false;	}	if(IsNumeric(elemById("tmp_mulitplier").value)==false){		$("#tmp_mulitplier_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.tmp_mulitplier}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("chkin_points").value)==false){		$("#chkin_points_err").html("{/literal}{$_lang.biz_checkins.not_empty_msg.chkin_points}{literal}");		isErr = false;	}	if(IsNumeric(elemById("chkin_points").value)==false){		$("#chkin_points_err").html("{/literal}{$_lang.biz_checkins.input_err_msg.chkin_points}{literal}");		isErr = false;	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validate_me_now(){  var s = document.getElementById('uploaded');  if(null != s && '' == s.value)  {    alert('Define file name');    s.focus(); return false;  }  return true;}function show_hide_preview(is_show,pg_to_show){	if(typeof(pg_to_show)==='undefined'){			pg_to_show="promotions";	}			var txt='';	if(is_show){	     //$('#email_body_content').html($('#sms_msg').val()).trigger('create');	      //$('#email_preview').html($('#sms_msg').val()).trigger('create');		            	      if(pg_to_show=="promotions"){	      	/*var txt_email_preview = $('#email_preview');	      	if(elemById("action").value=='SEND_EMAIL')	      		txt=$('#sms_msg').val();	      	else	      		txt=$('#sms_text_msg').val();	      		 	      	txt_email_preview.html(txt).trigger('create');*/	      	//fill_prom_text();	      	$('#popup_email_preview').popup('open');	      }else{	      	/*var txt_email_preview = $('#email_preview_mnu');	      	if(elemById("action").value=='SEND_EMAIL')	      		txt=$('#sms_msg_mnu').val();	      	else	      		txt=$('#sms_text_msg_mnu').val();	      		 	      	txt_email_preview.html(txt).trigger('create');*/	      	//fill_menu_text();	      	$('#popup_email_preview_mnu').popup('open');	      }	}}function fill_menu_text(){        var txt_des = $('#sms_msg_mnu');        var txt_sms_text_msg = $('#sms_text_msg_mnu');        var txt_email_preview = $('#email_preview_mnu');        var info = {};                var sel_items_lst = new Array();        var sel_items_count = $("#menu_id :selected").length;        if(elemById("action").value=='SEND_EMAIL'){            info['var2'] = 'email';            info['var3'] = txt_des.val();        }else{            info['var2'] = 'sms';            info['var3'] = txt_sms_text_msg.val();        } 		        if (sel_items_count >0 ){        	$("#menu_id option:selected").each(function(){        		//alert($(this).val());			    sel_items_lst.push($(this).val());			});            txt_des.empty();			info['action'] = "getMenuItemDetails";			info['var1'] = sel_items_lst;//document.getElementById('menu_id').value;						$.ajax({	        type     : "POST",	        url      : website + "/ajax/custom_functions.php" ,			data	 : info,	        dataType : "json",			async	 : false,	    	success  : function(response){                  if(response){                    txt_des.val('');                    txt_sms_text_msg.val('');                    if(elemById("action").value=='SEND_EMAIL'){                                               txt_des.val(response.comments).trigger('create');;                        txt_email_preview.html(response.email_preview).trigger('create');                        txt_sms_text_msg.val('');                    }else{                             	//alert(response.sms_txt);                                       txt_sms_text_msg.val(response.sms_txt);                        txt_email_preview.html('');                        //textCounter(txt_sms_text_msg,'counter',125);                        $('#counter_mnu').val(100-response.sms_txt.length);                        $('#counter_mnu').trigger('create');                    }                  }                },			error: function(objResponse){				//alert(objResponse.responseText);			}		});		$('#email_prev_mnu').parents('.ui-btn').show();		return false;       }else{         txt_des.val($('#rest_name').val());         txt_sms_text_msg.val($('#rest_name').val());         txt_email_preview.html($('#rest_name').val());         $('#email_prev_mnu').parents('.ui-btn').hide();                  return true;       } }function fill_prom_text(){        var txt_des = $('#sms_msg');        var txt_sms_text_msg = $('#sms_text_msg');        var txt_email_preview = $('#email_preview');        var info = {};        if(elemById("action").value=='SEND_EMAIL'){            info['var2'] = 'email';            info['var3'] = txt_des.val();        }else{            info['var2'] = 'sms';            info['var3'] = txt_sms_text_msg.val();        }        if (document.getElementById('prom_id').value >0 ){            txt_des.empty();        	//city.attr("disabled", true);			//var info = {};			info['action'] = "getPromDetails";			info['var1'] = document.getElementById('prom_id').value;			$.ajax({	        type     : "POST",	        url      : website + "/ajax/custom_functions.php" ,			data	 : info,	        dataType : "json",			async	 : false,	    	success  : function(response){                  if(response){                    txt_des.val('');                    txt_sms_text_msg.val('');                    if(elemById("action").value=='SEND_EMAIL'){                                                txt_des.val(response.comments).trigger('create');;                        txt_email_preview.html(response.email_preview).trigger('create');                                            }else{                                                txt_sms_text_msg.val(response.sms_txt);                        txt_email_preview.html('');                        //textCounter(txt_sms_text_msg,'counter',125);                        $('#counter').val(100-response.sms_txt.length);                        $('#counter').trigger('create');                    }                  }                },			error: function(objResponse){				//alert(objResponse.responseText);			}		});		$('#email_prev').parents('.ui-btn').show();		return false;       }else{         txt_des.val($('#rest_name').val());         txt_sms_text_msg.val($('#rest_name').val());         txt_email_preview.html($('#rest_name').val());         $('#email_prev').parents('.ui-btn').hide();         if ($('#prom_id').val() == 0){            add_promotion_list_lnk(info['var2']);         }         return true;       } }function showSMS(show,pg_to_show){	if(typeof(pg_to_show)==='undefined'){			pg_to_show="promotions";	}	if(pg_to_show=="promotions"){		if(show=='sms'){	      $("#sms_part").show();	      $("#email_part").hide();	    }else{	      $("#sms_part").hide();	      $("#email_part").show();	      if (document.getElementById('prom_id').value==0){	        $('#email_prev').parents('.ui-btn').hide();	      }	    }	}else{		if(show=='sms'){	      $("#sms_part_mnu").show();	      $("#email_part_mnu").hide();	    }else{	      $("#sms_part_mnu").hide();	      $("#email_part_mnu").show();	      if (document.getElementById('menu_id').value==""){	        $('#email_preview_mnu').parents('.ui-btn').hide();	      }	    }	}    }function validate_email_sms_form(pg_to_show){    var isErr = true;    $("#sms_msg_err").val('');    $('#sms_text_msg_err').val('');    $('#prom_id_err').val('');        $("#sms_msg_mnu_err").val('');    $('#sms_text_msg_mnu_err').val('');    $('#menu_id_err').val('');        if(typeof(pg_to_show)==='undefined'){			pg_to_show="promotions";	}	if(pg_to_show=="promotions"){		if(elemById("action").value=='SEND_SMS'){	        if(IsNonEmpty(elemById("sms_text_msg").value)==false){	            $("#sms_text_msg_err").html("{/literal}{$_lang.tbl_crm.not_empty_msg.sms_msg}{literal}");	            isErr = false;	        }	    }else if(elemById("action").value=='SEND_EMAIL'){	        if(IsNonEmpty(elemById("sms_msg").value)==false){	            $("#sms_msg_err").html("{/literal}{$_lang.tbl_crm.not_empty_msg.sms_msg}{literal}");	            isErr = false;	        }	    }else{	         isErr = false;	    }	}else{		if(elemById("action").value=='SEND_SMS'){	        if(IsNonEmpty(elemById("sms_text_msg_mnu").value)==false){	            $("#sms_text_msg_mnu_err").html("{/literal}{$_lang.tbl_crm.not_empty_msg.sms_msg}{literal}");	            isErr = false;	        }	    }else if(elemById("action").value=='SEND_EMAIL'){	        if(IsNonEmpty(elemById("sms_msg_mnu").value)==false){	            $("#sms_msg_mnu_err").html("{/literal}{$_lang.tbl_crm.not_empty_msg.sms_msg}{literal}");	            isErr = false;	        }	    }else{	         isErr = false;	    }	}       return isErr;}function open_prom_sel_dialogue(is_email_sms,pg_to_show){		var varId = $("input:checked").length;	var sess_selcted = "{/literal}{$smarty.session._sel_crm_id_fr_email|@count}{literal}";	if(typeof(pg_to_show)==='undefined'){			pg_to_show="promotions";	}		if((sess_selcted>0)||((varId-1) > 0)){        if(is_email_sms=='email'){            $('#action').val('SEND_EMAIL');        }else{            $('#action').val('SEND_SMS');            //$('#popupSendSMS').show('open'); .        }        showSMS(is_email_sms,pg_to_show);        if($('#_is_all_selected').is(':checked')){          $('#x_recipient').html('All recipients');        }else{          //$('#x_recipient').html("{/literal}{$smarty.session._sel_crm_id_fr_email|@count}{literal} recipients<br>");          if($('#recipent_sel').val()>0){            $('#x_recipient').html($('#recipent_sel').val() + ' recipients');          }else{            if(sess_selcted>0){                $('#x_recipient').html(sess_selcted + ' recipients');            }          }          //alert("{/literal}{$smarty.session._sel_crm_id_fr_email|@count}{literal}");        }        if(pg_to_show=="menus"){        	$('#popupMenus').show('open');//.popup        }else{        	$('#popupPromotions').show('open');//.popup	        }        	}else{		alert("{/literal}{$_lang.main.select_ids.empty}{literal}");	}}function deletetbl_staff(){	var varId = $("input:checked").length;	if(varId > 0){		if(confirm("{/literal}{$_lang.tbl_staff.DELETE.CONFIRM_MSG}{literal}")==true){			$('#action').val("{/literal}{$smarty.const.ACTION_DELETE}{literal}");			$('#frm_tbl_stafflist').submit();		}	}else{		alert("{/literal}{$_lang.main.select_ids.empty}{literal}");	}}function actiontbl_staff(action){	var varId = $("input:checked").length;	var isValid = 0;	if(varId > 0){	if(action != ""){		switch (action) {			case '{/literal}{$smarty.const.ACTION_DELETE}{literal}':			if(confirm("{/literal}{$_lang.tbl_staff.DELETE.CONFIRM_MSG}{literal}")==true){				isValid = 1;			}			break;			case '{/literal}{$smarty.const.ACTION_DEACTIVATE}{literal}':			isValid = 1;			break;			case '{/literal}{$smarty.const.ACTION_ACTIVATE}{literal}':			isValid = 1;			break;		}		if(isValid){		 	$('#action').val(action);		    $('#frm_tbl_stafflist').submit();		}	}	}else{			alert("{/literal}{$_lang.main.select_ids.empty}{literal}"); 	}}function validatetbl_staff(){	$("#staff_id_err").html("");	$("#staff_member_id_err").html("");	$("#staff_address_err").html("");	$("#staff_lname_err").html("");	$("#staff_fname_err").html("");	$("#staff_zip_err").html("");	$("#staff_phone_err").html("");	$("#staff_device_id_err").html("");	$("#staff_gcm_reg_id_err").html("");	$("#staff_description_err").html("");	$("#staff_desigation_err").html("");/*	$("#staff_start_date_err").html("");	$("#staff_end_date_err").html("");	$("#staff_restaurent_err").html("");*/	var isErr = true;	if(elemById("action").value=="update"){		if(IsNonEmpty(elemById("staff_id").value)==false){			$("#staff_id_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_id}{literal}");			isErr = false;		}		if(IsNonEmpty(elemById("staff_member_id").value)==false){		$("#staff_member_id_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_member_id}{literal}");		isErr = false;		}	}else{		if(IsNonEmpty(elemById("staff_email").value)==false){		$("#staff_email_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_email}{literal}");		isErr = false;		}else{			if(isEmail(elemById("staff_email").value)==false){				$("#staff_email_err").html("{/literal}{$_lang.messages.validation.email}{literal}");				isErr = false;			}		}		if(IsNonEmpty(elemById("staff_password").value)==false){		$("#staff_password_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_password}{literal}");		isErr = false;		}	}		if(IsNonEmpty(elemById("staff_role").value)==false){		$("#staff_role_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_role}{literal}");		isErr = false;		}	if(IsNonEmpty(elemById("staff_address").value)==false){		$("#staff_address_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_address}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_lname").value)==false){		$("#staff_lname_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_lname}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_fname").value)==false){		$("#staff_fname_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_fname}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_zip").value)==false){		$("#staff_zip_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_zip}{literal}");		isErr = false;	}else{		if(isUSZip(elemById("staff_zip").value)==false){			$("#staff_zip_err").html("{/literal}{$_lang.messages.validation.isUSZip}{literal}");			isErr = false;		}	}	if(IsNonEmpty(elemById("staff_phone").value)==false){		$("#staff_phone_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_phone}{literal}");		isErr = false;	}else{		if(isPhoneNumber(elemById("staff_phone").value)==false){			$("#staff_phone_err").html("{/literal}{$_lang.messages.validation.isPhoneNumber}{literal}");			isErr = false;		}	}	/*if(IsNonEmpty(elemById("staff_device_id").value)==false){		$("#staff_device_id_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_device_id}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_gcm_reg_id").value)==false){		$("#staff_gcm_reg_id_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_gcm_reg_id}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_description").value)==false){		$("#staff_description_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_description}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_desigation").value)==false){		$("#staff_desigation_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_desigation}{literal}");		isErr = false;	}*/	/*if(IsNonEmpty(elemById("staff_start_date").value)==false){		$("#staff_start_date_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_start_date}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_end_date").value)==false){		$("#staff_end_date_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_end_date}{literal}");		isErr = false;	}	if(IsNonEmpty(elemById("staff_restaurent").value)==false){		$("#staff_restaurent_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_restaurent}{literal}");		isErr = false;	}*/	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction quick_validate_search_form(){	$("#filt_search_phone_err").html("");	var isErr = true;	if(IsNonEmpty(elemById("filt_search_phone").value)==false){        $("#filt_search_phone_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.staff_phone}{literal}");        isErr = false;    }else{      	if(isPhoneNumber(elemById("filt_search_phone").value) == false){    	  	$('#filt_search_phone_err').html("Phone is not proper.");    		isErr = false;      	}    }	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..functionfunction validate_search_form(){	$("#search_total_points_err").html("");	$("#search_redeemed_points_err").html("");	$("#search_balance_points_err").html("");	var isErr = true;	if(IsNonEmpty(elemById("search_total_points").value)==false){    }else{        if(IsNumeric(elemById("search_total_points").value)==false){             $("#search_total_points_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.total_points}{literal}");             isErr = false;        }	}	if(IsNonEmpty(elemById("search_redeemed_points").value)==false){    }else{        if(IsNumeric(elemById("search_redeemed_points").value)==false){             $("#search_redeemed_points_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.redeemed_points}{literal}");             isErr = false;        }	}		if(IsNonEmpty(elemById("search_balance_points").value)==false){    }else{        if(IsNumeric(elemById("search_balance_points").value)==false){             $("#search_balance_points_err").html("{/literal}{$_lang.tbl_staff.not_empty_msg.balance_points}{literal}");             isErr = false;        }	}	if(isErr == false){		alert("{/literal}{$_lang.messages.revise_form}{literal}");	}	return isErr;}//..function</script>{/literal}