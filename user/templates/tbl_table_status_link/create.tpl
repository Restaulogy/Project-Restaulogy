{include file="header.tpl"}<div class="wrapper"><h1>{$_lang.tbl_table_status_link.create_title}</h1>{if $error_msg}	<center>{$error_msg}</center>{/if}<form name="frmcreatetbl_table_status_link" id="frmcreatetbl_table_status_link" onsubmit="return validatetbl_table_status_link();" method="POST" action="{$page_url}">	<input type="hidden" name="tbl_sts_lnk_id" id="tbl_sts_lnk_id" value="0"/>	<div style="display:none;" class="error" id="tbl_sts_lnk_id_err"></div>	<label >{$_lang.tbl_table_status_link.label.tbl_sts_lnk_table_id}</label>	    <select name="tbl_sts_lnk_table_id" id="tbl_sts_lnk_table_id" onchange="{if $Global_member.member_role_id eq $smarty.const.ROLE_MANAGER} get_table_employees(this.value,'');{/if}">        <option value="">Select Table</option>		{foreach $lst_tables as $val}		{if $smarty.request.tbl_sts_lnk_table_id neq ""}			<option value="{$val.id}" {if $smarty.request.tbl_sts_lnk_table_id eq $val.id}selected="selected"{else}disabled="disabled"{/if}>{$val.title}</option>		{else}			<option value="{$val.id}" {if $val.isActive neq 1}disabled="disabled"{/if}>{$val.title}</option>		{/if}            	    {/foreach}	</select>	<div class="error" id="tbl_sts_lnk_table_id_err"></div>		<label>{$_lang.tbl_table_status_link.label.tbl_sts_lnk_party_size}</label>	<select name="tbl_sts_lnk_party_size" id="tbl_sts_lnk_party_size">        		 {for $var=1 to 15}            <option value="{$var}">{$var}</option>	    {/for} 	</select>	<div class="error" id="tbl_sts_lnk_party_size_err"></div>		{if $Global_member.member_role_id eq $smarty.const.ROLE_WAITER}		<input type="hidden" name="tbl_sts_lnk_emp_id" id="tbl_sts_lnk_emp_id" value="{$smarty.session.guid}"/>	{else}		<div class="field-row" >			<label for="tbl_sts_lnk_emp_id">{$_lang.tbl_table_status_link.label.tbl_sts_lnk_emp_id}</label>		<p>			<select id="tbl_sts_lnk_emp_id" name="tbl_sts_lnk_emp_id">				<option value="">Select Employee</option>			</select>			<div class="error" id="tbl_sts_lnk_emp_id_err"></div>		</p>		</div><!--/.field-row-->	{/if}			<label>{$_lang.tbl_table_status_link.label.tbl_sts_lnk_cust_id}</label>		<input name="tbl_sts_lnk_cust_id" id="tbl_sts_lnk_cust_id" {if $smarty.request.tbl_sts_lnk_cust_id neq ""}value="{$smarty.request.tbl_sts_lnk_cust_id}" readonly="readonly"{/if}></input>	<div class="error" id="tbl_sts_lnk_cust_id_err"></div>	<label>{$_lang.tbl_table_status_link.label.tbl_sts_lnk_status_id}</label>    <select name="tbl_sts_lnk_status_id" id="tbl_sts_lnk_status_id">        <!--<option value="">Select Status</option>-->		{foreach $lst_table_status as $val}		 {if $smarty.request.tbl_sts_lnk_status_id neq ""}		 	{if $val.id eq $smarty.request.tbl_sts_lnk_status_id}           	 <option value="{$val.id}">{$val.title}</option>		 	{/if}		{else}		  {if $val.id eq $smarty.const.TBL_STATUS_OCCUPIED}            <option value="{$val.id}">{$val.title}</option>		  {/if}		{/if}	    {/foreach}	</select>	<div class="error" id="tbl_sts_lnk_status_id_err"></div>   				<!--	<label for="tbl_sts_lnk_emp_id">{$_lang.tbl_table_status_link.label.tbl_sts_lnk_emp_id}</label>	<input type="text" name="tbl_sts_lnk_emp_id" id="tbl_sts_lnk_emp_id" value="{$smarty.post.tbl_sts_lnk_emp_id}"/>	<div class="error" id="tbl_sts_lnk_emp_id_err"></div>    <label for="tbl_sts_lnk_start_time">{$_lang.tbl_table_status_link.label.tbl_sts_lnk_start_time}</label>	<input type="text" name="tbl_sts_lnk_start_time" id="tbl_sts_lnk_start_time" value="{$smarty.post.tbl_sts_lnk_start_time}"/>	<div class="error" id="tbl_sts_lnk_start_time_err"></div>	<label for="tbl_sts_lnk_end_time">{$_lang.tbl_table_status_link.label.tbl_sts_lnk_end_time}</label>	<input type="text" name="tbl_sts_lnk_end_time" id="tbl_sts_lnk_end_time" value="{$smarty.post.tbl_sts_lnk_end_time}"/>	<div class="error" id="tbl_sts_lnk_end_time_err"></div>    -->    <br>    <center>    	<input type="hidden" id="action" name="action" value="{$smarty.const.ACTION_CREATE}"/>    <input data-role="button" data-icon="save" data-inline="true" type="button" value="{$_lang.save_lbl}"  onclick="checkforcleaning();"/>		    <input data-role="button" data-icon="delete" data-inline="true" type="reset" value="{$_lang.cancel_lbl}" onclick="window.location.href='{$page_url}'"/>    </center></form>{include file="tbl_table_status_link/js.tpl"}</div>{include file="footercontent.tpl"}{literal}<script type="text/javascript"> function chkTblCapacity(table_id){  var	maxLimit = 0;  if(table_id > 0){  	 var info = {};	 info['action'] = "getTableSeatingCapcity";	 info['var1'] = table_id;	  	 $.ajax({	        type     : "POST",	        url      : website + "/ajax/custom_functions.php" , 			data	 : info,	        dataType : "json",			async	 : false,	    	success  : function(response){ 				maxLimit = response;			},			error: function(objResponse){				alert(objResponse.responseText);			}		}); 	}		var str = "";	var sel_str = '';	if(maxLimit > 0){				for (var i=0;i<maxLimit;i++)		{  			str  = str + '<option value="'+i+'" '+ ((i == (maxLimit-1))?' selected="selected"':'') +'>'+i+'</option>';		}	}else{	str = '<option value="0"></option>';	}	var objPartySize = $("#tbl_sts_lnk_party_size");	objPartySize.html(str);	objPartySize.trigger('refresh');	objPartySize.selectmenu('refresh');	 }  function get_table_employees(tbl_id){  		var emp_lst_cntrl = $('#tbl_sts_lnk_emp_id');		         if (tbl_id != ""){			       		emp_lst_cntrl.empty();        	emp_lst_cntrl.attr("disabled", true);			var info = {};			info['action'] = "getTblShiftEmployees";						info['var1'] = tbl_id;			  			$.ajax({	        type     : "POST",	        url      : website + "/ajax/custom_functions.php" , 			data	 : info,	        dataType : "json",			async	 : false,	    	success  : function(response){                   if(response){                 	emp_lst_cntrl.empty();                  	emp_lst_cntrl.attr("disabled", false);					                  	$('<option value="0">Select Employee</option>').appendTo(emp_lst_cntrl); 									var sel_str = '';					for(i in response){						sel_str = '';						if(response[i].isDefault == 1){							sel_str = ' selected="selected"'; 							$('<option value="'+ response[i].id +'"' + sel_str + '>'+ response[i].title +'</option>').appendTo(emp_lst_cntrl); 						}					  /* 					  if(prm  == i){					   	$('<option value="'+ i +'" selected="selected">'+ response[i] +'</option>').appendTo(emp_lst_cntrl); 					   }else{					   	$('<option value="'+ i +'">'+ response[i] +'</option>').appendTo(emp_lst_cntrl); 					   } 					  */					}              	 	  emp_lst_cntrl.selectmenu('refresh', true);                  }                },			error: function(objResponse){				alert(objResponse.responseText);			}		});                    }else{	   	   emp_lst_cntrl.empty();		   $('<option value="0">Select Employee</option>').appendTo(emp_lst_cntrl); 		   //emp_lst_cntrl.selectmenu('refresh', true);	   } 	   emp_lst_cntrl.selectmenu('refresh');	   return false;   }    		 {/literal} {if $smarty.request.tbl_sts_lnk_table_id gt 0} {literal} $(function(){				setTimeout('chkTblCapacity({/literal}{$smarty.request.tbl_sts_lnk_table_id}{literal});get_table_employees({/literal}{$smarty.request.tbl_sts_lnk_table_id}{literal});',500);				//setTimeout('',500);						});	{/literal}  {/if} {literal}</script>{/literal}<body></body>