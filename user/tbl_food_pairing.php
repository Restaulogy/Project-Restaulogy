<?phpinclude_once(dirname(dirname(__FILE__))."/init.php");include_once("header.php");$active_page = "tbl_food_pairing";$food_pair_id= get_input("food_pair_id");$food_pair_main_dish= get_input("food_pair_main_dish",0);$food_pair_paired_dish= get_input("food_pair_paired_dish",array());$food_pair_start_date= get_input("food_pair_start_date");$food_pair_end_date= get_input("food_pair_end_date");$action = strtoupper(get_input(ACTION_TITLE));$mode = strtoupper(get_input(MODE_TITLE));$offset = get_input(OFFSET_TITLE,OFFSET_VALUE);$limit =  get_input(LIMIT_TITLE,LIMIT_VALUE);$sort_on = get_input(SORT_ON,"food_pair_id");$sort_by=$new_sort="";biz_set_sorting_var($sort_by,$new_sort);$url = "{$website}/user/tbl_food_pairing.php?food_pair_main_dish={$food_pair_main_dish}";$navigationURL = $url."?food_pair_main_dish={$food_pair_main_dish}&".SORT_ON."={$sort_on}&".SORT_BY."={$sort_by}";$isSuccess = "";//..get list of selected items$sel_tbl_food_pairing= get_input('sel_tbl_food_pairing');$lst_sel_ids='';if(is_not_empty($sel_tbl_food_pairing)){		$lst_sel_ids=implode(',', array_keys($sel_tbl_food_pairing));} if(($sesslife==true) && (is_gt_zero_num($food_pair_main_dish))){ $objtbl_food_pairing= new tbl_food_pairing();if(is_not_empty($action)){	switch($action){		case ACTION_CREATE: 			if(is_gt_zero_num($food_pair_main_dish) && is_not_empty($food_pair_paired_dish)){					foreach($food_pair_paired_dish as $_each_dish){												$isSuccess = $objtbl_food_pairing->create($food_pair_main_dish, $_each_dish,'','');					}							}			//$isSuccess = $objtbl_food_pairing->create($food_pair_main_dish, $food_pair_paired_dish, $food_pair_start_date, $food_pair_end_date);			break;		case ACTION_UPDATE: 			$isSuccess = $objtbl_food_pairing->update($food_pair_id, $food_pair_main_dish, $food_pair_paired_dish, $food_pair_start_date, $food_pair_end_date);			break;		case ACTION_DELETE: 			//$isSuccess = $objtbl_food_pairing->delete(array(FOOD_PAIR_ID=>$food_pair_id));			if(is_not_empty($lst_sel_ids)){					$isSuccess = $objtbl_food_pairing->delete(array(FOOD_PAIR_ID=>$lst_sel_ids));			}else{				$isSuccess = OPERATION_FAIL;			}  			break;		case ACTION_ACTIVATE: 			$isSuccess = $objtbl_food_pairing->activate($food_pair_id);			break;		case ACTION_DEACTIVATE: 			$isSuccess = $objtbl_food_pairing->deactivate($food_pair_id);			break;	}//..switch}//..ifif(is_not_empty($isSuccess)){	if(is_gt_zero_num($isSuccess)){		$err .= "<div class='info'>".$_lang['tbl_food_pairing'][$action]['SUCCESS_MSG']."</div>";	}elseif($isSuccess == OPERATION_FAIL){		$err .= "<div class='error'>".$_lang['tbl_food_pairing'][$action]['FAILURE_MSG']."</div>";	}elseif($isSuccess == OPERATION_DUPLICATE){		$err .= "<div class='error'>".$_lang['tbl_food_pairing'][$action]['DUPLICATE_MSG']."</div>";	}}//..if	$result_found=0;	$tbl_food_pairinglist = $objtbl_food_pairing->readArray(array(FOOD_PAIR_MAIN_DISH => $food_pair_main_dish,OFFSET_TITLE=>$offset,LIMIT_TITLE=>$limit,SORT_BY=>$sort_by,SORT_ON=>$sort_on),$result_found,1);	$allpageCount = 0;	$currentPage = 0;	$smarty->assign('pagination',biz_pagination(array("url"=>$navigationURL,LIMIT_TITLE=>$limit,OFFSET_TITLE=>$offset,"count"=>$result_found),$allpageCount,$currentPage));	$smarty->assign('allpageCount',$allpageCount);	$smarty->assign('currentPage',$currentPage);	$smarty->assign('tbl_food_pairinglist', $tbl_food_pairinglist);	$smarty->assign('result_found',$result_found);	$template = "tbl_food_pairing/tbl_food_pairing.tpl";		if($sesslife==true && ($Global_member['member_role_id'] == ROLE_WAITER || $Global_member['member_role_id'] == ROLE_MANAGER || $Global_member['member_role_id'] == ROLE_ADMIN)){		$breadcrumbs[] = array(					 	'link'=>$website.'/user/pref_mng_cntrols.php',						'title'=>$_lang['main']['pref_mng_cntrls']);		$breadcrumbs [] =   array(						 	'link'=>$website.'/user/tbl_dishes.php',							'title'=>$_lang['tbl_dishes']['listing_title']);			$breadcrumbs [] =   array(						 	'link'=>$url,							'title'=>$_lang['tbl_food_pairing']['listing_title']);												}else{		$breadcrumbs[] = array(						'link'=>$website.'/user/tbl_menu.php',						'title'=>$_lang['tbl_menu']['listing_title']); 	}		if (is_not_empty($mode)){		if(($mode == MODE_VIEW || $mode==MODE_UPDATE) && is_gt_zero_num($food_pair_id)){			$tbl_food_pairinginfo= $objtbl_food_pairing->GetInfo($food_pair_id);			$smarty->assign('tbl_food_pairinginfo',$tbl_food_pairinginfo);			if($mode==MODE_UPDATE){				$smarty->assign("isUpdate",1);			}			$template = "tbl_food_pairing/view.tpl";		}elseif($mode == MODE_CREATE){			$template = "tbl_food_pairing/create.tpl";		}}	$lst_dishes=tbl_dishes::GetFields(array('key_field'=>DISH_ID,'value_field'=>DISH_NAME,'isActive'=>1));  $smarty->assign('lst_dishes', $lst_dishes);	$smarty->assign('food_pair_main_dish', $food_pair_main_dish);			$smarty->assign('food_pair_main_dish_detail', tbl_dishes::GetInfo($food_pair_main_dish));			$smarty->assign('page_url', $url);	$smarty->assign('navigationURL',$navigationURL);	$smarty->assign('new_sort',$new_sort);	$smarty->assign('active_page',$active_page);}else{	$template="index.tpl";}include_once("footer.php");?>