<?phpinclude_once(dirname(dirname(__FILE__)).'/init.php');include_once('header.php');$active_page = 'tbl_tip_list'; if($sesslife==true){ /*$tip_id= get_input('tip_id');$tip_percent= get_input('tip_percent');*/$type = get_input('type','server');$pst_table = get_input('table',0);$pst_employee = get_input('employee',0);$is_distribution = get_input('is_distribution',0); $tip_dis_id = get_input(TIP_DIS_ID,0);$frm_dt = get_input('from_date',date(DATE_FORMAT ,strtotime("-1 month")));$frm_dt = date(DATE_FORMAT,strtotime($frm_dt));$to_dt= get_input('to_date',date(DATE_FORMAT));$to_dt = date(DATE_FORMAT,strtotime($to_dt));$action = strtoupper(get_input(ACTION_TITLE));$mode = strtoupper(get_input(MODE_TITLE));$offset = get_input(OFFSET_TITLE,OFFSET_VALUE);$limit =  get_input(LIMIT_TITLE,LIMIT_VALUE);if(is_gt_zero_num($is_distribution)){	$sort_on = get_input(SORT_ON,TIP_DIS_ID); }else{ 	$sort_on = get_input(SORT_ON,'order_table_id'); }$sort_by=$new_sort='';biz_set_sorting_var($sort_by,$new_sort);$url = $website.'/user/tbl_tip_list.php';$navigationURL = $url.'?'.SORT_ON.'='.$sort_on.'&'.SORT_BY.'='.$sort_by;$isSuccess = '';	$filter_text=" (".date('m/d/y',strtotime($frm_dt))." - ".date('m/d/y',strtotime($to_dt)).") {$type} wise";	if($pst_table>0){		$table_info=tbl_dining_table::GetInfo($pst_table);		$filter_text .= " for table (".$table_info["table_number"].")";	}	if($pst_employee>0){		$usr_detail=get_user($pst_employee);		$filter_text .= " for server (".$usr_detail["full_name"].")";	}		$objtbl_tip_list=new tbl_tip();		$result_found=0;	if(is_gt_zero_num($is_distribution)){ 		$search_arr = array(); 		if(is_gt_zero_num($tip_dis_id)){			$search_arr[TIP_DIS_ID] = $tip_dis_id; 		}else{			$search_arr = array(OFFSET_TITLE=>$offset,LIMIT_TITLE=>$limit,SORT_BY=>$sort_by,SORT_ON=>$sort_on,'from_date'=>$frm_dt,'to_date'=>$to_dt ) ;			if(is_gt_zero_num($pst_employee)){				$search_arr[TIP_DIS_SHARED_AMONG]= $pst_employee;			}		} 		//print_r($search_arr);		$tip_list = tbl_tip_distribution::readArray($search_arr,$result_found,1,1); 		 		$pagination= 	biz_pagination(array('url'=>$navigationURL,LIMIT_TITLE=>$limit,OFFSET_TITLE=>$offset,'count'=>$result_found),$allpageCount,$currentPage) ;			}else{		$tip_list = $objtbl_tip_list->getTipList(array(OFFSET_TITLE=>$offset,LIMIT_TITLE=>$limit,SORT_BY=>$sort_by,SORT_ON=>$sort_on,'from_date'=>$frm_dt,'to_date'=>$to_dt,'type'=>$type,'table'=>$pst_table,'employee'=>$pst_employee),$result_found,1);	  $pagination= 	biz_pagination(array('url'=>$navigationURL,LIMIT_TITLE=>$limit,OFFSET_TITLE=>$offset,'count'=>$result_found),$allpageCount,$currentPage);		}		  	$allpageCount = 0;	$currentPage = 0;	$smarty->assign('pagination',$pagination);	$smarty->assign('allpageCount',$allpageCount);	$smarty->assign('currentPage',$currentPage);	$smarty->assign('tip_list', $tip_list);	$smarty->assign('result_found',$result_found);	$template = 'tbl_tip/tbl_tip_list.tpl';		$breadcrumbs[] =  array('link'=>$website.'/user/pref_mng_cntrols.php',						'title'=>$_lang['main']['pref_mng_cntrls']) ;	$breadcrumbs[] =  array('link'=>$website.'/user/tbl_tip_list.php','title'=>$_lang[TBL_TIP]['tip_list']) ;		$employeelist = tbl_staff::GetActiveEmployees();	$tablelist = tbl_dining_table::GetActiveDiningTables();			$template = 'tbl_tip/tip_list.tpl';	$smarty->assign('is_distribution',$is_distribution);	$smarty->assign('employeelist', $employeelist);	$smarty->assign('tablelist', $tablelist);	$smarty->assign('frm_dt', $frm_dt);	$smarty->assign('to_dt', $to_dt);	$smarty->assign('type', $type);	$smarty->assign('page_url', $url);	$smarty->assign('navigationURL',$navigationURL);	$smarty->assign('new_sort',$new_sort);	$smarty->assign('active_page',$active_page);	$smarty->assign('filter_text',$filter_text); }else{	$template='index.tpl';} include_once('footer.php');?>